<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIÊ∫∂Êé•ÊîØÊè¥„Ç¢„Éó„É™ - Ê†™Âºè‰ºöÁ§æ„Ç¢„Ç§„ÉØ„Ç®„É≥„Ç∏„Éã„Ç¢„É™„É≥„Ç∞</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script type="importmap">
    {
      "imports": {
        "@google/generative-ai": "https://esm.run/@google/generative-ai"
      }
    }
    </script>
    <style>
        :root {
            --primary-color: #1e3a8a;
            --secondary-color: #ea580c;
            --accent-color: #06b6d4;
            --bg-dark: #0f172a;
            --surface-dark: #1e293b;
            --text-light: #f8fafc;
        }

        body {
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a2332 100%);
            color: var(--text-light);
            min-height: 100vh;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .glass-card {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .gradient-border {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color), var(--accent-color));
            padding: 2px;
            border-radius: 12px;
        }

        .gradient-border-content {
            background: var(--surface-dark);
            border-radius: 10px;
            height: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(30, 58, 138, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(30, 58, 138, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary-color) 0%, #dc2626 100%);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(234, 88, 12, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(234, 88, 12, 0.4);
        }

        .header-logo {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .ai-status {
            background: linear-gradient(90deg, #10b981, #06b6d4);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: pulse 2s ease-in-out infinite alternate;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            100% { opacity: 0.7; }
        }

        .sparks {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }

        .spark {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--secondary-color);
            border-radius: 50%;
            animation: sparkle 2s linear infinite;
        }

        @keyframes sparkle {
            0% { 
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% { 
                transform: translateY(-100px) scale(0);
                opacity: 0;
            }
        }

        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid var(--accent-color);
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8) 0%, rgba(15, 23, 42, 0.9) 100%);
            border: 1px solid rgba(6, 182, 212, 0.3);
            box-shadow: 0 0 20px rgba(6, 182, 212, 0.1);
        }

        .parameter-input {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .parameter-input:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px rgba(6, 182, 212, 0.2);
        }

        .parameter-input.auto-calculated {
            background: rgba(6, 182, 212, 0.2);
            border-color: var(--accent-color);
            color: #06b6d4;
            font-weight: bold;
        }

        select.parameter-input option {
            background: var(--surface-dark);
            color: var(--text-light);
        }

        .process-step {
            position: relative;
            padding-left: 2rem;
        }

        .process-step::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0.5rem;
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 50%;
            background: var(--accent-color);
        }

        .hidden {
            display: none !important;
        }

        .company-logo {
            max-width: 400px;
            height: auto;
            filter: brightness(1.1);
        }

        .auto-voltage-indicator {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(90deg, #10b981, #06b6d4);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-left: 8px;
            animation: pulse 2s ease-in-out infinite alternate;
        }

        .warning-badge {
            background: linear-gradient(90deg, #f59e0b, #d97706);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin-left: 8px;
        }

        .gas-indicator {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(90deg, #8b5cf6, #a855f7);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin-left: 8px;
        }

        .auto-speed-indicator {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(90deg, #ef4444, #dc2626);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin-left: 8px;
        }

        @media (max-width: 768px) {
            .company-logo {
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="glass-card rounded-none border-0 border-b border-gray-600">
        <div class="container mx-auto px-6 py-4">
            <div class="flex flex-col items-center space-y-3">
                <!-- Company Logo -->
                <div class="flex items-center space-x-4">
                    <svg width="400" height="120" viewBox="0 0 400 120" fill="none" xmlns="http://www.w3.org/2000/svg" class="company-logo">
                        <defs>
                            <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#ff6941"/>
                                <stop offset="100%" stop-color="#ea580c"/>
                            </linearGradient>
                            <linearGradient id="grad2" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#10b981"/>
                                <stop offset="100%" stop-color="#06b6d4"/>
                            </linearGradient>
                            <linearGradient id="grad3" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#3357dc"/>
                                <stop offset="100%" stop-color="#1e3a8a"/>
                            </linearGradient>
                        </defs>
                        <rect x="10" y="30" width="35" height="60" rx="17" fill="url(#grad1)"/>
                        <rect x="55" y="30" width="35" height="60" rx="17" fill="url(#grad2)"/>
                        <rect x="100" y="30" width="35" height="60" rx="17" fill="url(#grad3)"/>
                        <text x="150" y="45" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#f8fafc">Ê†™Âºè‰ºöÁ§æ</text>
                        <text x="150" y="68" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#f8fafc">„Ç¢„Ç§„ÉØ„Ç®„É≥„Ç∏„Éã„Ç¢„É™„É≥„Ç∞</text>
                        <text x="150" y="85" font-family="Arial, sans-serif" font-size="12" font-style="italic" fill="#d1d5db">AIWA Engineering</text>
                    </svg>
                </div>
                
                <!-- App Title and AI Status -->
                <div class="text-center">
                    <h1 class="text-2xl md:text-3xl font-bold header-logo mb-2">AIÊ∫∂Êé•ÊîØÊè¥„Ç¢„Éó„É™</h1>
                    <div class="flex items-center justify-center space-x-2">
                        <i class="fas fa-robot text-lg"></i>
                        <span class="ai-status font-semibold">ü§ñ Gemini 2.5 Flash: Á®ºÂÉç‰∏≠</span>
                        <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                    </div>
                </div>

                <!-- Navigation -->
                <nav class="flex flex-wrap justify-center space-x-4 text-sm">
                    <span class="text-gray-300">ÂØæÂøúÊ©üÂô®:</span>
                    <span class="text-blue-400">„ÉÄ„Ç§„Éò„É≥ WELBEE M-350L</span>
                    <span class="text-gray-400">|</span>
                    <span class="text-blue-400">FD19-VC4 ÂçîÂÉç„É≠„Éú„ÉÉ„Éà (ÂèØÊê¨Ë≥™Èáè4kg)</span>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        <!-- Main Menu -->
        <div id="mainMenu" class="space-y-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold mb-4">Ê∫∂Êé•ÊîØÊè¥Ê©üËÉΩÈÅ∏Êäû</h2>
                <p class="text-gray-300 max-w-2xl mx-auto">
                    AIÊäÄË°ì„ÇíÊ¥ªÁî®„Åó„ÅüÈ´òÁ≤æÂ∫¶„Å™Ê∫∂Êé•Êù°‰ª∂Ë®∫Êñ≠„Ç∑„Çπ„ÉÜ„É†„ÄÇÊïôËÇ≤„ÉªÁ†î‰øÆ„Åã„ÇâÂÆüÂãô„Åæ„ÅßÂπÖÂ∫É„ÅèÂØæÂøú„Åó„Åæ„Åô„ÄÇ
                </p>
            </div>

            <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                <!-- Ê∫∂Êé•ÊúÄÈÅ©Êù°‰ª∂Ë®∫Êñ≠ -->
                <div class="gradient-border">
                    <div class="gradient-border-content p-8 text-center space-y-6">
                        <div class="sparks">
                            <div class="spark" style="left: 20%; animation-delay: 0s;"></div>
                            <div class="spark" style="left: 50%; animation-delay: 0.5s;"></div>
                            <div class="spark" style="left: 80%; animation-delay: 1s;"></div>
                        </div>
                        <div class="text-6xl text-blue-400 mb-4">
                            <i class="fas fa-brain"></i>
                        </div>
                        <h3 class="text-2xl font-bold">Ê∫∂Êé•ÊúÄÈÅ©Êù°‰ª∂Ë®∫Êñ≠</h3>
                        <p class="text-gray-300">
                            ÊùêÊñô„ÉªÊùøÂéö„ÉªÊ∫∂Êé•ÊñπÊ≥ï„ÇíÂÖ•Âäõ„Åô„Çã„Å†„Åë„Åß„ÄÅAI„ÅåÊúÄÈÅ©„Å™Ê∫∂Êé•Êù°‰ª∂„ÇíËá™ÂãïË®∫Êñ≠„ÄÇ
                            ÂàùÂøÉËÄÖ„Åã„Çâ‰∏äÁ¥öËÄÖ„Åæ„ÅßÂÆâÂøÉ„Åó„Å¶„ÅîÂà©Áî®„ÅÑ„Åü„Å†„Åë„Åæ„Åô„ÄÇ
                        </p>
                        <button id="optimalDiagnosisBtn" class="btn-primary text-white px-8 py-3 rounded-lg font-semibold w-full">
                            <i class="fas fa-magic mr-2"></i>AIË®∫Êñ≠„ÇíÈñãÂßã
                        </button>
                    </div>
                </div>

                <!-- Ê∫∂Êé•Êù°‰ª∂ÂÖ•Âäõ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ -->
                <div class="gradient-border">
                    <div class="gradient-border-content p-8 text-center space-y-6">
                        <div class="text-6xl text-orange-400 mb-4">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <h3 class="text-2xl font-bold">Ê∫∂Êé•Êù°‰ª∂ÂÖ•Âäõ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</h3>
                        <p class="text-gray-300">
                            Ë©≥Á¥∞„Å™Ê∫∂Êé•Êù°‰ª∂„ÇíÂÖ•Âäõ„Åó„Å¶ÂìÅË≥™‰∫àÊ∏¨„Å®A/S/B/C/DË©ï‰æ°„ÇíÂÆüÊñΩ„ÄÇ
                            Ë®≠ÂÆöÊù°‰ª∂„ÅÆÂ¶•ÂΩìÊÄß„ÉÅ„Çß„ÉÉ„ÇØ„Å®ÊîπÂñÑÊèêÊ°à„ÇíË°å„ÅÑ„Åæ„Åô„ÄÇ
                        </p>
                        <button id="inputSimulationBtn" class="btn-secondary text-white px-8 py-3 rounded-lg font-semibold w-full">
                            <i class="fas fa-calculator mr-2"></i>Ë©≥Á¥∞„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥
                        </button>
                    </div>
                </div>
            </div>

            <!-- ÂÖçË≤¨‰∫ãÈ†Ö -->
            <div class="glass-card p-6 mt-12 max-w-4xl mx-auto">
                <div class="text-center">
                    <h4 class="text-lg font-semibold mb-4 text-yellow-400">
                        <i class="fas fa-exclamation-triangle mr-2"></i>ÈáçË¶Å„Å™„ÅîÊ≥®ÊÑè
                    </h4>
                    <div class="text-sm text-gray-300 space-y-2">
                        <p>
                            Êú¨„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅØ„ÄÅAIÊäÄË°ì„ÇíÊ¥ªÁî®„Åó„ÅüÊ∫∂Êé•Êù°‰ª∂„ÅÆÂèÇËÄÉÊÉÖÂ†±Êèê‰æõ„ÇíÁõÆÁöÑ„Å®„Åó„Å¶„Åä„Çä„ÄÅ
                            Ê∫∂Êé•‰ΩúÊ•≠„ÅÆÁµêÊûú„ÇÑÂìÅË≥™„Å´„Å§„ÅÑ„Å¶‰øùË®º„Åô„Çã„ÇÇ„ÅÆ„Åß„ÅØ„Åî„Åñ„ÅÑ„Åæ„Åõ„Çì„ÄÇ
                        </p>
                        <p>
                            ÂÆüÈöõ„ÅÆÊ∫∂Êé•‰ΩúÊ•≠„Å´„Åä„ÅÑ„Å¶„ÅØ„ÄÅÂøÖ„ÅöÁèæÂ†¥„Åß„ÅÆË©¶È®ìÊ∫∂Êé•„Åä„Çà„Å≥ÂìÅË≥™Á¢∫Ë™ç„ÇíÂÆüÊñΩ„Åó„ÄÅ
                            ÈÅ©Âàá„Å™ÊäÄËÉΩ„ÇíÊúâ„Åô„Çã‰ΩúÊ•≠ËÄÖ„Å´„Çà„ÇãÊúÄÁµÇÂà§Êñ≠„ÅÆ„ÇÇ„Å®„Åß‰ΩúÊ•≠„ÇíË°å„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ê∫∂Êé•ÊúÄÈÅ©Êù°‰ª∂Ë®∫Êñ≠ÁîªÈù¢ -->
        <div id="optimalDiagnosis" class="hidden space-y-8">
            <div class="flex items-center justify-between">
                <h2 class="text-3xl font-bold">Ê∫∂Êé•ÊúÄÈÅ©Êù°‰ª∂Ë®∫Êñ≠</h2>
                <button class="back-btn text-blue-400 hover:text-blue-300">
                    <i class="fas fa-arrow-left mr-2"></i>„É°„Éã„É•„Éº„Å´Êàª„Çã
                </button>
            </div>

            <div class="grid lg:grid-cols-2 gap-8">
                <!-- ÂÖ•Âäõ„Éë„Éç„É´ -->
                <div class="glass-card p-6 space-y-6">
                    <h3 class="text-xl font-bold mb-4">Ê∫∂Êé•Êù°‰ª∂ÂÖ•Âäõ</h3>
                    
                    <!-- ÊØçÊùêÈÅ∏Êäû -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">ÊØçÊùê</label>
                        <select id="material" class="parameter-input w-full p-3 rounded-lg">
                            <option value="SS400">SS400 (‰∏ÄËà¨ÊßãÈÄ†Áî®ÂúßÂª∂ÈãºÊùê)</option>
                            <option value="SM490">SM490 (Ê∫∂Êé•ÊßãÈÄ†Áî®ÂúßÂª∂ÈãºÊùê)</option>
                            <option value="SUS304">SUS304 („Ç™„Éº„Çπ„ÉÜ„Éä„Ç§„ÉàÁ≥ª„Çπ„ÉÜ„É≥„É¨„ÇπÈãº)</option>
                            <option value="SUS316L">SUS316L (‰ΩéÁÇ≠Á¥†„Çπ„ÉÜ„É≥„É¨„ÇπÈãº)</option>
                            <option value="SUS430">SUS430 („Éï„Çß„É©„Ç§„ÉàÁ≥ª„Çπ„ÉÜ„É≥„É¨„ÇπÈãº)</option>
                        </select>
                    </div>

                    <!-- „Ç∑„Éº„É´„Éâ„Ç¨„ÇπÈÅ∏Êäû -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            „Ç∑„Éº„É´„Éâ„Ç¨„Çπ
                            <span class="gas-indicator">
                                üí® „Ç¨„ÇπÁ®ÆÈ°û
                            </span>
                        </label>
                        <select id="shieldGas" class="parameter-input w-full p-3 rounded-lg">
                            <option value="CO2">CO2 (ÁÇ≠ÈÖ∏„Ç¨„Çπ) - È´òÊ∫∂„ÅëËæº„Åø„ÉªÁµåÊ∏àÁöÑ</option>
                            <option value="MAG_Ar80CO2_20">MAG (Ar80%+CO2 20%) - ‰Ωé„Çπ„Éë„ÉÉ„Çø„ÉªÈ´òÂìÅË≥™</option>
                            <option value="MAG_Ar75CO2_25">MAG (Ar75%+CO2 25%) - „Éê„É©„É≥„ÇπÂûã</option>
                        </select>
                    </div>

                    <!-- „ÉØ„Ç§„É§Á®ÆÈ°ûÈÅ∏Êäû -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">Ê∫∂Êé•„ÉØ„Ç§„É§Á®ÆÈ°û</label>
                        <select id="wireType" class="parameter-input w-full p-3 rounded-lg">
                            <option value="Solid">„ÇΩ„É™„ÉÉ„Éâ„ÉØ„Ç§„É§ (SSÁ≥ª„ÉªËªüÈãºÁî®)</option>
                            <option value="Flux-Cored">„Éï„É©„ÉÉ„ÇØ„Çπ„ÉØ„Ç§„É§ (SSÁ≥ª„Éª„Çπ„ÉÜ„É≥„É¨„ÇπÁ≥ªÂØæÂøú)</option>
                        </select>
                    </div>

                    <!-- ÊùøÂéöË®≠ÂÆö -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">ÊùøÂéö1 (mm)</label>
                            <input type="number" id="thickness1" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0.5" max="25" step="0.1" value="6.0">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">ÊùøÂéö2 (mm)</label>
                            <input type="number" id="thickness2" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0.5" max="25" step="0.1" value="6.0">
                        </div>
                    </div>

                    <!-- Ê∫∂Êé•ÊñπÊ≥ïÈÅ∏Êäû -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">Ê∫∂Êé•ÊñπÊ≥ï</label>
                        <select id="weldingMethod" class="parameter-input w-full p-3 rounded-lg">
                            <option value="butt">Á™Å„ÅçÂêà„Çè„ÅõÊ∫∂Êé•</option>
                            <option value="fillet">ÈöÖËÇâÊ∫∂Êé•</option>
                        </select>
                    </div>

                    <!-- ÈñãÂÖàË®≠ÂÆö -->
                    <div id="grooveSection">
                        <label class="block text-sm font-semibold mb-2">ÈñãÂÖà„ÅÆÊúâÁÑ°</label>
                        <select id="grooveType" class="parameter-input w-full p-3 rounded-lg mb-4">
                            <option value="none">ÈñãÂÖà„Å™„Åó</option>
                            <option value="v-groove">VÂûãÈñãÂÖà</option>
                            <option value="x-groove">XÂûãÈñãÂÖàÔºà‰∏°Èù¢Ôºâ</option>
                            <option value="u-groove">UÂûãÈñãÂÖàÔºàÊ∑±Ê∫ùÂûãÔºâ</option>
                            <option value="bevel">„Éô„Éô„É´Âä†Â∑•</option>
                            <option value="j-groove">JÂûãÈñãÂÖà</option>
                        </select>

                        <!-- ÈñãÂÖàË©≥Á¥∞Ë®≠ÂÆö -->
                        <div id="grooveDetails" class="hidden space-y-4">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold mb-2">ÈñãÂÖàËßíÂ∫¶ (Â∫¶)</label>
                                    <input type="number" id="grooveAngle" class="parameter-input w-full p-3 rounded-lg" 
                                           min="15" max="80" step="5" value="60">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold mb-2">ÈñãÂÖàÂπÖ (mm)</label>
                                    <input type="number" id="grooveWidth" class="parameter-input w-full p-3 rounded-lg" 
                                           min="0" max="5" step="0.1" value="2.0">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-2">ÈñãÂÖàÊ∑±„Åï (mm)</label>
                                <select id="grooveDepth" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">‰∏çÊòé</option>
                                    <option value="3.0">3.0mm</option>
                                    <option value="4.5">4.5mm</option>
                                    <option value="6.0">6.0mm</option>
                                    <option value="7.5">7.5mm</option>
                                    <option value="9.0">9.0mm</option>
                                    <option value="12.0">12.0mm</option>
                                    <option value="15.0">15.0mm</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- „ÉØ„Ç§„É§ÂæÑÈÅ∏Êäû -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">Ê∫∂Êé•„ÉØ„Ç§„É§ÂæÑ</label>
                        <select id="wireSize" class="parameter-input w-full p-3 rounded-lg">
                            <option value="0.8">œÜ0.8mm (ËñÑÊùøÁî®)</option>
                            <option value="0.9">œÜ0.9mm (Á≤æÂØÜÊ∫∂Êé•Áî®)</option>
                            <option value="1.0" selected>œÜ1.0mm (Ê±éÁî®)</option>
                            <option value="1.2">œÜ1.2mm (ÂéöÊùøÁî®)</option>
                            <option value="1.4">œÜ1.4mm (ÈáçÂéöÊùøÁî®)</option>
                        </select>
                    </div>

                    <!-- ËÑöÈï∑„Éª„ÅÆ„Å©ÂéöË®≠ÂÆöÔºàÈöÖËÇâÊ∫∂Êé•ÊôÇ„ÅÆ„ÅøË°®Á§∫Ôºâ -->
                    <div id="filletSettings" class="hidden space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold mb-2">ËÑöÈï∑ (mm)</label>
                                <select id="legLength" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">‰∏çÊòé</option>
                                    <option value="3">3mm</option>
                                    <option value="4">4mm</option>
                                    <option value="5">5mm</option>
                                    <option value="6">6mm</option>
                                    <option value="7">7mm</option>
                                    <option value="8">8mm</option>
                                    <option value="10">10mm</option>
                                    <option value="12">12mm</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-2">„ÅÆ„Å©Âéö (mm)</label>
                                <select id="throatThickness" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">‰∏çÊòé</option>
                                    <option value="2.1">2.1mm</option>
                                    <option value="2.8">2.8mm</option>
                                    <option value="3.5">3.5mm</option>
                                    <option value="4.2">4.2mm</option>
                                    <option value="4.9">4.9mm</option>
                                    <option value="5.6">5.6mm</option>
                                    <option value="7.0">7.0mm</option>
                                    <option value="8.4">8.4mm</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Ê∫∂Êé•Ë∑ùÈõ¢ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">Ê∫∂Êé•Ë∑ùÈõ¢ (mm)</label>
                        <input type="number" id="weldingLength" class="parameter-input w-full p-3 rounded-lg" 
                               min="10" max="10000" step="10" value="100">
                    </div>

                    <!-- Ê∫∂Êé•ÂÑ™ÂÖàÂ∫¶ÈÅ∏Êäû -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">Ê∫∂Êé•ÈáçË¶ñÈ†ÖÁõÆ</label>
                        <select id="weldingPriority" class="parameter-input w-full p-3 rounded-lg">
                            <option value="unknown">‰∏çÊòé</option>
                            <option value="penetration">Ê∫∂„ÅëËæº„ÅøÈáçË¶ñ</option>
                            <option value="appearance">Ë¶ã„ÅüÁõÆÈáçË¶ñ</option>
                            <option value="speed">ÈÄüÂ∫¶ÈáçË¶ñ</option>
                        </select>
                    </div>

                    <!-- AIË®∫Êñ≠„Éú„Çø„É≥ -->
                    <button id="aiDiagnosisBtn" class="btn-primary text-white px-6 py-4 rounded-lg font-semibold w-full">
                        <i class="fas fa-magic mr-2"></i>AIË®∫Êñ≠ÈñãÂßã
                    </button>
                </div>

                <!-- ÁµêÊûúË°®Á§∫„Éë„Éç„É´ -->
                <div class="glass-card p-6">
                    <h3 class="text-xl font-bold mb-4">Ë®∫Êñ≠ÁµêÊûú</h3>
                    <div id="diagnosisResult" class="text-center text-gray-400 py-12">
                        <i class="fas fa-robot text-4xl mb-4 opacity-50"></i>
                        <p>Êù°‰ª∂„ÇíÂÖ•Âäõ„Åó„Å¶AIË®∫Êñ≠„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ê∫∂Êé•Êù°‰ª∂ÂÖ•Âäõ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÁîªÈù¢ -->
        <div id="inputSimulation" class="hidden space-y-8">
            <div class="flex items-center justify-between">
                <h2 class="text-3xl font-bold">Ê∫∂Êé•Êù°‰ª∂ÂÖ•Âäõ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</h2>
                <button class="back-btn text-blue-400 hover:text-blue-300">
                    <i class="fas fa-arrow-left mr-2"></i>„É°„Éã„É•„Éº„Å´Êàª„Çã
                </button>
            </div>

            <div class="grid lg:grid-cols-2 gap-8">
                <!-- Ë©≥Á¥∞ÂÖ•Âäõ„Éë„Éç„É´ -->
                <div class="glass-card p-6 space-y-6">
                    <h3 class="text-xl font-bold mb-4">Ë©≥Á¥∞Ê∫∂Êé•Êù°‰ª∂ÂÖ•Âäõ</h3>
                    
                    <!-- Âü∫Êú¨Êù°‰ª∂ -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">ÊØçÊùê</label>
                            <select id="simMaterial" class="parameter-input w-full p-3 rounded-lg">
                                <option value="SS400">SS400</option>
                                <option value="SM490">SM490</option>
                                <option value="SUS304">SUS304</option>
                                <option value="SUS316L">SUS316L</option>
                                <option value="SUS430">SUS430</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">„ÉØ„Ç§„É§ÂæÑ</label>
                            <select id="simWireSize" class="parameter-input w-full p-3 rounded-lg">
                                <option value="0.8">œÜ0.8mm</option>
                                <option value="0.9">œÜ0.9mm</option>
                                <option value="1.0">œÜ1.0mm</option>
                                <option value="1.2">œÜ1.2mm</option>
                                <option value="1.4">œÜ1.4mm</option>
                            </select>
                        </div>
                    </div>

                    <!-- „ÉØ„Ç§„É§Á®ÆÈ°ûÈÅ∏Êäû -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            Ê∫∂Êé•„ÉØ„Ç§„É§Á®ÆÈ°û
                            <span id="wireTypeWarning" class="warning-badge hidden">
                                ‚ö†Ô∏è „Çπ„ÉÜ„É≥„É¨„ÇπÁ≥ª„ÅØ„Éï„É©„ÉÉ„ÇØ„Çπ„ÉØ„Ç§„É§ÂøÖÈ†à
                            </span>
                        </label>
                        <select id="simWireType" class="parameter-input w-full p-3 rounded-lg">
                            <option value="Solid">„ÇΩ„É™„ÉÉ„Éâ„ÉØ„Ç§„É§ (SSÁ≥ªÂ∞ÇÁî®)</option>
                            <option value="Flux-Cored">„Éï„É©„ÉÉ„ÇØ„Çπ„ÉØ„Ç§„É§ (ÂÖ®ÊùêË≥™ÂØæÂøú)</option>
                        </select>
                    </div>

                    <!-- „Ç∑„Éº„É´„Éâ„Ç¨„Çπ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            „Ç∑„Éº„É´„Éâ„Ç¨„Çπ
                            <span class="gas-indicator">
                                üí® „Ç¨„ÇπË£úÊ≠£
                            </span>
                        </label>
                        <select id="simShieldGas" class="parameter-input w-full p-3 rounded-lg">
                            <option value="CO2">CO2 (ÁÇ≠ÈÖ∏„Ç¨„Çπ)</option>
                            <option value="MAG_Ar80CO2_20">MAG (Ar80%+CO2 20%)</option>
                            <option value="MAG_Ar75CO2_25">MAG (Ar75%+CO2 25%)</option>
                        </select>
                    </div>

                    <!-- ÊùøÂéöË®≠ÂÆö -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">ÊùøÂéö1 (mm)</label>
                            <input type="number" id="simThickness1" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0.5" max="25" step="0.1" value="6.0">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">ÊùøÂéö2 (mm)</label>
                            <input type="number" id="simThickness2" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0.5" max="25" step="0.1" value="6.0">
                        </div>
                    </div>

                    <!-- Ê∫∂Êé•ÊñπÊ≥ïÈÅ∏Êäû -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">Ê∫∂Êé•ÊñπÊ≥ï</label>
                        <select id="simWeldingMethod" class="parameter-input w-full p-3 rounded-lg">
                            <option value="butt">Á™Å„ÅçÂêà„Çè„ÅõÊ∫∂Êé•</option>
                            <option value="fillet">ÈöÖËÇâÊ∫∂Êé•</option>
                        </select>
                    </div>

                    <!-- ÈñãÂÖàË®≠ÂÆö -->
                    <div id="simGrooveSection">
                        <label class="block text-sm font-semibold mb-2">ÈñãÂÖà„ÅÆÊúâÁÑ°</label>
                        <select id="simGrooveType" class="parameter-input w-full p-3 rounded-lg mb-4">
                            <option value="none">ÈñãÂÖà„Å™„Åó</option>
                            <option value="v-groove">VÂûãÈñãÂÖà</option>
                            <option value="x-groove">XÂûãÈñãÂÖàÔºà‰∏°Èù¢Ôºâ</option>
                            <option value="u-groove">UÂûãÈñãÂÖàÔºàÊ∑±Ê∫ùÂûãÔºâ</option>
                            <option value="bevel">„Éô„Éô„É´Âä†Â∑•</option>
                            <option value="j-groove">JÂûãÈñãÂÖà</option>
                        </select>

                        <!-- ÈñãÂÖàË©≥Á¥∞Ë®≠ÂÆö -->
                        <div id="simGrooveDetails" class="hidden space-y-4">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold mb-2">ÈñãÂÖàËßíÂ∫¶ (Â∫¶)</label>
                                    <input type="number" id="simGrooveAngle" class="parameter-input w-full p-3 rounded-lg" 
                                           min="15" max="80" step="5" value="60">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold mb-2">ÈñãÂÖàÂπÖ (mm)</label>
                                    <input type="number" id="simGrooveWidth" class="parameter-input w-full p-3 rounded-lg" 
                                           min="0" max="5" step="0.1" value="2.0">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-2">ÈñãÂÖàÊ∑±„Åï (mm)</label>
                                <select id="simGrooveDepth" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">‰∏çÊòé</option>
                                    <option value="3.0">3.0mm</option>
                                    <option value="4.5">4.5mm</option>
                                    <option value="6.0">6.0mm</option>
                                    <option value="7.5">7.5mm</option>
                                    <option value="9.0">9.0mm</option>
                                    <option value="12.0">12.0mm</option>
                                    <option value="15.0">15.0mm</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- ËÑöÈï∑„Éª„ÅÆ„Å©ÂéöË®≠ÂÆöÔºàÈöÖËÇâÊ∫∂Êé•ÊôÇ„ÅÆ„ÅøË°®Á§∫Ôºâ -->
                    <div id="simFilletSettings" class="hidden space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold mb-2">ËÑöÈï∑ (mm)</label>
                                <select id="simLegLength" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">‰∏çÊòé</option>
                                    <option value="3">3mm</option>
                                    <option value="4">4mm</option>
                                    <option value="5">5mm</option>
                                    <option value="6">6mm</option>
                                    <option value="7">7mm</option>
                                    <option value="8">8mm</option>
                                    <option value="10">10mm</option>
                                    <option value="12">12mm</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-2">„ÅÆ„Å©Âéö (mm)</label>
                                <select id="simThroatThickness" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">‰∏çÊòé</option>
                                    <option value="2.1">2.1mm</option>
                                    <option value="2.8">2.8mm</option>
                                    <option value="3.5">3.5mm</option>
                                    <option value="4.2">4.2mm</option>
                                    <option value="4.9">4.9mm</option>
                                    <option value="5.6">5.6mm</option>
                                    <option value="7.0">7.0mm</option>
                                    <option value="8.4">8.4mm</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Ê∫∂Êé•Ë∑ùÈõ¢ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">Ê∫∂Êé•Ë∑ùÈõ¢ (mm)</label>
                        <input type="number" id="simWeldingLength" class="parameter-input w-full p-3 rounded-lg" 
                               min="10" max="10000" step="10" value="100">
                    </div>

                    <!-- Ê∫∂Êé•ÈõªÊµÅ„ÉªÈõªÂúßÔºà‰∏ÄÂÖÉÊ©üËÉΩ‰ªò„ÅçÔºâ -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">Ê∫∂Êé•ÈõªÊµÅ (A)</label>
                            <input type="number" id="weldingCurrent" class="parameter-input w-full p-3 rounded-lg" 
                                   min="20" max="350" step="5" value="150">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                Ê∫∂Êé•ÈõªÂúß (V)
                                <span class="auto-voltage-indicator">
                                    <i class="fas fa-magic mr-1"></i>‰∏ÄÂÖÉËá™Âãï
                                </span>
                            </label>
                            <input type="number" id="weldingVoltage" class="parameter-input auto-calculated w-full p-3 rounded-lg" 
                                   readonly value="19.0">
                        </div>
                    </div>

                    <!-- „ÉØ„Ç§„É§ÈÄÅÁµ¶ÈÄüÂ∫¶Ë°®Á§∫ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            „ÉØ„Ç§„É§ÈÄÅÁµ¶ÈÄüÂ∫¶ (m/min)
                            <span class="auto-speed-indicator">
                                üîÑ ‰∏ÄÂÖÉËá™Âãï
                            </span>
                        </label>
                        <input type="number" id="wireFeedSpeed" class="parameter-input auto-calculated w-full p-3 rounded-lg" 
                               readonly value="6.5">
                    </div>

                    <!-- „Éó„É™„Éï„É≠„Éº„Éª„Ç¢„Éï„Çø„Éº„Éï„É≠„Éº -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">„Éó„É™„Éï„É≠„ÉºÊôÇÈñì (Áßí)</label>
                            <input type="number" id="preFlow" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0" max="10" step="0.1" value="0.1">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">„Ç¢„Éï„Çø„Éº„Éï„É≠„ÉºÊôÇÈñì (Áßí)</label>
                            <input type="number" id="afterFlow" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0" max="10" step="0.1" value="0.4">
                        </div>
                    </div>

                    <!-- „Ç¶„Ç£„Éº„Éì„É≥„Ç∞Ë®≠ÂÆöÔºàÊ≥®ÊÑèË°®Á§∫‰ªò„ÅçÔºâ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            „Ç¶„Ç£„Éº„Éì„É≥„Ç∞Ë®≠ÂÆö
                            <span class="warning-badge">
                                ‚ö†Ô∏è „É≠„Éú„ÉÉ„ÉàÂà∂Âæ°ÊôÇ„ÅÆ„Åø
                            </span>
                        </label>
                        <div class="space-y-3">
                            <select id="weavingEnabled" class="parameter-input w-full p-3 rounded-lg">
                                <option value="false">„Ç¶„Ç£„Éº„Éì„É≥„Ç∞„Å™„Åó</option>
                                <option value="true">„Ç¶„Ç£„Éº„Éì„É≥„Ç∞„ÅÇ„ÇäÔºàFD19-VC4Âà∂Âæ°Ôºâ</option>
                            </select>
                            <div id="weavingSettings" class="hidden space-y-3">
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-semibold mb-2">„Ç¶„Ç£„Éº„Éì„É≥„Ç∞ÂπÖ (mm)</label>
                                        <input type="number" id="weavingWidth" class="parameter-input w-full p-3 rounded-lg" 
                                               min="0.5" max="10" step="0.5" value="3.0">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold mb-2">„Ç¶„Ç£„Éº„Éì„É≥„Ç∞Âë®Ê≥¢Êï∞ (Hz)</label>
                                        <input type="number" id="weavingFrequency" class="parameter-input w-full p-3 rounded-lg" 
                                               min="0.1" max="5.0" step="0.1" value="1.0">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- „Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„Éú„Çø„É≥ -->
                    <button id="detailedSimBtn" class="btn-secondary text-white px-6 py-4 rounded-lg font-semibold w-full">
                        <i class="fas fa-calculator mr-2"></i>Ë©≥Á¥∞„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÂÆüË°å
                    </button>
                </div>

                <!-- „Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÁµêÊûú -->
                <div class="glass-card p-6">
                    <h3 class="text-xl font-bold mb-4">„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÁµêÊûú</h3>
                    <div id="simulationResult" class="text-center text-gray-400 py-12">
                        <i class="fas fa-chart-line text-4xl mb-4 opacity-50"></i>
                        <p>Êù°‰ª∂„ÇíÂÖ•Âäõ„Åó„Å¶„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="glass-card rounded-none border-0 border-t border-gray-600 mt-16">
        <div class="container mx-auto px-6 py-8">
            <div class="text-center space-y-4">
                <div class="flex items-center justify-center space-x-2">
                    <i class="fas fa-copyright text-gray-400"></i>
                    <span class="text-gray-300">2025 Ê†™Âºè‰ºöÁ§æ„Ç¢„Ç§„ÉØ„Ç®„É≥„Ç∏„Éã„Ç¢„É™„É≥„Ç∞</span>
                </div>
                <div class="text-sm text-gray-400 space-y-2">
                    <p>Ê∫∂Êé•ÊäÄË°ì„ÅÆ„Çπ„Éö„Ç∑„É£„É™„Çπ„Éà - ÊïôËÇ≤„Åã„ÇâÂÆüÂãô„Åæ„ÅßÂπÖÂ∫É„Åè„Çµ„Éù„Éº„Éà</p>
                    <p>Êú¨„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆÂà©Áî®„Å´„Çà„ÇäÁîü„Åò„ÅüÊêçÂÆ≥„Å´„Å§„ÅÑ„Å¶„ÄÅÂºäÁ§æ„ÅØ‰∏ÄÂàá„ÅÆË≤¨‰ªª„ÇíË≤†„ÅÑ„Åã„Å≠„Åæ„Åô„ÄÇ</p>
                </div>
            </div>
        </div>
    </footer>

    <script type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";

        class WeldingAIService {
            constructor() {
                this.API_KEY = 'AIzaSyBivo2r8DpE8DATru1Vy8JuinouvrZwRHk';
                this.genAI = new GoogleGenerativeAI(this.API_KEY);
                this.model = this.genAI.getGenerativeModel({ 
                    model: "gemini-2.5-flash",
                    generationConfig: {
                        temperature: 0.3,
                        topK: 40,
                        topP: 0.95,
                        maxOutputTokens: 8192,
                    }
                });
                console.log('‚úÖ Gemini 2.5 FlashÂàùÊúüÂåñÂÆå‰∫Ü');
            }

            async diagnoseWeldingConditions(conditions) {
                const prompt = this.createOptimalDiagnosisPrompt(conditions);
                try {
                    const result = await this.model.generateContent(prompt);
                    const response = await result.response;
                    return response.text();
                } catch (error) {
                    console.error('AIË®∫Êñ≠„Ç®„É©„Éº:', error);
                    throw new Error(`AIË®∫Êñ≠„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ${error.message}`);
                }
            }

            async simulateWeldingConditions(conditions) {
                const prompt = this.createSimulationPrompt(conditions);
                try {
                    const result = await this.model.generateContent(prompt);
                    const response = await result.response;
                    return response.text();
                } catch (error) {
                    console.error('„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„Ç®„É©„Éº:', error);
                    throw new Error(`„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ${error.message}`);
                }
            }

            createOptimalDiagnosisPrompt(conditions) {
                return `
„Äê„ÉÄ„Ç§„Éò„É≥WELBEE M-350L & FD19-VC4 È´òÁ≤æÂ∫¶Ê∫∂Êé•Ë®∫Êñ≠„Äë

„ÅÇ„Å™„Åü„ÅØÊ∫∂Êé•Â∑•Â≠¶„ÅÆ‰∏ñÁïåÁöÑÂ∞ÇÈñÄÂÆ∂„Å®„Åó„Å¶„ÄÅÊúÄÈ´òÁ≤æÂ∫¶„ÅÆË®∫Êñ≠„Çí„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô„ÄÇ

‚ñ† ÂÖ•ÂäõÊù°‰ª∂:
- ÊØçÊùê: ${conditions.material}
- „Ç∑„Éº„É´„Éâ„Ç¨„Çπ: ${conditions.shieldGas}
- „ÉØ„Ç§„É§Á®ÆÈ°û: ${conditions.wireType}
- ÊùøÂéö1: ${conditions.thickness1}mm
- ÊùøÂéö2: ${conditions.thickness2}mm  
- Ê∫∂Êé•ÊñπÊ≥ï: ${conditions.weldingMethod}
- ÈñãÂÖà„Çø„Ç§„Éó: ${conditions.grooveType}
- ÈñãÂÖàËßíÂ∫¶: ${conditions.grooveAngle}Â∫¶
- ÈñãÂÖàÂπÖ: ${conditions.grooveWidth}mm
- ÈñãÂÖàÊ∑±„Åï: ${conditions.grooveDepth}
- „ÉØ„Ç§„É§ÂæÑ: œÜ${conditions.wireSize}mm
- ËÑöÈï∑: ${conditions.legLength}
- „ÅÆ„Å©Âéö: ${conditions.throatThickness}
- Ê∫∂Êé•Ë∑ùÈõ¢: ${conditions.weldingLength}mm
- ÈáçË¶ñÈ†ÖÁõÆ: ${conditions.weldingPriority}

‚ñ† ÈáçË¶ÅÂà∂Á¥Ñ‰∫ãÈ†Ö:
- „Çπ„ÉÜ„É≥„É¨„ÇπÁ≥ªÊùêË≥™(SUS304/316L/430)„ÅÆÂ†¥Âêà„ÄÅ„Éï„É©„ÉÉ„ÇØ„Çπ„ÉØ„Ç§„É§ÂøÖÈ†à
- SSÁ≥ªÊùêË≥™(SS400/SM490)„ÅÆÂ†¥Âêà„ÄÅ„ÇΩ„É™„ÉÉ„Éâ„ÉØ„Ç§„É§„Éª„Éï„É©„ÉÉ„ÇØ„Çπ„ÉØ„Ç§„É§‰∏°Êñπ‰ΩøÁî®ÂèØËÉΩ

‚ñ† „Ç∑„Éº„É´„Éâ„Ç¨„ÇπÁâπÊÄß:
- CO2: È´òÊ∫∂„ÅëËæº„Åø„ÄÅÁµåÊ∏àÁöÑ„ÄÅ„Çπ„Éë„ÉÉ„ÇøÂ§ö„ÄÅÊ∫∂Êé•ÈõªÂúß+2.0VË£úÊ≠£
- MAG(Ar80%+CO2 20%): ‰Ωé„Çπ„Éë„ÉÉ„Çø„ÄÅÈ´òÂìÅË≥™„ÄÅÊ∫∂Êé•ÈõªÂúß-0.5VË£úÊ≠£„ÄÅ„Ç¢„Éº„ÇØÂÆâÂÆö
- MAG(Ar75%+CO2 25%): „Éê„É©„É≥„ÇπÂûã„ÄÅ‰∏≠Á®ãÂ∫¶„Çπ„Éë„ÉÉ„Çø„ÄÅÂü∫Ê∫ñÈõªÂúß‰ΩøÁî®

‚ñ† Ê©üÂô®‰ªïÊßò:
- WELBEE M-350L: ÂÆöÊ†ºÂá∫ÂäõÈõªÊµÅ30-350A„ÄÅÈõªÂúß12-36V„ÄÅ‰∏ÄÂÖÉÊ©üËÉΩÊê≠Ëºâ„ÄÅ„Éë„É´„ÇπÊ©üËÉΩ„Å™„Åó
- FD19-VC4: ÂçîÂÉç„É≠„Éú„ÉÉ„Éà„ÄÅÂèØÊê¨Ë≥™Èáè4kg„ÄÅËªåË∑°Á≤æÂ∫¶Âêë‰∏ä„ÄÅ„Ç¶„Ç£„Éº„Éì„É≥„Ç∞Âà∂Âæ°ÂØæÂøú

‚ñ† Ë®∫Êñ≠ÂõûÁ≠îÂΩ¢ÂºèÔºàÂøÖÈ†àÔºâ:
„ÄêÊ∫∂Êé•Êù°‰ª∂„ÄëÔºàÂøÖ„ÅöÊúÄÂàù„Å´Ë®òËºâÔºâ
„ÉªÊ∫∂Êé•ÈõªÊµÅ: ‚óã‚óãA
„ÉªÊ∫∂Êé•ÈõªÂúß: ‚óã‚óãVÔºà‰∏ÄÂÖÉË®≠ÂÆö+„Ç¨„ÇπË£úÊ≠£Ôºâ
„Éª„ÉØ„Ç§„É§ÈÄÅÁµ¶ÈÄüÂ∫¶: ‚óã‚óãm/minÔºà‰∏ÄÂÖÉËá™ÂãïË®àÁÆóÔºâ
„ÉªÊé®Â•®„Éë„ÇπÊï∞: ‚óã„Éë„Çπ
„Éª„Éó„É™„Éï„É≠„ÉºÊôÇÈñì: ‚óã‚óãÁßí
„Éª„Ç¢„Éï„Çø„Éº„Éï„É≠„ÉºÊôÇÈñì: ‚óã‚óãÁßí
„Éª„Ç¶„Ç£„Éº„Éì„É≥„Ç∞ÂπÖ: ‚óã‚óãmmÔºà„É≠„Éú„ÉÉ„ÉàÂà∂Âæ°ÊôÇÔºâ
„Éª„Ç¶„Ç£„Éº„Éì„É≥„Ç∞Âë®Ê≥¢Êï∞: ‚óã‚óãHzÔºà„É≠„Éú„ÉÉ„ÉàÂà∂Âæ°ÊôÇÔºâ
„Éª„Éà„Éº„ÉÅËßíÂ∫¶: ‚óã‚óãÂ∫¶
„ÉªÈÄ≤Ë°åÊñπÂêë: „Éó„ÉÉ„Ç∑„É•/„Éó„É´
„Éª„Ç¢„Éº„ÇØÁâπÊÄß: ‚óã‚óãÔºà-99ÔΩû99Ôºâ
„Éª„Ç¨„ÇπÊµÅÈáè: ‚óã‚óãL/min

„ÄêË©≥Á¥∞Ëß£Ë™¨„Äë
Ôºà‰∏äË®òÊù°‰ª∂„ÅÆÊäÄË°ìÁöÑÊ†πÊã†„Å®Ë™¨ÊòéÔºâ

‚ñ† ÈáçË¶Å‰∫ãÈ†Ö:
- ‰∏ÄÂÖÉÊ©üËÉΩ„Å´„Çà„ÇäÈõªÊµÅ‚ÜíÈõªÂúß‚Üí„ÉØ„Ç§„É§ÈÄÅÁµ¶ÈÄüÂ∫¶„ÇíÂÆüÈ®ì„Éá„Éº„Çø„Éô„Éº„Çπ„Å´Âü∫„Å•„ÅÑ„Å¶Ëá™ÂãïË®àÁÆó+„Ç∑„Éº„É´„Éâ„Ç¨„ÇπË£úÊ≠£
- ÊùøÂéö„ÉªÈñãÂÖà„Éª„ÉØ„Ç§„É§ÂæÑ„Å´Âü∫„Å•„ÅèÊúÄÈÅ©„Éë„ÇπÊï∞„ÇíÂà§ÂÆö
- ÂêÑ„Éë„ÇπÂà•„ÅÆË©≥Á¥∞Ê∫∂Êé•Êù°‰ª∂„ÇíÊèêÁ§∫
- „Ç∑„Éº„É´„Éâ„Ç¨„ÇπÁ®ÆÈ°û„Å´„Çà„ÇãÁâπÊÄßÂ∑Æ„ÇíËÄÉÊÖÆ
- „Ç¶„Ç£„Éº„Éì„É≥„Ç∞Ê©üËÉΩ„ÅØÂçîÂÉç„É≠„Éú„ÉÉ„ÉàÂà∂Âæ°ÊôÇ„ÅÆ„Åø‰ΩøÁî®ÂèØËÉΩ
- ÂøÖ„ÅöÊù°‰ª∂„ÇíÊï∞ÂÄ§„ÅßÂÖà„Å´Á§∫„Åó„Å¶„Åã„ÇâËß£Ë™¨„Åô„Çã„Åì„Å®

ÂøÖ„ÅöÊó•Êú¨Ë™û„Åß„ÄÅÊï∞ÂÄ§Ë®àÁÆóÈÅéÁ®ã„ÇíÊòéÁ§∫„Åó„ÄÅÊäÄË°ìÁöÑÊ†πÊã†„ÇíË©≥Á¥∞„Å´Ë™¨Êòé„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
ÂõûÁ≠î„ÅåÈÄî‰∏≠„ÅßÁµÇ‰∫Ü„Åó„Å™„ÅÑ„Çà„ÅÜ„ÄÅÂÆåÂÖ®„Å™Ë®∫Êñ≠ÁµêÊûú„ÇíÊèê‰æõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                `;
            }

            createSimulationPrompt(conditions) {
                return `
„Äê„ÉÄ„Ç§„Éò„É≥WELBEE M-350L Ê∫∂Êé•Êù°‰ª∂Ë©ï‰æ°„ÉªÊé°ÁÇπ„Äë

ÂÖ•Âäõ„Åï„Çå„ÅüÊ∫∂Êé•Êù°‰ª∂„ÇíÂ∞ÇÈñÄÁöÑ„Å´Ë©ï‰æ°„Åó„ÄÅA/S/B/C/DÂà§ÂÆö„ÇíË°å„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

‚ñ† ÂÖ•ÂäõÊ∫∂Êé•Êù°‰ª∂:
- ÊØçÊùê: ${conditions.material}
- „Ç∑„Éº„É´„Éâ„Ç¨„Çπ: ${conditions.shieldGas}
- „ÉØ„Ç§„É§Á®ÆÈ°û: ${conditions.wireType}
- ÊùøÂéö1: ${conditions.thickness1}mm
- ÊùøÂéö2: ${conditions.thickness2}mm
- Ê∫∂Êé•ÊñπÊ≥ï: ${conditions.weldingMethod}
- ÈñãÂÖà„Çø„Ç§„Éó: ${conditions.grooveType}
- ÈñãÂÖàËßíÂ∫¶: ${conditions.grooveAngle}Â∫¶
- ÈñãÂÖàÂπÖ: ${conditions.grooveWidth}mm
- ÈñãÂÖàÊ∑±„Åï: ${conditions.grooveDepth}
- „ÉØ„Ç§„É§ÂæÑ: œÜ${conditions.wireSize}mm
- ËÑöÈï∑: ${conditions.legLength}
- „ÅÆ„Å©Âéö: ${conditions.throatThickness}
- Ê∫∂Êé•Ë∑ùÈõ¢: ${conditions.weldingLength}mm
- Ê∫∂Êé•ÈõªÊµÅ: ${conditions.current}A
- Ê∫∂Êé•ÈõªÂúß: ${conditions.voltage}VÔºà‰∏ÄÂÖÉË®≠ÂÆöËá™ÂãïË®àÁÆóÔºâ
- „ÉØ„Ç§„É§ÈÄÅÁµ¶ÈÄüÂ∫¶: ${conditions.feedSpeed}m/minÔºà‰∏ÄÂÖÉËá™ÂãïË®àÁÆóÔºâ
- „Éó„É™„Éï„É≠„ÉºÊôÇÈñì: ${conditions.preFlow}Áßí
- „Ç¢„Éï„Çø„Éº„Éï„É≠„ÉºÊôÇÈñì: ${conditions.afterFlow}Áßí
- „Ç¶„Ç£„Éº„Éì„É≥„Ç∞: ${conditions.weaving}
- „Ç¶„Ç£„Éº„Éì„É≥„Ç∞ÂπÖ: ${conditions.weavingWidth}mm
- „Ç¶„Ç£„Éº„Éì„É≥„Ç∞Âë®Ê≥¢Êï∞: ${conditions.weavingFrequency}Hz

‚ñ† Ë©ï‰æ°ÂõûÁ≠îÂΩ¢ÂºèÔºàÂøÖÈ†àÔºâ:
„ÄêË©ï‰æ°ÁµêÊûúÊ¶ÇË¶Å„ÄëÔºàÂøÖ„ÅöÊúÄÂàù„Å´Ë®òËºâÔºâ
„ÉªÁ∑èÂêàË©ï‰æ°: ‚óãË©ï‰æ°Ôºà‚óã‚óãÁÇπ/100ÁÇπÔºâ
„ÉªÈõªÊµÅË®≠ÂÆö: ‚óã‚óãÁÇπ/20ÁÇπ
„ÉªÈõªÂúßË®≠ÂÆö: ‚óã‚óãÁÇπ/20ÁÇπÔºà„Ç¨„ÇπË£úÊ≠£Âê´„ÇÄÔºâ
„Éª„ÉØ„Ç§„É§Á®ÆÈ°ûÈÅ©ÂêàÊÄß: ‚óã‚óãÁÇπ/20ÁÇπ
„ÉªÊùøÂéö„ÉªÈñãÂÖàÈÅ©ÂêàÊÄß: ‚óã‚óãÁÇπ/20ÁÇπ
„ÉªÁ∑èÂêà„Éê„É©„É≥„Çπ: ‚óã‚óãÁÇπ/20ÁÇπ

„ÄêË©≥Á¥∞Ë©ï‰æ°„Å®„Ç¢„Éâ„Éê„Ç§„Çπ„Äë
ÔºàÂêÑÈ†ÖÁõÆ„ÅÆË©ï‰æ°ÁêÜÁî±„Å®ÊîπÂñÑÊèêÊ°àÔºâ

‚ñ† Ë©ï‰æ°È†ÖÁõÆ:
1. ÈõªÊµÅË®≠ÂÆö„ÅÆÂ¶•ÂΩìÊÄß (20ÁÇπÊ∫ÄÁÇπ)
2. ÈõªÂúßË®≠ÂÆö„ÅÆÂ¶•ÂΩìÊÄßÔºà‰∏ÄÂÖÉÊ©üËÉΩ+„Ç¨„ÇπË£úÊ≠£Ôºâ (20ÁÇπÊ∫ÄÁÇπ)
3. „ÉØ„Ç§„É§Á®ÆÈ°û„ÅÆÊùêË≥™ÈÅ©ÂêàÊÄßÔºà„Çπ„ÉÜ„É≥„É¨„ÇπÁ≥ª„Éï„É©„ÉÉ„ÇØ„ÇπÂøÖÈ†à„ÉÅ„Çß„ÉÉ„ÇØÔºâ (20ÁÇπÊ∫ÄÁÇπ)
4. ÊùøÂéö„ÉªÈñãÂÖàÊù°‰ª∂„Å®„ÅÆÈÅ©ÂêàÊÄß (20ÁÇπÊ∫ÄÁÇπ)
5. Á∑èÂêà„Éê„É©„É≥„Çπ (20ÁÇπÊ∫ÄÁÇπ)

‚ñ† Ë©ï‰æ°Âü∫Ê∫ñ:
- SË©ï‰æ°: 95-100ÁÇπ (ÂÆåÁíß)
- AË©ï‰æ°: 85-94ÁÇπ (ÂÑ™ÁßÄ)
- BË©ï‰æ°: 70-84ÁÇπ (ËâØÂ•Ω)
- CË©ï‰æ°: 50-69ÁÇπ (Ë¶ÅÊîπÂñÑ)
- DË©ï‰æ°: 0-49ÁÇπ (‰∏çÈÅ©Âàá)

ÂêÑÈ†ÖÁõÆ„ÅÆÊé°ÁÇπÁêÜÁî±„Å®ÊîπÂñÑÊèêÊ°à„ÇíÂÖ∑‰ΩìÁöÑ„Å´Êó•Êú¨Ë™û„ÅßË™¨Êòé„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
WELBEE M-350L„ÅÆ‰∏ÄÂÖÉË®≠ÂÆö„Å®„Ç∑„Éº„É´„Éâ„Ç¨„ÇπÁâπÊÄß„ÇíËÄÉÊÖÆ„Åó„ÅüË©ï‰æ°„ÇíÂê´„ÇÅ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
ÂøÖ„ÅöË©ï‰æ°ÁµêÊûú„ÇíÊï∞ÂÄ§„ÅßÂÖà„Å´Á§∫„Åó„Å¶„Åã„ÇâËß£Ë™¨„Åô„Çã„Åì„Å®„ÄÇ
„ÉØ„Ç§„É§ÈÄÅÁµ¶ÈÄüÂ∫¶„ÅØ‰∏ÄÂÖÉÊ©üËÉΩ„ÅßÂÆüÈ®ì„Éá„Éº„Çø„Éô„Éº„Çπ„Å´Âü∫„Å•„ÅçËá™ÂãïË®àÁÆó„Åï„Çå„Åæ„Åô„ÄÇ
                `;
            }
        }

        // ÂÆüÈ®ì„Éá„Éº„Çø„Éô„Éº„Çπ„Å´Âü∫„Å•„ÅèÈ´òÁ≤æÂ∫¶‰∏ÄÂÖÉË®àÁÆó„ÇØ„É©„Çπ
        class WeldingCalculator {
            constructor() {
                // ÂÆüÈ®ì„Éá„Éº„Çø„Éù„Ç§„É≥„ÉàÔºàÂ≠¶Ë°ìË´ñÊñá„ÉªÂÆüÊ©ü„Éá„Éº„Çø„Å´Âü∫„Å•„ÅèÔºâ
                this.DATA_POINTS = {
                    "MildSteel_ArCO2_Solid_0.8": [
                        {current: 100, voltage: 16.0, feed_speed: 4.5},
                        {current: 120, voltage: 17.2, feed_speed: 5.8},
                        {current: 140, voltage: 18.4, feed_speed: 7.0},
                        {current: 160, voltage: 19.6, feed_speed: 8.2},
                        {current: 180, voltage: 20.8, feed_speed: 9.5},
                        {current: 200, voltage: 22.0, feed_speed: 10.8},
                        {current: 220, voltage: 23.2, feed_speed: 12.0},
                        {current: 240, voltage: 24.4, feed_speed: 13.3},
                        {current: 260, voltage: 25.6, feed_speed: 14.5}
                    ],
                    "StainlessSteel_ArCO2_FluxCored_1.2": [
                        {current: 80, voltage: 16.2, feed_speed: 2.2},
                        {current: 90, voltage: 17.0, feed_speed: 2.6},
                        {current: 100, voltage: 17.8, feed_speed: 3.0},
                        {current: 120, voltage: 19.4, feed_speed: 3.8},
                        {current: 140, voltage: 21.0, feed_speed: 4.6},
                        {current: 160, voltage: 22.6, feed_speed: 5.4},
                        {current: 180, voltage: 24.2, feed_speed: 6.2},
                        {current: 200, voltage: 25.8, feed_speed: 7.0}
                    ]
                };

                // Ë£úÊ≠£‰øÇÊï∞ÔºàÂÆüÊ©üÊ∏¨ÂÆö„Éá„Éº„Çø„Å´Âü∫„Å•„ÅèÔºâ
                this.CORRECTION_FACTORS = {
                    "gas": {
                        "CO2": { voltage_add: 2.0 },
                        "MAG_Ar80CO2_20": { voltage_add: -0.5 },
                        "MAG_Ar75CO2_25": { voltage_add: 0.0 }
                    },
                    "wire_type": {
                        "Flux-Cored": { voltage_add: 1.5, feed_speed_multiplier: 1.15 }
                    },
                    "wire_diameter": {
                        "0.8": { voltage_multiplier: 1.00, feed_speed_multiplier: 1.00 },
                        "0.9": { voltage_multiplier: 1.02, feed_speed_multiplier: 0.85 },
                        "1.0": { voltage_multiplier: 1.04, feed_speed_multiplier: 0.75 },
                        "1.2": { voltage_multiplier: 1.08, feed_speed_multiplier: 0.55 },
                        "1.4": { voltage_multiplier: 1.12, feed_speed_multiplier: 0.45 }
                    },
                    "material": {
                        "SS400": { voltage_add: 0.0, feed_speed_multiplier: 1.0 },
                        "SM490": { voltage_add: 0.3, feed_speed_multiplier: 1.0 },
                        "SUS304": { voltage_add: -0.8, feed_speed_multiplier: 0.9 },
                        "SUS316L": { voltage_add: -0.5, feed_speed_multiplier: 0.9 },
                        "SUS430": { voltage_add: -0.6, feed_speed_multiplier: 0.95 }
                    }
                };

                // Ëøë‰ººÈñ¢Êï∞„ÅÆ‰∫ãÂâçË®àÁÆó
                this.initializeApproximationFunctions();
            }

            initializeApproximationFunctions() {
                // ËªüÈãºÁî®Ëøë‰ººÈñ¢Êï∞„ÅÆ‰øÇÊï∞Ë®àÁÆó
                const mildSteelData = this.DATA_POINTS["MildSteel_ArCO2_Solid_0.8"];
                this.mildSteelVoltageCoeff = this.polyfit(mildSteelData, 'current', 'voltage', 2);
                this.mildSteelFeedSpeedCoeff = this.polyfit(mildSteelData, 'current', 'feed_speed', 1);

                // „Çπ„ÉÜ„É≥„É¨„ÇπÈãºÁî®Ëøë‰ººÈñ¢Êï∞„ÅÆ‰øÇÊï∞Ë®àÁÆó
                const stainlessSteelData = this.DATA_POINTS["StainlessSteel_ArCO2_FluxCored_1.2"];
                this.stainlessSteelVoltageCoeff = this.polyfit(stainlessSteelData, 'current', 'voltage', 2);
                this.stainlessSteelFeedSpeedCoeff = this.polyfit(stainlessSteelData, 'current', 'feed_speed', 1);
            }

            // Â§öÈ†ÖÂºè„Éï„Ç£„ÉÉ„ÉÜ„Ç£„É≥„Ç∞Èñ¢Êï∞ÔºàÁ∞°ÊòìÁâàÊúÄÂ∞è‰∫å‰πóÊ≥ïÔºâ
            polyfit(data, xKey, yKey, degree) {
                const n = data.length;
                const x = data.map(d => d[xKey]);
                const y = data.map(d => d[yKey]);

                if (degree === 1) {
                    // ‰∏ÄÊ¨°Èñ¢Êï∞: y = ax + b
                    let sumX = 0, sumY = 0, sumXY = 0, sumX2 = 0;
                    for (let i = 0; i < n; i++) {
                        sumX += x[i];
                        sumY += y[i];
                        sumXY += x[i] * y[i];
                        sumX2 += x[i] * x[i];
                    }
                    const a = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
                    const b = (sumY - a * sumX) / n;
                    return {a, b};

                } else if (degree === 2) {
                    // ‰∫åÊ¨°Èñ¢Êï∞: y = ax¬≤ + bx + c
                    // Á∞°ÊòìÁöÑ„Å™‰∫åÊ¨°Ëøë‰ººÔºà3ÁÇπ„Çí‰ΩøÁî®Ôºâ
                    const p1 = {x: x[0], y: y[0]};
                    const p2 = {x: x[Math.floor(n/2)], y: y[Math.floor(n/2)]};
                    const p3 = {x: x[n-1], y: y[n-1]};
                    
                    // ÈÄ£Á´ãÊñπÁ®ãÂºè„ÇíËß£„Åè
                    const denom = (p1.x - p2.x) * (p1.x - p3.x) * (p2.x - p3.x);
                    const a = (p3.x * (p2.y - p1.y) + p2.x * (p1.y - p3.y) + p1.x * (p3.y - p2.y)) / denom;
                    const b = (p3.x * p3.x * (p1.y - p2.y) + p2.x * p2.x * (p3.y - p1.y) + p1.x * p1.x * (p2.y - p3.y)) / denom;
                    const c = (p2.x * p3.x * (p2.x - p3.x) * p1.y + p3.x * p1.x * (p3.x - p1.x) * p2.y + p1.x * p2.x * (p1.x - p2.x) * p3.y) / denom;
                    
                    return {a, b, c};
                }
            }

            // Ëøë‰ººÈñ¢Êï∞„Å´„Çà„ÇãÂÄ§„ÅÆË®àÁÆó
            evaluatePolynomial(coeff, x) {
                if (coeff.c !== undefined) {
                    // ‰∫åÊ¨°Èñ¢Êï∞
                    return coeff.a * x * x + coeff.b * x + coeff.c;
                } else {
                    // ‰∏ÄÊ¨°Èñ¢Êï∞
                    return coeff.a * x + coeff.b;
                }
            }

            calculateWeldingParameters(current, material, gas, wireType, wireDiameter) {
                let baseVoltage, baseFeedSpeed;

                // ÊØçÊùê„Å®„ÉØ„Ç§„É§Á®ÆÈ°û„Å´„Çà„Å£„Å¶„Éô„Éº„Çπ„É¢„Éá„É´„ÇíÈÅ∏Êäû
                if (material.includes("SUS") && wireType === "Flux-Cored") {
                    // „Çπ„ÉÜ„É≥„É¨„ÇπÈãº+„Éï„É©„ÉÉ„ÇØ„Çπ„ÉØ„Ç§„É§„É¢„Éá„É´
                    baseVoltage = this.evaluatePolynomial(this.stainlessSteelVoltageCoeff, current);
                    baseFeedSpeed = this.evaluatePolynomial(this.stainlessSteelFeedSpeedCoeff, current);
                } else {
                    // ËªüÈãº„É¢„Éá„É´Ôºà„Éá„Éï„Ç©„É´„ÉàÔºâ
                    baseVoltage = this.evaluatePolynomial(this.mildSteelVoltageCoeff, current);
                    baseFeedSpeed = this.evaluatePolynomial(this.mildSteelFeedSpeedCoeff, current);
                }

                let finalVoltage = baseVoltage;
                let finalFeedSpeed = baseFeedSpeed;

                // ÊùêË≥™Ë£úÊ≠£
                if (this.CORRECTION_FACTORS.material[material]) {
                    const matFactors = this.CORRECTION_FACTORS.material[material];
                    finalVoltage += matFactors.voltage_add;
                    finalFeedSpeed *= matFactors.feed_speed_multiplier;
                }

                // „ÉØ„Ç§„É§ÂæÑË£úÊ≠£ÔºàÂü∫Ê∫ñ0.8mm„Åã„Çâ„ÅÆË£úÊ≠£Ôºâ
                if (wireDiameter != "0.8" && this.CORRECTION_FACTORS.wire_diameter[wireDiameter]) {
                    const diaFactors = this.CORRECTION_FACTORS.wire_diameter[wireDiameter];
                    finalVoltage *= diaFactors.voltage_multiplier;
                    finalFeedSpeed *= diaFactors.feed_speed_multiplier;
                }

                // „Ç¨„ÇπÁ®ÆË£úÊ≠£
                if (this.CORRECTION_FACTORS.gas[gas]) {
                    finalVoltage += this.CORRECTION_FACTORS.gas[gas].voltage_add;
                }

                // „ÉØ„Ç§„É§Á®ÆË£úÊ≠£
                if (wireType === "Flux-Cored" && this.CORRECTION_FACTORS.wire_type["Flux-Cored"]) {
                    const fcwFactors = this.CORRECTION_FACTORS.wire_type["Flux-Cored"];
                    finalVoltage += fcwFactors.voltage_add;
                    finalFeedSpeed *= fcwFactors.feed_speed_multiplier;
                }

                // WELBEE M-350L„ÅÆÂà∂ÈôêÂÄ§ÈÅ©Áî®
                finalVoltage = Math.max(12.0, Math.min(36.0, finalVoltage));
                finalFeedSpeed = Math.max(0.5, Math.min(25.0, finalFeedSpeed));

                return {
                    voltage: Math.round(finalVoltage * 10) / 10,
                    feedSpeed: Math.round(finalFeedSpeed * 10) / 10
                };
            }
        }

        // „Ç∞„É≠„Éº„Éê„É´„Ç§„É≥„Çπ„Çø„É≥„Çπ
        const weldingAI = new WeldingAIService();
        const calculator = new WeldingCalculator();

        // DOMË¶ÅÁ¥†„ÅÆÂèñÂæó
        const elements = {
            mainMenu: document.getElementById('mainMenu'),
            optimalDiagnosis: document.getElementById('optimalDiagnosis'),
            inputSimulation: document.getElementById('inputSimulation'),
            optimalDiagnosisBtn: document.getElementById('optimalDiagnosisBtn'),
            inputSimulationBtn: document.getElementById('inputSimulationBtn'),
            aiDiagnosisBtn: document.getElementById('aiDiagnosisBtn'),
            detailedSimBtn: document.getElementById('detailedSimBtn'),
            diagnosisResult: document.getElementById('diagnosisResult'),
            simulationResult: document.getElementById('simulationResult'),
            weldingMethod: document.getElementById('weldingMethod'),
            grooveType: document.getElementById('grooveType'),
            grooveDetails: document.getElementById('grooveDetails'),
            filletSettings: document.getElementById('filletSettings'),
            weavingEnabled: document.getElementById('weavingEnabled'),
            weavingSettings: document.getElementById('weavingSettings'),
            // „Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥Áî®
            weldingCurrent: document.getElementById('weldingCurrent'),
            weldingVoltage: document.getElementById('weldingVoltage'),
            wireFeedSpeed: document.getElementById('wireFeedSpeed'),
            simMaterial: document.getElementById('simMaterial'),
            simWireSize: document.getElementById('simWireSize'),
            simWireType: document.getElementById('simWireType'),
            simShieldGas: document.getElementById('simShieldGas'),
            wireTypeWarning: document.getElementById('wireTypeWarning'),
            // „Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥Áî®Êñ∞Ë¶èËøΩÂä†Ë¶ÅÁ¥†
            simWeldingMethod: document.getElementById('simWeldingMethod'),
            simGrooveType: document.getElementById('simGrooveType'),
            simGrooveDetails: document.getElementById('simGrooveDetails'),
            simFilletSettings: document.getElementById('simFilletSettings')
        };

        // È´òÁ≤æÂ∫¶‰∏ÄÂÖÉÊ©üËÉΩ: ÂÆüÈ®ì„Éá„Éº„Çø„Éô„Éº„Çπ„Å´Âü∫„Å•„ÅèË®àÁÆó
        function updateAutoCalculations() {
            const current = parseFloat(elements.weldingCurrent.value) || 150;
            const material = elements.simMaterial.value || 'SS400';
            const gas = elements.simShieldGas.value || 'CO2';
            const wireType = elements.simWireType.value || 'Solid';
            const wireSize = elements.simWireSize.value || '1.0';
            
            const result = calculator.calculateWeldingParameters(current, material, gas, wireType, wireSize);
            
            elements.weldingVoltage.value = result.voltage;
            elements.wireFeedSpeed.value = result.feedSpeed;
            
            // Ë¶ñË¶öÁöÑ„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ
            elements.weldingVoltage.style.transform = 'scale(1.05)';
            elements.wireFeedSpeed.style.transform = 'scale(1.05)';
            setTimeout(() => {
                elements.weldingVoltage.style.transform = 'scale(1.0)';
                elements.wireFeedSpeed.style.transform = 'scale(1.0)';
            }, 200);
        }

        // „Çπ„ÉÜ„É≥„É¨„ÇπÁ≥ªÊùêË≥™„Åß„ÅÆ„ÉØ„Ç§„É§Á®ÆÈ°ûÂà∂Èôê„ÉÅ„Çß„ÉÉ„ÇØ
        function checkWireTypeCompatibility() {
            const material = elements.simMaterial.value;
            const wireType = elements.simWireType.value;
            const warning = elements.wireTypeWarning;
            
            if (material.includes('SUS') && wireType === 'Solid') {
                warning.classList.remove('hidden');
                // Ëá™ÂãïÁöÑ„Å´„Éï„É©„ÉÉ„ÇØ„Çπ„ÉØ„Ç§„É§„Å´Â§âÊõ¥
                elements.simWireType.value = 'Flux-Cored';
                updateAutoCalculations();
            } else {
                warning.classList.add('hidden');
            }
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÅÆË®≠ÂÆö
        function initializeEventListeners() {
            // „É°„Éã„É•„Éº„Éú„Çø„É≥
            elements.optimalDiagnosisBtn?.addEventListener('click', showOptimalDiagnosis);
            elements.inputSimulationBtn?.addEventListener('click', showInputSimulation);
            
            // AIË®∫Êñ≠„Éª„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„Éú„Çø„É≥
            elements.aiDiagnosisBtn?.addEventListener('click', runAIDiagnosis);
            elements.detailedSimBtn?.addEventListener('click', runDetailedSimulation);
            
            // Êàª„Çã„Éú„Çø„É≥
            document.querySelectorAll('.back-btn').forEach(btn => {
                btn.addEventListener('click', showMainMenu);
            });

            // Êù°‰ª∂Â§âÊõ¥ÊôÇ„ÅÆË°®Á§∫ÂàáÊõøÔºàË®∫Êñ≠ÁîªÈù¢Ôºâ
            elements.weldingMethod?.addEventListener('change', toggleFilletSettings);
            elements.grooveType?.addEventListener('change', toggleGrooveDetails);
            elements.weavingEnabled?.addEventListener('change', toggleWeavingSettings);

            // Êù°‰ª∂Â§âÊõ¥ÊôÇ„ÅÆË°®Á§∫ÂàáÊõøÔºà„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÁîªÈù¢Ôºâ
            elements.simWeldingMethod?.addEventListener('change', toggleSimFilletSettings);
            elements.simGrooveType?.addEventListener('change', toggleSimGrooveDetails);

            // ‰∏ÄÂÖÉÊ©üËÉΩ: Êù°‰ª∂Â§âÊõ¥ÊôÇ„ÅÆËá™ÂãïË®àÁÆó
            elements.weldingCurrent?.addEventListener('input', updateAutoCalculations);
            elements.simWireSize?.addEventListener('change', updateAutoCalculations);
            elements.simWireType?.addEventListener('change', () => {
                updateAutoCalculations();
                checkWireTypeCompatibility();
            });
            elements.simMaterial?.addEventListener('change', () => {
                updateAutoCalculations();
                checkWireTypeCompatibility();
            });
            elements.simShieldGas?.addEventListener('change', updateAutoCalculations);
        }

        // ÁîªÈù¢ÂàáÊõøÈñ¢Êï∞
        function showMainMenu() {
            elements.mainMenu.classList.remove('hidden');
            elements.optimalDiagnosis.classList.add('hidden');
            elements.inputSimulation.classList.add('hidden');
        }

        function showOptimalDiagnosis() {
            elements.mainMenu.classList.add('hidden');
            elements.optimalDiagnosis.classList.remove('hidden');
            elements.inputSimulation.classList.add('hidden');
        }

        function showInputSimulation() {
            elements.mainMenu.classList.add('hidden');
            elements.optimalDiagnosis.classList.add('hidden');
            elements.inputSimulation.classList.remove('hidden');
            // „Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÁîªÈù¢Ë°®Á§∫ÊôÇ„Å´Ë°®Á§∫ÂàáÊõø„Å®Ë®àÁÆó„ÇíÊõ¥Êñ∞
            setTimeout(() => {
                toggleSimFilletSettings();
                toggleSimGrooveDetails();
                updateAutoCalculations();
                checkWireTypeCompatibility();
            }, 100);
        }

        // Ë°®Á§∫ÂàáÊõøÈñ¢Êï∞ÔºàË®∫Êñ≠ÁîªÈù¢Áî®Ôºâ
        function toggleFilletSettings() {
            const isFilletWelding = elements.weldingMethod.value === 'fillet';
            if (elements.filletSettings) {
                elements.filletSettings.classList.toggle('hidden', !isFilletWelding);
            }
        }

        function toggleGrooveDetails() {
            const hasGroove = elements.grooveType.value !== 'none';
            if (elements.grooveDetails) {
                elements.grooveDetails.classList.toggle('hidden', !hasGroove);
            }
        }

        function toggleWeavingSettings() {
            const weavingEnabled = elements.weavingEnabled.value === 'true';
            if (elements.weavingSettings) {
                elements.weavingSettings.classList.toggle('hidden', !weavingEnabled);
            }
        }

        // Ë°®Á§∫ÂàáÊõøÈñ¢Êï∞Ôºà„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÁîªÈù¢Áî®Ôºâ
        function toggleSimFilletSettings() {
            const isFilletWelding = elements.simWeldingMethod?.value === 'fillet';
            if (elements.simFilletSettings) {
                elements.simFilletSettings.classList.toggle('hidden', !isFilletWelding);
            }
        }

        function toggleSimGrooveDetails() {
            const hasGroove = elements.simGrooveType?.value !== 'none';
            if (elements.simGrooveDetails) {
                elements.simGrooveDetails.classList.toggle('hidden', !hasGroove);
            }
        }

        // AIË®∫Êñ≠ÂÆüË°å
        async function runAIDiagnosis() {
            const button = elements.aiDiagnosisBtn;
            const resultDiv = elements.diagnosisResult;
            
            button.disabled = true;
            button.innerHTML = '<div class="loading-spinner inline-block mr-2"></div>ü§ñ Gemini 2.5 Flash Ëß£Êûê‰∏≠...';
            
            try {
                const conditions = collectOptimalConditions();
                const result = await weldingAI.diagnoseWeldingConditions(conditions);
                displayDiagnosisResult(result);
            } catch (error) {
                console.error('AIË®∫Êñ≠„Ç®„É©„Éº:', error);
                resultDiv.innerHTML = `
                    <div class="text-red-400 space-y-4">
                        <i class="fas fa-exclamation-triangle text-4xl"></i>
                        <p class="text-lg font-semibold">üö® Gemini 2.5 Flash „Ç®„É©„Éº</p>
                        <p class="text-sm">${error.message}</p>
                        <p class="text-xs text-gray-400">API„Ç≠„ÉºÁ¢∫Ë™çÊ∏à„Åø: ${weldingAI.API_KEY ? '‚úÖ' : '‚ùå'}</p>
                    </div>
                `;
            } finally {
                button.disabled = false;
                button.innerHTML = '<i class="fas fa-magic mr-2"></i>AIË®∫Êñ≠ÈñãÂßã';
            }
        }

        // Ë©≥Á¥∞„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÂÆüË°å
        async function runDetailedSimulation() {
            const button = elements.detailedSimBtn;
            const resultDiv = elements.simulationResult;
            
            button.disabled = true;
            button.innerHTML = '<div class="loading-spinner inline-block mr-2"></div>üîç Gemini 2.5 Flash Ëß£Êûê‰∏≠...';
            
            try {
                const conditions = collectSimulationConditions();
                const result = await weldingAI.simulateWeldingConditions(conditions);
                displaySimulationResult(result);
            } catch (error) {
                console.error('„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„Ç®„É©„Éº:', error);
                resultDiv.innerHTML = `
                    <div class="text-red-400 space-y-4">
                        <i class="fas fa-exclamation-triangle text-4xl"></i>
                        <p class="text-lg font-semibold">üö® Gemini 2.5 Flash „Ç®„É©„Éº</p>
                        <p class="text-sm">${error.message}</p>
                        <p class="text-xs text-gray-400">API„Ç≠„ÉºÁ¢∫Ë™çÊ∏à„Åø: ${weldingAI.API_KEY ? '‚úÖ' : '‚ùå'}</p>
                    </div>
                `;
            } finally {
                button.disabled = false;
                button.innerHTML = '<i class="fas fa-calculator mr-2"></i>Ë©≥Á¥∞„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÂÆüË°å';
            }
        }

        // Êù°‰ª∂ÂèéÈõÜÈñ¢Êï∞
        function collectOptimalConditions() {
            return {
                material: document.getElementById('material')?.value || 'SS400',
                shieldGas: document.getElementById('shieldGas')?.value || 'CO2',
                wireType: document.getElementById('wireType')?.value || 'Solid',
                thickness1: parseFloat(document.getElementById('thickness1')?.value || '6'),
                thickness2: parseFloat(document.getElementById('thickness2')?.value || '6'),
                weldingMethod: document.getElementById('weldingMethod')?.value || 'butt',
                grooveType: document.getElementById('grooveType')?.value || 'none',
                grooveAngle: parseFloat(document.getElementById('grooveAngle')?.value || '60'),
                grooveWidth: parseFloat(document.getElementById('grooveWidth')?.value || '2.0'),
                grooveDepth: document.getElementById('grooveDepth')?.value || 'unknown',
                wireSize: parseFloat(document.getElementById('wireSize')?.value || '1.0'),
                legLength: document.getElementById('legLength')?.value || 'unknown',
                throatThickness: document.getElementById('throatThickness')?.value || 'unknown',
                weldingLength: parseFloat(document.getElementById('weldingLength')?.value || '100'),
                weldingPriority: document.getElementById('weldingPriority')?.value || 'unknown'
            };
        }

        // „Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥Êù°‰ª∂ÂèéÈõÜÈñ¢Êï∞
        function collectSimulationConditions() {
            return {
                material: elements.simMaterial?.value || 'SS400',
                shieldGas: elements.simShieldGas?.value || 'CO2',
                wireType: elements.simWireType?.value || 'Solid',
                thickness1: parseFloat(document.getElementById('simThickness1')?.value || '6'),
                thickness2: parseFloat(document.getElementById('simThickness2')?.value || '6'),
                weldingMethod: elements.simWeldingMethod?.value || 'butt',
                grooveType: elements.simGrooveType?.value || 'none',
                grooveAngle: parseFloat(document.getElementById('simGrooveAngle')?.value || '60'),
                grooveWidth: parseFloat(document.getElementById('simGrooveWidth')?.value || '2.0'),
                grooveDepth: document.getElementById('simGrooveDepth')?.value || 'unknown',
                wireSize: parseFloat(elements.simWireSize?.value || '1.0'),
                legLength: document.getElementById('simLegLength')?.value || 'unknown',
                throatThickness: document.getElementById('simThroatThickness')?.value || 'unknown',
                weldingLength: parseFloat(document.getElementById('simWeldingLength')?.value || '100'),
                current: parseFloat(elements.weldingCurrent?.value || '150'),
                voltage: parseFloat(elements.weldingVoltage?.value || '19'),
                feedSpeed: parseFloat(elements.wireFeedSpeed?.value || '6.5'),
                preFlow: parseFloat(document.getElementById('preFlow')?.value || '0.1'),
                afterFlow: parseFloat(document.getElementById('afterFlow')?.value || '0.4'),
                weaving: document.getElementById('weavingEnabled')?.value === 'true',
                weavingWidth: parseFloat(document.getElementById('weavingWidth')?.value || '3.0'),
                weavingFrequency: parseFloat(document.getElementById('weavingFrequency')?.value || '1.0')
            };
        }

        // ÁµêÊûúË°®Á§∫Èñ¢Êï∞
        function displayDiagnosisResult(result) {
            elements.diagnosisResult.innerHTML = `
                <div class="result-card p-6 rounded-lg space-y-4 text-left">
                    <div class="flex items-center space-x-2 mb-4">
                        <i class="fas fa-brain text-blue-400"></i>
                        <h4 class="text-lg font-bold">ü§ñ Gemini 2.5 Flash AIË®∫Êñ≠ÁµêÊûú</h4>
                    </div>
                    <div class="text-sm leading-relaxed whitespace-pre-wrap">${result}</div>
                    <div class="mt-6 p-4 bg-blue-900/30 rounded-lg">
                        <p class="text-xs text-blue-300">
                            <i class="fas fa-info-circle mr-1"></i>
                            „Åì„ÅÆË®∫Êñ≠ÁµêÊûú„ÅØÂÆüÈ®ì„Éá„Éº„Çø„Éô„Éº„Çπ„Å´Âü∫„Å•„ÅèÂèÇËÄÉÊÉÖÂ†±„Åß„Åô„ÄÇÂÆüÈöõ„ÅÆÊ∫∂Êé•ÊôÇ„ÅØÁèæÂ†¥„Åß„ÅÆË©¶È®ìÊ∫∂Êé•„ÇíÂÆüÊñΩ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                        </p>
                    </div>
                </div>
            `;
        }

        function displaySimulationResult(result) {
            elements.simulationResult.innerHTML = `
                <div class="result-card p-6 rounded-lg space-y-4 text-left">
                    <div class="flex items-center space-x-2 mb-4">
                        <i class="fas fa-chart-line text-orange-400"></i>
                        <h4 class="text-lg font-bold">üìä Ê∫∂Êé•Êù°‰ª∂Ë©ï‰æ°ÁµêÊûú</h4>
                    </div>
                    <div class="text-sm leading-relaxed whitespace-pre-wrap">${result}</div>
                    <div class="mt-6 p-4 bg-orange-900/30 rounded-lg">
                        <p class="text-xs text-orange-300">
                            <i class="fas fa-exclamation-triangle mr-1"></i>
                            Ë©ï‰æ°ÁµêÊûú„ÅØÂÆüÈ®ì„Éá„Éº„Çø„Éô„Éº„Çπ„Å´Âü∫„Å•„ÅèÂàÜÊûê„Åß„Åô„ÄÇÂÆüÈöõ„ÅÆÂìÅË≥™„ÅØÁèæÂ†¥Êù°‰ª∂„Å´„Çà„ÇäÂ§âÂãï„Åô„ÇãÂ†¥Âêà„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ
                        </p>
                    </div>
                </div>
            `;
        }

        // ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üîß DOMË™≠„ÅøËæº„ÅøÂÆå‰∫Ü - ÂàùÊúüÂåñÈñãÂßã');
            console.log('ü§ñ API„Ç≠„ÉºË®≠ÂÆöÁ¢∫Ë™ç:', weldingAI.API_KEY ? '‚úÖ Ê≠£Â∏∏' : '‚ùå Êú™Ë®≠ÂÆö');
            console.log('‚ö° ÂÆüÈ®ì„Éá„Éº„Çø„Éô„Éº„ÇπÂàùÊúüÂåñ:', calculator ? '‚úÖ ÂÆå‰∫Ü' : '‚ùå Â§±Êïó');
            
            initializeEventListeners();
            
            // ÂàùÊúüË°®Á§∫Ë®≠ÂÆö
            toggleFilletSettings();
            toggleGrooveDetails();
            toggleWeavingSettings();
            
            // ÂàùÊúüË®àÁÆóÂÆüË°å
            updateAutoCalculations();
            checkWireTypeCompatibility();
            
            console.log('‚úÖ AIÊ∫∂Êé•ÊîØÊè¥„Ç¢„Éó„É™ÂÆåÂÖ®ÂàùÊúüÂåñÂÆå‰∫Ü - ÂÆüÈ®ì„Éá„Éº„Çø„Éô„Éº„Çπ‰∏ÄÂÖÉË®àÁÆó„É≠„Ç∏„ÉÉ„ÇØÂÆüË£ÖÁâà');
        });

    </script>
</body>
</html>
