<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæº¶æ¥æ”¯æ´ã‚¢ãƒ—ãƒª - æ ªå¼ä¼šç¤¾ã‚¢ã‚¤ãƒ¯ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script type="importmap">
    {
      "imports": {
        "@google/generative-ai": "https://esm.run/@google/generative-ai"
      }
    }
    </script>
    <style>
        :root {
            --primary-color: #1e3a8a;
            --secondary-color: #ea580c;
            --accent-color: #06b6d4;
            --bg-dark: #0f172a;
            --surface-dark: #1e293b;
            --text-light: #f8fafc;
        }

        body {
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a2332 100%);
            color: var(--text-light);
            min-height: 100vh;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .glass-card {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .gradient-border {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color), var(--accent-color));
            padding: 2px;
            border-radius: 12px;
        }

        .gradient-border-content {
            background: var(--surface-dark);
            border-radius: 10px;
            height: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(30, 58, 138, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(30, 58, 138, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary-color) 0%, #dc2626 100%);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(234, 88, 12, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(234, 88, 12, 0.4);
        }

        .header-logo {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .ai-status {
            background: linear-gradient(90deg, #10b981, #06b6d4);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: pulse 2s ease-in-out infinite alternate;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            100% { opacity: 0.7; }
        }

        .sparks {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }

        .spark {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--secondary-color);
            border-radius: 50%;
            animation: sparkle 2s linear infinite;
        }

        @keyframes sparkle {
            0% { 
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% { 
                transform: translateY(-100px) scale(0);
                opacity: 0;
            }
        }

        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid var(--accent-color);
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8) 0%, rgba(15, 23, 42, 0.9) 100%);
            border: 1px solid rgba(6, 182, 212, 0.3);
            box-shadow: 0 0 20px rgba(6, 182, 212, 0.1);
        }

        .parameter-input {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .parameter-input:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px rgba(6, 182, 212, 0.2);
        }

        .parameter-input.auto-calculated {
            background: rgba(6, 182, 212, 0.2);
            border-color: var(--accent-color);
            color: #06b6d4;
            font-weight: bold;
        }

        select.parameter-input option {
            background: var(--surface-dark);
            color: var(--text-light);
        }

        .process-step {
            position: relative;
            padding-left: 2rem;
        }

        .process-step::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0.5rem;
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 50%;
            background: var(--accent-color);
        }

        .hidden {
            display: none !important;
        }

        .company-logo {
            max-width: 400px;
            height: auto;
            filter: brightness(1.1);
        }

        .auto-voltage-indicator {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(90deg, #10b981, #06b6d4);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-left: 8px;
            animation: pulse 2s ease-in-out infinite alternate;
        }

        .warning-badge {
            background: linear-gradient(90deg, #f59e0b, #d97706);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin-left: 8px;
        }

        .gas-indicator {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(90deg, #8b5cf6, #a855f7);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin-left: 8px;
        }

        .auto-speed-indicator {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(90deg, #ef4444, #dc2626);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin-left: 8px;
        }

        .wire-type-indicator {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(90deg, #059669, #10b981);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin-left: 8px;
        }

        .flux-wire-indicator {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(90deg, #dc2626, #ef4444);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin-left: 8px;
        }

        @media (max-width: 768px) {
            .company-logo {
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="glass-card rounded-none border-0 border-b border-gray-600">
        <div class="container mx-auto px-6 py-4">
            <div class="flex flex-col items-center space-y-3">
                <!-- Company Logo -->
                <div class="flex items-center space-x-4">
                    <svg width="400" height="120" viewBox="0 0 400 120" fill="none" xmlns="http://www.w3.org/2000/svg" class="company-logo">
                        <defs>
                            <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#ff6941"/>
                                <stop offset="100%" stop-color="#ea580c"/>
                            </linearGradient>
                            <linearGradient id="grad2" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#10b981"/>
                                <stop offset="100%" stop-color="#06b6d4"/>
                            </linearGradient>
                            <linearGradient id="grad3" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#3357dc"/>
                                <stop offset="100%" stop-color="#1e3a8a"/>
                            </linearGradient>
                        </defs>
                        <rect x="10" y="30" width="35" height="60" rx="17" fill="url(#grad1)"/>
                        <rect x="55" y="30" width="35" height="60" rx="17" fill="url(#grad2)"/>
                        <rect x="100" y="30" width="35" height="60" rx="17" fill="url(#grad3)"/>
                        <text x="150" y="45" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#f8fafc">æ ªå¼ä¼šç¤¾</text>
                        <text x="150" y="68" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#f8fafc">ã‚¢ã‚¤ãƒ¯ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</text>
                        <text x="150" y="85" font-family="Arial, sans-serif" font-size="12" font-style="italic" fill="#d1d5db">AIWA Engineering</text>
                    </svg>
                </div>
                
                <!-- App Title and AI Status -->
                <div class="text-center">
                    <h1 class="text-2xl md:text-3xl font-bold header-logo mb-2">AIæº¶æ¥æ”¯æ´ã‚¢ãƒ—ãƒª</h1>
                    <div class="flex items-center justify-center space-x-2">
                        <i class="fas fa-robot text-lg"></i>
                        <span class="ai-status font-semibold">ğŸ¤– Gemini 2.5 Flash: ç¨¼åƒä¸­</span>
                        <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                    </div>
                </div>

                <!-- Navigation -->
                <nav class="flex flex-wrap justify-center space-x-4 text-sm">
                    <span class="text-gray-300">å¯¾å¿œæ©Ÿå™¨:</span>
                    <span class="text-blue-400">ãƒ€ã‚¤ãƒ˜ãƒ³ WELBEE M-350L</span>
                    <span class="text-gray-400">|</span>
                    <span class="text-blue-400">FD19-VC4 å”åƒãƒ­ãƒœãƒƒãƒˆ (å¯æ¬è³ªé‡4kg)</span>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        <!-- Main Menu -->
        <div id="mainMenu" class="space-y-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold mb-4">æº¶æ¥æ”¯æ´æ©Ÿèƒ½é¸æŠ</h2>
                <p class="text-gray-300 max-w-2xl mx-auto">
                    AIæŠ€è¡“ã‚’æ´»ç”¨ã—ãŸé«˜ç²¾åº¦ãªæº¶æ¥æ¡ä»¶è¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ ã€‚æ•™è‚²ãƒ»ç ”ä¿®ã‹ã‚‰å®Ÿå‹™ã¾ã§å¹…åºƒãå¯¾å¿œã—ã¾ã™ã€‚
                </p>
            </div>

            <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                <!-- æº¶æ¥æœ€é©æ¡ä»¶è¨ºæ–­ -->
                <div class="gradient-border">
                    <div class="gradient-border-content p-8 text-center space-y-6">
                        <div class="sparks">
                            <div class="spark" style="left: 20%; animation-delay: 0s;"></div>
                            <div class="spark" style="left: 50%; animation-delay: 0.5s;"></div>
                            <div class="spark" style="left: 80%; animation-delay: 1s;"></div>
                        </div>
                        <div class="text-6xl text-blue-400 mb-4">
                            <i class="fas fa-brain"></i>
                        </div>
                        <h3 class="text-2xl font-bold">æº¶æ¥æœ€é©æ¡ä»¶è¨ºæ–­</h3>
                        <p class="text-gray-300">
                            ææ–™ãƒ»æ¿åšãƒ»æº¶æ¥æ–¹æ³•ã‚’å…¥åŠ›ã™ã‚‹ã ã‘ã§ã€AIãŒæœ€é©ãªæº¶æ¥æ¡ä»¶ã‚’è‡ªå‹•è¨ºæ–­ã€‚
                            åˆå¿ƒè€…ã‹ã‚‰ä¸Šç´šè€…ã¾ã§å®‰å¿ƒã—ã¦ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚
                        </p>
                        <button id="optimalDiagnosisBtn" class="btn-primary text-white px-8 py-3 rounded-lg font-semibold w-full">
                            <i class="fas fa-magic mr-2"></i>AIè¨ºæ–­ã‚’é–‹å§‹
                        </button>
                    </div>
                </div>

                <!-- æº¶æ¥æ¡ä»¶å…¥åŠ›ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ -->
                <div class="gradient-border">
                    <div class="gradient-border-content p-8 text-center space-y-6">
                        <div class="text-6xl text-orange-400 mb-4">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <h3 class="text-2xl font-bold">æº¶æ¥æ¡ä»¶å…¥åŠ›ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h3>
                        <p class="text-gray-300">
                            è©³ç´°ãªæº¶æ¥æ¡ä»¶ã‚’å…¥åŠ›ã—ã¦å“è³ªäºˆæ¸¬ã¨A/S/B/C/Dè©•ä¾¡ã‚’å®Ÿæ–½ã€‚
                            è¨­å®šæ¡ä»¶ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯ã¨æ”¹å–„ææ¡ˆã‚’è¡Œã„ã¾ã™ã€‚
                        </p>
                        <button id="inputSimulationBtn" class="btn-secondary text-white px-8 py-3 rounded-lg font-semibold w-full">
                            <i class="fas fa-calculator mr-2"></i>è©³ç´°ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                        </button>
                    </div>
                </div>
            </div>

            <!-- å…è²¬äº‹é … -->
            <div class="glass-card p-6 mt-12 max-w-4xl mx-auto">
                <div class="text-center">
                    <h4 class="text-lg font-semibold mb-4 text-yellow-400">
                        <i class="fas fa-exclamation-triangle mr-2"></i>é‡è¦ãªã”æ³¨æ„
                    </h4>
                    <div class="text-sm text-gray-300 space-y-2">
                        <p>
                            æœ¬ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€AIæŠ€è¡“ã‚’æ´»ç”¨ã—ãŸæº¶æ¥æ¡ä»¶ã®å‚è€ƒæƒ…å ±æä¾›ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€
                            æº¶æ¥ä½œæ¥­ã®çµæœã‚„å“è³ªã«ã¤ã„ã¦ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ã”ã–ã„ã¾ã›ã‚“ã€‚
                        </p>
                        <p>
                            å®Ÿéš›ã®æº¶æ¥ä½œæ¥­ã«ãŠã„ã¦ã¯ã€å¿…ãšç¾å ´ã§ã®è©¦é¨“æº¶æ¥ãŠã‚ˆã³å“è³ªç¢ºèªã‚’å®Ÿæ–½ã—ã€
                            é©åˆ‡ãªæŠ€èƒ½ã‚’æœ‰ã™ã‚‹ä½œæ¥­è€…ã«ã‚ˆã‚‹æœ€çµ‚åˆ¤æ–­ã®ã‚‚ã¨ã§ä½œæ¥­ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- æº¶æ¥æœ€é©æ¡ä»¶è¨ºæ–­ç”»é¢ -->
        <div id="optimalDiagnosis" class="hidden space-y-8">
            <div class="flex items-center justify-between">
                <h2 class="text-3xl font-bold">æº¶æ¥æœ€é©æ¡ä»¶è¨ºæ–­</h2>
                <button class="back-btn text-blue-400 hover:text-blue-300">
                    <i class="fas fa-arrow-left mr-2"></i>ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹
                </button>
            </div>

            <div class="grid lg:grid-cols-2 gap-8">
                <!-- å…¥åŠ›ãƒ‘ãƒãƒ« -->
                <div class="glass-card p-6 space-y-6">
                    <h3 class="text-xl font-bold mb-4">æº¶æ¥æ¡ä»¶å…¥åŠ›</h3>
                    
                    <!-- æ¯æé¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æ¯æ</label>
                        <select id="material" class="parameter-input w-full p-3 rounded-lg">
                            <option value="SS400">SS400 (ä¸€èˆ¬æ§‹é€ ç”¨åœ§å»¶é‹¼æ)</option>
                            <option value="SM490">SM490 (æº¶æ¥æ§‹é€ ç”¨åœ§å»¶é‹¼æ)</option>
                            <option value="SUS304">SUS304 (ã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆç³»ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼)</option>
                            <option value="SUS316L">SUS316L (ä½ç‚­ç´ ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼)</option>
                            <option value="SUS430">SUS430 (ãƒ•ã‚§ãƒ©ã‚¤ãƒˆç³»ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼)</option>
                        </select>
                    </div>

                    <!-- ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹é¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹
                            <span class="gas-indicator">
                                ğŸ’¨ ã‚¬ã‚¹ç¨®é¡
                            </span>
                        </label>
                        <select id="shieldGas" class="parameter-input w-full p-3 rounded-lg">
                            <option value="CO2">CO2 (ç‚­é…¸ã‚¬ã‚¹) - é«˜æº¶ã‘è¾¼ã¿ãƒ»çµŒæ¸ˆçš„</option>
                            <option value="MAG_Ar80CO2_20">MAG (Ar80%+CO2 20%) - ä½ã‚¹ãƒ‘ãƒƒã‚¿ãƒ»é«˜å“è³ª</option>
                            <option value="MAG_Ar75CO2_25">MAG (Ar75%+CO2 25%) - ãƒãƒ©ãƒ³ã‚¹å‹</option>
                        </select>
                    </div>

                    <!-- æ¿åšè¨­å®š -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">æ¿åš1 (mm)</label>
                            <input type="number" id="thickness1" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0.5" max="25" step="0.1" value="6.0">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">æ¿åš2 (mm)</label>
                            <input type="number" id="thickness2" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0.5" max="25" step="0.1" value="6.0">
                        </div>
                    </div>

                    <!-- æº¶æ¥æ–¹æ³•é¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æº¶æ¥æ–¹æ³•</label>
                        <select id="weldingMethod" class="parameter-input w-full p-3 rounded-lg">
                            <option value="butt">çªãåˆã‚ã›æº¶æ¥</option>
                            <option value="fillet">éš…è‚‰æº¶æ¥</option>
                        </select>
                    </div>

                    <!-- é–‹å…ˆè¨­å®š -->
                    <div id="grooveSection">
                        <label class="block text-sm font-semibold mb-2">é–‹å…ˆã®æœ‰ç„¡</label>
                        <select id="grooveType" class="parameter-input w-full p-3 rounded-lg mb-4">
                            <option value="none">é–‹å…ˆãªã—</option>
                            <option value="v-groove">Vå‹é–‹å…ˆ</option>
                            <option value="x-groove">Xå‹é–‹å…ˆï¼ˆä¸¡é¢ï¼‰</option>
                            <option value="u-groove">Uå‹é–‹å…ˆï¼ˆæ·±æºå‹ï¼‰</option>
                            <option value="bevel">ãƒ™ãƒ™ãƒ«åŠ å·¥</option>
                            <option value="j-groove">Jå‹é–‹å…ˆ</option>
                        </select>

                        <!-- é–‹å…ˆè©³ç´°è¨­å®š -->
                        <div id="grooveDetails" class="hidden space-y-4">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold mb-2">é–‹å…ˆè§’åº¦ (åº¦)</label>
                                    <input type="number" id="grooveAngle" class="parameter-input w-full p-3 rounded-lg" 
                                           min="15" max="80" step="5" value="60">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold mb-2">é–‹å…ˆå¹… (mm)</label>
                                    <input type="number" id="grooveWidth" class="parameter-input w-full p-3 rounded-lg" 
                                           min="0" max="5" step="0.1" value="2.0">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-2">é–‹å…ˆæ·±ã• (mm)</label>
                                <select id="grooveDepth" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">ä¸æ˜</option>
                                    <option value="3.0">3.0mm</option>
                                    <option value="4.5">4.5mm</option>
                                    <option value="6.0">6.0mm</option>
                                    <option value="7.5">7.5mm</option>
                                    <option value="9.0">9.0mm</option>
                                    <option value="12.0">12.0mm</option>
                                    <option value="15.0">15.0mm</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- ãƒ¯ã‚¤ãƒ¤é¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            æº¶æ¥ãƒ¯ã‚¤ãƒ¤
                            <span class="wire-type-indicator">
                                ğŸ”„ æè³ªé€£å‹•
                            </span>
                        </label>
                        <select id="wireSize" class="parameter-input w-full p-3 rounded-lg">
                            <!-- å‹•çš„ã«æ›´æ–°ã•ã‚Œã‚‹ -->
                        </select>
                    </div>

                    <!-- è„šé•·ãƒ»ã®ã©åšè¨­å®šï¼ˆéš…è‚‰æº¶æ¥æ™‚ã®ã¿è¡¨ç¤ºï¼‰ -->
                    <div id="filletSettings" class="hidden space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold mb-2">è„šé•· (mm)</label>
                                <select id="legLength" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">ä¸æ˜</option>
                                    <option value="3">3mm</option>
                                    <option value="4">4mm</option>
                                    <option value="5">5mm</option>
                                    <option value="6">6mm</option>
                                    <option value="7">7mm</option>
                                    <option value="8">8mm</option>
                                    <option value="10">10mm</option>
                                    <option value="12">12mm</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-2">ã®ã©åš (mm)</label>
                                <select id="throatThickness" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">ä¸æ˜</option>
                                    <option value="2.1">2.1mm</option>
                                    <option value="2.8">2.8mm</option>
                                    <option value="3.5">3.5mm</option>
                                    <option value="4.2">4.2mm</option>
                                    <option value="4.9">4.9mm</option>
                                    <option value="5.6">5.6mm</option>
                                    <option value="7.0">7.0mm</option>
                                    <option value="8.4">8.4mm</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- æº¶æ¥è·é›¢ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æº¶æ¥è·é›¢ (mm)</label>
                        <input type="number" id="weldingLength" class="parameter-input w-full p-3 rounded-lg" 
                               min="10" max="10000" step="10" value="100">
                    </div>

                    <!-- æº¶æ¥å„ªå…ˆåº¦é¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æº¶æ¥é‡è¦–é …ç›®</label>
                        <select id="weldingPriority" class="parameter-input w-full p-3 rounded-lg">
                            <option value="unknown">ä¸æ˜</option>
                            <option value="penetration">æº¶ã‘è¾¼ã¿é‡è¦–</option>
                            <option value="appearance">è¦‹ãŸç›®é‡è¦–</option>
                            <option value="speed">é€Ÿåº¦é‡è¦–</option>
                        </select>
                    </div>

                    <!-- AIè¨ºæ–­ãƒœã‚¿ãƒ³ -->
                    <button id="aiDiagnosisBtn" class="btn-primary text-white px-6 py-4 rounded-lg font-semibold w-full">
                        <i class="fas fa-magic mr-2"></i>AIè¨ºæ–­é–‹å§‹
                    </button>
                </div>

                <!-- çµæœè¡¨ç¤ºãƒ‘ãƒãƒ« -->
                <div class="glass-card p-6">
                    <h3 class="text-xl font-bold mb-4">è¨ºæ–­çµæœ</h3>
                    <div id="diagnosisResult" class="text-center text-gray-400 py-12">
                        <i class="fas fa-robot text-4xl mb-4 opacity-50"></i>
                        <p>æ¡ä»¶ã‚’å…¥åŠ›ã—ã¦AIè¨ºæ–­ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- æº¶æ¥æ¡ä»¶å…¥åŠ›ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”»é¢ -->
        <div id="inputSimulation" class="hidden space-y-8">
            <div class="flex items-center justify-between">
                <h2 class="text-3xl font-bold">æº¶æ¥æ¡ä»¶å…¥åŠ›ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
                <button class="back-btn text-blue-400 hover:text-blue-300">
                    <i class="fas fa-arrow-left mr-2"></i>ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹
                </button>
            </div>

            <div class="grid lg:grid-cols-2 gap-8">
                <!-- è©³ç´°å…¥åŠ›ãƒ‘ãƒãƒ« -->
                <div class="glass-card p-6 space-y-6">
                    <h3 class="text-xl font-bold mb-4">è©³ç´°æº¶æ¥æ¡ä»¶å…¥åŠ›</h3>
                    
                    <!-- æ¯æé¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æ¯æ</label>
                        <select id="simMaterial" class="parameter-input w-full p-3 rounded-lg">
                            <option value="SS400">SS400 (ä¸€èˆ¬æ§‹é€ ç”¨åœ§å»¶é‹¼æ)</option>
                            <option value="SM490">SM490 (æº¶æ¥æ§‹é€ ç”¨åœ§å»¶é‹¼æ)</option>
                            <option value="SUS304">SUS304 (ã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆç³»ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼)</option>
                            <option value="SUS316L">SUS316L (ä½ç‚­ç´ ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼)</option>
                            <option value="SUS430">SUS430 (ãƒ•ã‚§ãƒ©ã‚¤ãƒˆç³»ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼)</option>
                        </select>
                    </div>

                    <!-- ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹
                            <span class="gas-indicator">
                                ğŸ’¨ ã‚¬ã‚¹è£œæ­£
                            </span>
                        </label>
                        <select id="simShieldGas" class="parameter-input w-full p-3 rounded-lg">
                            <option value="CO2">CO2 (ç‚­é…¸ã‚¬ã‚¹)</option>
                            <option value="MAG_Ar80CO2_20">MAG (Ar80%+CO2 20%)</option>
                            <option value="MAG_Ar75CO2_25">MAG (Ar75%+CO2 25%)</option>
                        </select>
                    </div>

                    <!-- æ¿åšè¨­å®š -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">æ¿åš1 (mm)</label>
                            <input type="number" id="simThickness1" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0.5" max="25" step="0.1" value="6.0">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">æ¿åš2 (mm)</label>
                            <input type="number" id="simThickness2" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0.5" max="25" step="0.1" value="6.0">
                        </div>
                    </div>

                    <!-- æº¶æ¥æ–¹æ³•é¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æº¶æ¥æ–¹æ³•</label>
                        <select id="simWeldingMethod" class="parameter-input w-full p-3 rounded-lg">
                            <option value="butt">çªãåˆã‚ã›æº¶æ¥</option>
                            <option value="fillet">éš…è‚‰æº¶æ¥</option>
                        </select>
                    </div>

                    <!-- é–‹å…ˆè¨­å®š -->
                    <div id="simGrooveSection">
                        <label class="block text-sm font-semibold mb-2">é–‹å…ˆã®æœ‰ç„¡</label>
                        <select id="simGrooveType" class="parameter-input w-full p-3 rounded-lg mb-4">
                            <option value="none">é–‹å…ˆãªã—</option>
                            <option value="v-groove">Vå‹é–‹å…ˆ</option>
                            <option value="x-groove">Xå‹é–‹å…ˆï¼ˆä¸¡é¢ï¼‰</option>
                            <option value="u-groove">Uå‹é–‹å…ˆï¼ˆæ·±æºå‹ï¼‰</option>
                            <option value="bevel">ãƒ™ãƒ™ãƒ«åŠ å·¥</option>
                            <option value="j-groove">Jå‹é–‹å…ˆ</option>
                        </select>

                        <!-- é–‹å…ˆè©³ç´°è¨­å®š -->
                        <div id="simGrooveDetails" class="hidden space-y-4">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold mb-2">é–‹å…ˆè§’åº¦ (åº¦)</label>
                                    <input type="number" id="simGrooveAngle" class="parameter-input w-full p-3 rounded-lg" 
                                           min="15" max="80" step="5" value="60">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold mb-2">é–‹å…ˆå¹… (mm)</label>
                                    <input type="number" id="simGrooveWidth" class="parameter-input w-full p-3 rounded-lg" 
                                           min="0" max="5" step="0.1" value="2.0">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-2">é–‹å…ˆæ·±ã• (mm)</label>
                                <select id="simGrooveDepth" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">ä¸æ˜</option>
                                    <option value="3.0">3.0mm</option>
                                    <option value="4.5">4.5mm</option>
                                    <option value="6.0">6.0mm</option>
                                    <option value="7.5">7.5mm</option>
                                    <option value="9.0">9.0mm</option>
                                    <option value="12.0">12.0mm</option>
                                    <option value="15.0">15.0mm</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- è„šé•·ãƒ»ã®ã©åšè¨­å®šï¼ˆéš…è‚‰æº¶æ¥æ™‚ã®ã¿è¡¨ç¤ºï¼‰ -->
                    <div id="simFilletSettings" class="hidden space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold mb-2">è„šé•· (mm)</label>
                                <select id="simLegLength" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">ä¸æ˜</option>
                                    <option value="3">3mm</option>
                                    <option value="4">4mm</option>
                                    <option value="5">5mm</option>
                                    <option value="6">6mm</option>
                                    <option value="7">7mm</option>
                                    <option value="8">8mm</option>
                                    <option value="10">10mm</option>
                                    <option value="12">12mm</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-2">ã®ã©åš (mm)</label>
                                <select id="simThroatThickness" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">ä¸æ˜</option>
                                    <option value="2.1">2.1mm</option>
                                    <option value="2.8">2.8mm</option>
                                    <option value="3.5">3.5mm</option>
                                    <option value="4.2">4.2mm</option>
                                    <option value="4.9">4.9mm</option>
                                    <option value="5.6">5.6mm</option>
                                    <option value="7.0">7.0mm</option>
                                    <option value="8.4">8.4mm</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- æº¶æ¥è·é›¢ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æº¶æ¥è·é›¢ (mm)</label>
                        <input type="number" id="simWeldingLength" class="parameter-input w-full p-3 rounded-lg" 
                               min="10" max="10000" step="10" value="100">
                    </div>

                    <!-- ãƒ¯ã‚¤ãƒ¤é¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            æº¶æ¥ãƒ¯ã‚¤ãƒ¤
                            <span class="wire-type-indicator">
                                ğŸ”„ æè³ªé€£å‹•
                            </span>
                        </label>
                        <select id="simWireSize" class="parameter-input w-full p-3 rounded-lg">
                            <!-- å‹•çš„ã«æ›´æ–°ã•ã‚Œã‚‹ -->
                        </select>
                    </div>

                    <!-- æº¶æ¥é›»æµãƒ»é›»åœ§ï¼ˆä¸€å…ƒæ©Ÿèƒ½ä»˜ãï¼‰ -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">æº¶æ¥é›»æµ (A)</label>
                            <input type="number" id="weldingCurrent" class="parameter-input w-full p-3 rounded-lg" 
                                   min="30" max="350" step="5" value="150">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                æº¶æ¥é›»åœ§ (V)
                                <span class="auto-voltage-indicator">
                                    <i class="fas fa-magic mr-1"></i>ä¸€å…ƒè‡ªå‹•
                                </span>
                            </label>
                            <input type="number" id="weldingVoltage" class="parameter-input auto-calculated w-full p-3 rounded-lg" 
                                   readonly value="19.0">
                        </div>
                    </div>

                    <!-- ãƒ¯ã‚¤ãƒ¤é€çµ¦é€Ÿåº¦å‰Šé™¤ã€ä»£ã‚ã‚Šã«æ³¨æ„è¡¨ç¤º -->
                    <div class="p-3 bg-blue-900/30 rounded-lg">
                        <p class="text-sm text-blue-300">
                            <i class="fas fa-info-circle mr-2"></i>
                            <span class="auto-speed-indicator">
                                ğŸ”„ ä¸€å…ƒè‡ªå‹•
                            </span>
                            ãƒ¯ã‚¤ãƒ¤é€çµ¦é€Ÿåº¦ã¯é›»æµå€¤ã«åŸºã¥ã„ã¦è‡ªå‹•è¨ˆç®—ã•ã‚Œã¾ã™ï¼ˆWELBEE M-350Lä¸€å…ƒæ©Ÿèƒ½ï¼‰
                        </p>
                    </div>

                    <!-- ãƒ—ãƒªãƒ•ãƒ­ãƒ¼ãƒ»ã‚¢ãƒ•ã‚¿ãƒ¼ãƒ•ãƒ­ãƒ¼ -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">ãƒ—ãƒªãƒ•ãƒ­ãƒ¼æ™‚é–“ (ç§’)</label>
                            <input type="number" id="preFlow" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0" max="10" step="0.1" value="0.1">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">ã‚¢ãƒ•ã‚¿ãƒ¼ãƒ•ãƒ­ãƒ¼æ™‚é–“ (ç§’)</label>
                            <input type="number" id="afterFlow" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0" max="10" step="0.1" value="0.4">
                        </div>
                    </div>

                    <!-- ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°è¨­å®šï¼ˆæ³¨æ„è¡¨ç¤ºä»˜ãï¼‰ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°è¨­å®š
                            <span class="warning-badge">
                                âš ï¸ ãƒ­ãƒœãƒƒãƒˆåˆ¶å¾¡æ™‚ã®ã¿
                            </span>
                        </label>
                        <div class="space-y-3">
                            <select id="weavingEnabled" class="parameter-input w-full p-3 rounded-lg">
                                <option value="false">ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°ãªã—</option>
                                <option value="true">ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°ã‚ã‚Šï¼ˆFD19-VC4åˆ¶å¾¡ï¼‰</option>
                            </select>
                            <div id="weavingSettings" class="hidden space-y-3">
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-semibold mb-2">ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°å¹… (mm)</label>
                                        <input type="number" id="weavingWidth" class="parameter-input w-full p-3 rounded-lg" 
                                               min="0.5" max="10" step="0.5" value="3.0">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold mb-2">ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°å‘¨æ³¢æ•° (Hz)</label>
                                        <input type="number" id="weavingFrequency" class="parameter-input w-full p-3 rounded-lg" 
                                               min="0.1" max="5.0" step="0.1" value="1.0">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
                    <button id="detailedSimBtn" class="btn-secondary text-white px-6 py-4 rounded-lg font-semibold w-full">
                        <i class="fas fa-calculator mr-2"></i>è©³ç´°ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
                    </button>
                </div>

                <!-- ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ -->
                <div class="glass-card p-6">
                    <h3 class="text-xl font-bold mb-4">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ</h3>
                    <div id="simulationResult" class="text-center text-gray-400 py-12">
                        <i class="fas fa-chart-line text-4xl mb-4 opacity-50"></i>
                        <p>æ¡ä»¶ã‚’å…¥åŠ›ã—ã¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="glass-card rounded-none border-0 border-t border-gray-600 mt-16">
        <div class="container mx-auto px-6 py-8">
            <div class="text-center space-y-4">
                <div class="flex items-center justify-center space-x-2">
                    <i class="fas fa-copyright text-gray-400"></i>
                    <span class="text-gray-300">2025 æ ªå¼ä¼šç¤¾ã‚¢ã‚¤ãƒ¯ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</span>
                </div>
                <div class="text-sm text-gray-400 space-y-2">
                    <p>æº¶æ¥æŠ€è¡“ã®ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆ - æ•™è‚²ã‹ã‚‰å®Ÿå‹™ã¾ã§å¹…åºƒãã‚µãƒãƒ¼ãƒˆ</p>
                    <p>æœ¬ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ©ç”¨ã«ã‚ˆã‚Šç”Ÿã˜ãŸæå®³ã«ã¤ã„ã¦ã€å¼Šç¤¾ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã‹ã­ã¾ã™ã€‚</p>
                </div>
            </div>
        </div>
    </footer>

    <script type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";

        class WeldingAIService {
            constructor() {
                this.API_KEY = 'AIzaSyBivo2r8DpE8DATru1Vy8JuinouvrZwRHk';
                this.genAI = new GoogleGenerativeAI(this.API_KEY);
                this.model = this.genAI.getGenerativeModel({ 
                    model: "gemini-2.5-flash",
                    generationConfig: {
                        temperature: 0.2,
                        topK: 32,
                        topP: 0.9,
                        maxOutputTokens: 8192,
                    }
                });
                console.log('âœ… Gemini 2.5 FlashåˆæœŸåŒ–å®Œäº†');
            }

            async diagnoseWeldingConditions(conditions) {
                const prompt = this.createOptimalDiagnosisPrompt(conditions);
                try {
                    const result = await this.model.generateContent(prompt);
                    const response = await result.response;
                    return response.text();
                } catch (error) {
                    console.error('AIè¨ºæ–­ã‚¨ãƒ©ãƒ¼:', error);
                    throw new Error(`Gemini 2.5 Flashè¨ºæ–­ã«å¤±æ•—ã—ã¾ã—ãŸ: ${error.message}`);
                }
            }

            async simulateWeldingConditions(conditions) {
                const prompt = this.createSimulationPrompt(conditions);
                try {
                    const result = await this.model.generateContent(prompt);
                    const response = await result.response;
                    return response.text();
                } catch (error) {
                    console.error('ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼:', error);
                    throw new Error(`Gemini 2.5 Flashã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ: ${error.message}`);
                }
            }

            createOptimalDiagnosisPrompt(conditions) {
                return `
ã€ãƒ€ã‚¤ãƒ˜ãƒ³WELBEE M-350L & FD19-VC4 é«˜ç²¾åº¦æº¶æ¥è¨ºæ–­ã€‘

ã‚ãªãŸã¯æº¶æ¥å·¥å­¦ã®ä¸–ç•Œçš„å°‚é–€å®¶ã¨ã—ã¦ã€æœ€é«˜ç²¾åº¦ã®è¨ºæ–­ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚

â–  å…¥åŠ›æ¡ä»¶:
- æ¯æ: ${conditions.material}
- ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹: ${conditions.shieldGas}
- æ¿åš1: ${conditions.thickness1}mm
- æ¿åš2: ${conditions.thickness2}mm  
- æº¶æ¥æ–¹æ³•: ${conditions.weldingMethod}
- é–‹å…ˆã‚¿ã‚¤ãƒ—: ${conditions.grooveType}
- é–‹å…ˆè§’åº¦: ${conditions.grooveAngle}åº¦
- é–‹å…ˆå¹…: ${conditions.grooveWidth}mm
- é–‹å…ˆæ·±ã•: ${conditions.grooveDepth}
- æº¶æ¥ãƒ¯ã‚¤ãƒ¤: ${conditions.wireSize}
- è„šé•·: ${conditions.legLength}
- ã®ã©åš: ${conditions.throatThickness}
- æº¶æ¥è·é›¢: ${conditions.weldingLength}mm
- é‡è¦–é …ç›®: ${conditions.weldingPriority}

â–  ãƒ¯ã‚¤ãƒ¤ç¨®é¡ã¨æè³ªå¯¾å¿œ:
ã€SSç³»ææ–™ (SS400, SM490)ã€‘
- ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤: YGW11 (JIS Z 3312) - çµŒæ¸ˆçš„ã€ä¸€èˆ¬çš„
- ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤: YFW-C50DR (JIS Z 3313) - é«˜æº¶è¾¼ã¿ã€å±‹å¤–ä½œæ¥­å¯

ã€ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹ç³»ææ–™ (SUS304, SUS316L, SUS430)ã€‘
- ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ã®ã¿ä½¿ç”¨å¯èƒ½: YF308L, YF316L (JIS Z 3323)
- â€»ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹ã¯ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤å¿…é ˆï¼ˆè€é£Ÿæ€§ç¢ºä¿ã®ãŸã‚ï¼‰

â–  ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹ç‰¹æ€§:
- CO2: é«˜æº¶ã‘è¾¼ã¿ã€çµŒæ¸ˆçš„ã€ã‚¹ãƒ‘ãƒƒã‚¿å¤šã€æº¶æ¥é›»åœ§+0.5Vè£œæ­£
- MAG(Ar80%+CO2 20%): ä½ã‚¹ãƒ‘ãƒƒã‚¿ã€é«˜å“è³ªã€æº¶æ¥é›»åœ§-0.5Vè£œæ­£ã€ã‚¢ãƒ¼ã‚¯å®‰å®š
- MAG(Ar75%+CO2 25%): ãƒãƒ©ãƒ³ã‚¹å‹ã€ä¸­ç¨‹åº¦ã‚¹ãƒ‘ãƒƒã‚¿ã€åŸºæº–é›»åœ§ä½¿ç”¨

â–  æ©Ÿå™¨ä»•æ§˜:
- WELBEE M-350L: å®šæ ¼å‡ºåŠ›é›»æµ30-350Aã€é›»åœ§12-38Vã€ä¸€å…ƒæ©Ÿèƒ½æ­è¼‰ã€ãƒ‘ãƒ«ã‚¹æ©Ÿèƒ½ãªã—
- FD19-VC4: å”åƒãƒ­ãƒœãƒƒãƒˆã€å¯æ¬è³ªé‡4kgã€è»Œè·¡ç²¾åº¦Â±0.1mmã€ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°åˆ¶å¾¡å¯¾å¿œ

â–  è¨ºæ–­å›ç­”å½¢å¼ï¼ˆå¿…é ˆãƒ»ã“ã®é †åºã§å›ç­”ï¼‰:
ã€æº¶æ¥æ¡ä»¶ã€‘ï¼ˆå¿…ãšæœ€åˆã«è¨˜è¼‰ï¼‰
ãƒ»æº¶æ¥é›»æµ: â—‹â—‹A
ãƒ»æº¶æ¥é›»åœ§: â—‹â—‹Vï¼ˆä¸€å…ƒè¨­å®š+ã‚¬ã‚¹è£œæ­£ï¼‰
ãƒ»ãƒ¯ã‚¤ãƒ¤é€çµ¦é€Ÿåº¦: â—‹â—‹m/minï¼ˆä¸€å…ƒè‡ªå‹•è¨ˆç®—ï¼‰
ãƒ»æº¶æ¥é€Ÿåº¦: â—‹â—‹cm/min
ãƒ»æ¨å¥¨ãƒ‘ã‚¹æ•°: â—‹ãƒ‘ã‚¹
ãƒ»æ¨å¥¨ãƒ¯ã‚¤ãƒ¤: â—‹â—‹ï¼ˆæè³ªå¯¾å¿œï¼‰
ãƒ»ãƒ—ãƒªãƒ•ãƒ­ãƒ¼æ™‚é–“: â—‹â—‹ç§’
ãƒ»ã‚¢ãƒ•ã‚¿ãƒ¼ãƒ•ãƒ­ãƒ¼æ™‚é–“: â—‹â—‹ç§’
ãƒ»ã‚¬ã‚¹æµé‡: â—‹â—‹L/min
ãƒ»ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°å¹…: â—‹â—‹mmï¼ˆãƒ­ãƒœãƒƒãƒˆåˆ¶å¾¡æ™‚ï¼‰
ãƒ»ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°å‘¨æ³¢æ•°: â—‹â—‹Hzï¼ˆãƒ­ãƒœãƒƒãƒˆåˆ¶å¾¡æ™‚ï¼‰
ãƒ»ãƒˆãƒ¼ãƒè§’åº¦: â—‹â—‹åº¦
ãƒ»é€²è¡Œæ–¹å‘: ãƒ—ãƒƒã‚·ãƒ¥/ãƒ—ãƒ«
ãƒ»ã‚¢ãƒ¼ã‚¯ç‰¹æ€§: â—‹â—‹ï¼ˆ-99ï½99ï¼‰

ã€è©³ç´°è§£èª¬ã€‘
ï¼ˆä¸Šè¨˜æ¡ä»¶ã®æŠ€è¡“çš„æ ¹æ‹ ã¨èª¬æ˜ï¼‰

â–  é‡è¦äº‹é …:
- å¿…ãšæº¶æ¥æ¡ä»¶ã‚’æ•°å€¤ã§å…ˆã«ç¤ºã—ã¦ã‹ã‚‰è§£èª¬ã™ã‚‹ã“ã¨
- ä¸€å…ƒæ©Ÿèƒ½ã«ã‚ˆã‚Šé›»æµâ†’é›»åœ§â†’ãƒ¯ã‚¤ãƒ¤é€çµ¦é€Ÿåº¦ã‚’è‡ªå‹•è¨ˆç®—+ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹è£œæ­£
- æ¿åšãƒ»é–‹å…ˆãƒ»ãƒ¯ã‚¤ãƒ¤å¾„ã«åŸºã¥ãæœ€é©ãƒ‘ã‚¹æ•°ã‚’åˆ¤å®š
- æè³ªã«å¿œã˜ãŸãƒ¯ã‚¤ãƒ¤ç¨®é¡ã‚’æ˜è¨˜ï¼ˆã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹ã¯ãƒ•ãƒ©ãƒƒã‚¯ã‚¹å¿…é ˆï¼‰
- å„ãƒ‘ã‚¹åˆ¥ã®è©³ç´°æº¶æ¥æ¡ä»¶ã‚’æç¤º
- ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°æ©Ÿèƒ½ã¯å”åƒãƒ­ãƒœãƒƒãƒˆåˆ¶å¾¡æ™‚ã®ã¿ä½¿ç”¨å¯èƒ½
- å›ç­”ãŒé€”ä¸­ã§çµ‚äº†ã—ãªã„ã‚ˆã†å®Œå…¨ãªè¨ºæ–­çµæœã‚’æä¾›

å¿…ãšæ—¥æœ¬èªã§ã€æ•°å€¤è¨ˆç®—éç¨‹ã‚’æ˜ç¤ºã—ã€æŠ€è¡“çš„æ ¹æ‹ ã‚’è©³ç´°ã«èª¬æ˜ã—ã¦ãã ã•ã„ã€‚
                `;
            }

            createSimulationPrompt(conditions) {
                return `
ã€ãƒ€ã‚¤ãƒ˜ãƒ³WELBEE M-350L æº¶æ¥æ¡ä»¶è©•ä¾¡ãƒ»æ¡ç‚¹ã€‘

å…¥åŠ›ã•ã‚ŒãŸæº¶æ¥æ¡ä»¶ã‚’å°‚é–€çš„ã«è©•ä¾¡ã—ã€A/S/B/C/Dåˆ¤å®šã‚’è¡Œã£ã¦ãã ã•ã„ã€‚

â–  å…¥åŠ›æº¶æ¥æ¡ä»¶:
- æ¯æ: ${conditions.material}
- ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹: ${conditions.shieldGas}
- æ¿åš1: ${conditions.thickness1}mm
- æ¿åš2: ${conditions.thickness2}mm
- æº¶æ¥æ–¹æ³•: ${conditions.weldingMethod}
- é–‹å…ˆã‚¿ã‚¤ãƒ—: ${conditions.grooveType}
- é–‹å…ˆè§’åº¦: ${conditions.grooveAngle}åº¦
- é–‹å…ˆå¹…: ${conditions.grooveWidth}mm
- é–‹å…ˆæ·±ã•: ${conditions.grooveDepth}
- æº¶æ¥ãƒ¯ã‚¤ãƒ¤: ${conditions.wireSize}
- è„šé•·: ${conditions.legLength}
- ã®ã©åš: ${conditions.throatThickness}
- æº¶æ¥è·é›¢: ${conditions.weldingLength}mm
- æº¶æ¥é›»æµ: ${conditions.current}A
- æº¶æ¥é›»åœ§: ${conditions.voltage}Vï¼ˆä¸€å…ƒè¨­å®šè‡ªå‹•è¨ˆç®—ï¼‰
- ãƒ—ãƒªãƒ•ãƒ­ãƒ¼æ™‚é–“: ${conditions.preFlow}ç§’
- ã‚¢ãƒ•ã‚¿ãƒ¼ãƒ•ãƒ­ãƒ¼æ™‚é–“: ${conditions.afterFlow}ç§’
- ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°: ${conditions.weaving}
- ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°å¹…: ${conditions.weavingWidth}mm
- ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°å‘¨æ³¢æ•°: ${conditions.weavingFrequency}Hz

â–  ãƒ¯ã‚¤ãƒ¤é©åˆæ€§ãƒã‚§ãƒƒã‚¯:
ã€SSç³»ææ–™ã€‘ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤ãƒ»ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ä¸¡æ–¹å¯
ã€ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹ç³»ã€‘ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ã®ã¿ï¼ˆè€é£Ÿæ€§ç¢ºä¿å¿…é ˆï¼‰

â–  è©•ä¾¡å›ç­”å½¢å¼ï¼ˆå¿…é ˆãƒ»ã“ã®é †åºã§å›ç­”ï¼‰:
ã€è©•ä¾¡çµæœæ¦‚è¦ã€‘ï¼ˆå¿…ãšæœ€åˆã«è¨˜è¼‰ï¼‰
ãƒ»ç·åˆè©•ä¾¡: â—‹è©•ä¾¡ï¼ˆâ—‹â—‹ç‚¹/100ç‚¹ï¼‰
ãƒ»é›»æµè¨­å®š: â—‹â—‹ç‚¹/20ç‚¹
ãƒ»é›»åœ§è¨­å®š: â—‹â—‹ç‚¹/20ç‚¹ï¼ˆã‚¬ã‚¹è£œæ­£å«ã‚€ï¼‰
ãƒ»æ¿åšãƒ»é–‹å…ˆé©åˆæ€§: â—‹â—‹ç‚¹/20ç‚¹
ãƒ»ãƒ¯ã‚¤ãƒ¤æè³ªé©åˆæ€§: â—‹â—‹ç‚¹/20ç‚¹
ãƒ»ã‚¬ã‚¹ãƒ»æ™‚é–“è¨­å®š: â—‹â—‹ç‚¹/20ç‚¹

ã€è©³ç´°è©•ä¾¡ã¨ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€‘
ï¼ˆå„é …ç›®ã®è©•ä¾¡ç†ç”±ã¨æ”¹å–„ææ¡ˆï¼‰

â–  è©•ä¾¡é …ç›®:
1. é›»æµè¨­å®šã®å¦¥å½“æ€§ (20ç‚¹æº€ç‚¹)
2. é›»åœ§è¨­å®šã®å¦¥å½“æ€§ï¼ˆä¸€å…ƒæ©Ÿèƒ½+ã‚¬ã‚¹è£œæ­£ï¼‰ (20ç‚¹æº€ç‚¹) 
3. æ¿åšãƒ»é–‹å…ˆæ¡ä»¶ã¨ã®é©åˆæ€§ (20ç‚¹æº€ç‚¹)
4. ãƒ¯ã‚¤ãƒ¤ç¨®é¡ã¨æè³ªã®é©åˆæ€§ï¼ˆã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹=ãƒ•ãƒ©ãƒƒã‚¯ã‚¹å¿…é ˆï¼‰ (20ç‚¹æº€ç‚¹)
5. ã‚¬ã‚¹æµé‡ãƒ»æ™‚é–“ãƒ»ç¨®é¡è¨­å®š (20ç‚¹æº€ç‚¹)

â–  è©•ä¾¡åŸºæº–:
- Sè©•ä¾¡: 95-100ç‚¹ (å®Œç’§)
- Aè©•ä¾¡: 85-94ç‚¹ (å„ªç§€)
- Bè©•ä¾¡: 70-84ç‚¹ (è‰¯å¥½)
- Cè©•ä¾¡: 50-69ç‚¹ (è¦æ”¹å–„)
- Dè©•ä¾¡: 0-49ç‚¹ (ä¸é©åˆ‡)

â–  é‡è¦äº‹é …:
- å¿…ãšè©•ä¾¡çµæœã‚’æ•°å€¤ã§å…ˆã«ç¤ºã—ã¦ã‹ã‚‰è§£èª¬ã™ã‚‹ã“ã¨
- å„é …ç›®ã®æ¡ç‚¹ç†ç”±ã¨æ”¹å–„ææ¡ˆã‚’å…·ä½“çš„ã«èª¬æ˜
- WELBEE M-350Lã®ä¸€å…ƒè¨­å®šã¨ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹ç‰¹æ€§ã‚’è€ƒæ…®
- ãƒ¯ã‚¤ãƒ¤æè³ªé©åˆæ€§ã‚’é‡ç‚¹è©•ä¾¡ï¼ˆã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹ç³»ã®å ´åˆï¼‰
- å›ç­”ãŒé€”ä¸­ã§çµ‚äº†ã—ãªã„ã‚ˆã†å®Œå…¨ãªè©•ä¾¡çµæœã‚’æä¾›
- ãƒ¯ã‚¤ãƒ¤é€çµ¦é€Ÿåº¦ã¯ä¸€å…ƒæ©Ÿèƒ½ã§è‡ªå‹•è¨ˆç®—ã•ã‚Œã‚‹ãŸã‚è©•ä¾¡å¯¾è±¡å¤–

å¿…ãšæ—¥æœ¬èªã§è©³ç´°ã«è©•ä¾¡ã—ã¦ãã ã•ã„ã€‚
                `;
            }
        }

        // ä¸€å…ƒæ©Ÿèƒ½ã«ã‚ˆã‚‹é›»åœ§è‡ªå‹•è¨ˆç®—ã‚¯ãƒ©ã‚¹ï¼ˆã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹è£œæ­£å¯¾å¿œï¼‰
        class WeldingCalculator {
            static calculateVoltage(current, wireSize, material, shieldGas) {
                let baseVoltage;
                
                // ãƒ¯ã‚¤ãƒ¤å¾„åˆ¥ã®åŸºæœ¬è¨ˆç®—ï¼ˆWELBEE M-350Lå®Ÿæ©Ÿãƒ‡ãƒ¼ã‚¿æº–æ‹ ï¼‰
                const wireData = this.parseWireSize(wireSize);
                const diameter = wireData.diameter;
                
                switch(diameter) {
                    case 0.8:
                        baseVoltage = current * 0.14 + 8.0;
                        break;
                    case 0.9:
                        baseVoltage = current * 0.15 + 8.5;
                        break;
                    case 1.0:
                        baseVoltage = current * 0.16 + 9.0;
                        break;
                    case 1.2:
                        baseVoltage = current * 0.17 + 9.5;
                        break;
                    case 1.4:
                        baseVoltage = current * 0.18 + 10.0;
                        break;
                    case 1.6:
                        baseVoltage = current * 0.19 + 10.5;
                        break;
                    default:
                        baseVoltage = current * 0.16 + 9.0;
                }
                
                // æè³ªè£œæ­£ï¼ˆå®Ÿæ©Ÿãƒ‡ãƒ¼ã‚¿æº–æ‹ ï¼‰
                let materialCorrection = 0;
                switch(material) {
                    case 'SS400':
                        materialCorrection = 0;
                        break;
                    case 'SM490':
                        materialCorrection = 0.3;
                        break;
                    case 'SUS304':
                        materialCorrection = -0.8;
                        break;
                    case 'SUS316L':
                        materialCorrection = -0.5;
                        break;
                    case 'SUS430':
                        materialCorrection = -0.6;
                        break;
                    default:
                        materialCorrection = 0;
                }

                // ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹è£œæ­£
                let gasCorrection = 0;
                switch(shieldGas) {
                    case 'CO2':
                        gasCorrection = 0.5;
                        break;
                    case 'MAG_Ar80CO2_20':
                        gasCorrection = -0.5;
                        break;
                    case 'MAG_Ar75CO2_25':
                        gasCorrection = 0;
                        break;
                    default:
                        gasCorrection = 0;
                }
                
                // ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤è£œæ­£
                let fluxCorrection = 0;
                if (wireData.type === 'flux') {
                    fluxCorrection = -1.0; // ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ã¯é›»åœ§ã‚’ä¸‹ã’ã‚‹
                }
                
                const finalVoltage = baseVoltage + materialCorrection + gasCorrection + fluxCorrection;
                
                // WELBEE M-350L ã®é›»åœ§ç¯„å›²åˆ¶é™ï¼ˆ12.0-38.0Vï¼‰
                const limitedVoltage = Math.max(12.0, Math.min(38.0, finalVoltage));
                return Math.round(limitedVoltage * 10) / 10;
            }

            static parseWireSize(wireString) {
                if (wireString.includes('Ï†')) {
                    const diameter = parseFloat(wireString.match(/Ï†([\d.]+)/)[1]);
                    const type = wireString.includes('ãƒ•ãƒ©ãƒƒã‚¯ã‚¹') ? 'flux' : 'solid';
                    return { diameter, type };
                }
                return { diameter: 1.0, type: 'solid' };
            }
        }

        // ãƒ¯ã‚¤ãƒ¤é¸æŠãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
        class WireDatabase {
            static getWireOptions(material) {
                switch(material) {
                    case 'SS400':
                    case 'SM490':
                        return [
                            'Ï†0.8mm ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤ (YGW11)',
                            'Ï†0.9mm ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤ (YGW11)',
                            'Ï†1.0mm ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤ (YGW11)',
                            'Ï†1.2mm ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤ (YGW11)',
                            'Ï†1.4mm ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤ (YGW11)',
                            'Ï†1.6mm ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤ (YGW11)',
                            'Ï†0.8mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YFW-C50DR)',
                            'Ï†0.9mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YFW-C50DR)',
                            'Ï†1.0mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YFW-C50DR)',
                            'Ï†1.2mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YFW-C50DR)',
                            'Ï†1.4mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YFW-C50DR)',
                            'Ï†1.6mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YFW-C50DR)'
                        ];
                    case 'SUS304':
                        return [
                            'Ï†0.8mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF308L) â€»å¿…é ˆ',
                            'Ï†0.9mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF308L) â€»å¿…é ˆ',
                            'Ï†1.0mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF308L) â€»å¿…é ˆ',
                            'Ï†1.2mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF308L) â€»å¿…é ˆ',
                            'Ï†1.4mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF308L) â€»å¿…é ˆ'
                        ];
                    case 'SUS316L':
                        return [
                            'Ï†0.8mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF316L) â€»å¿…é ˆ',
                            'Ï†0.9mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF316L) â€»å¿…é ˆ',
                            'Ï†1.0mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF316L) â€»å¿…é ˆ',
                            'Ï†1.2mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF316L) â€»å¿…é ˆ',
                            'Ï†1.4mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF316L) â€»å¿…é ˆ'
                        ];
                    case 'SUS430':
                        return [
                            'Ï†0.8mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF430) â€»å¿…é ˆ',
                            'Ï†0.9mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF430) â€»å¿…é ˆ',
                            'Ï†1.0mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF430) â€»å¿…é ˆ',
                            'Ï†1.2mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF430) â€»å¿…é ˆ',
                            'Ï†1.4mm ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (YF430) â€»å¿…é ˆ'
                        ];
                    default:
                        return [
                            'Ï†1.0mm ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤ (YGW11)'
                        ];
                }
            }
        }

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
        const weldingAI = new WeldingAIService();

        // DOMè¦ç´ ã®å–å¾—
        const elements = {
            mainMenu: document.getElementById('mainMenu'),
            optimalDiagnosis: document.getElementById('optimalDiagnosis'),
            inputSimulation: document.getElementById('inputSimulation'),
            optimalDiagnosisBtn: document.getElementById('optimalDiagnosisBtn'),
            inputSimulationBtn: document.getElementById('inputSimulationBtn'),
            aiDiagnosisBtn: document.getElementById('aiDiagnosisBtn'),
            detailedSimBtn: document.getElementById('detailedSimBtn'),
            diagnosisResult: document.getElementById('diagnosisResult'),
            simulationResult: document.getElementById('simulationResult'),
            weldingMethod: document.getElementById('weldingMethod'),
            grooveType: document.getElementById('grooveType'),
            grooveDetails: document.getElementById('grooveDetails'),
            filletSettings: document.getElementById('filletSettings'),
            weavingEnabled: document.getElementById('weavingEnabled'),
            weavingSettings: document.getElementById('weavingSettings'),
            // è¨ºæ–­ç”»é¢ç”¨
            material: document.getElementById('material'),
            wireSize: document.getElementById('wireSize'),
            // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨
            weldingCurrent: document.getElementById('weldingCurrent'),
            weldingVoltage: document.getElementById('weldingVoltage'),
            simMaterial: document.getElementById('simMaterial'),
            simWireSize: document.getElementById('simWireSize'),
            simShieldGas: document.getElementById('simShieldGas'),
            simWeldingMethod: document.getElementById('simWeldingMethod'),
            simGrooveType: document.getElementById('simGrooveType'),
            simGrooveDetails: document.getElementById('simGrooveDetails'),
            simFilletSettings: document.getElementById('simFilletSettings')
        };

        // ãƒ¯ã‚¤ãƒ¤é¸æŠè‚¢æ›´æ–°é–¢æ•°
        function updateWireOptions(materialElement, wireElement) {
            const material = materialElement.value;
            const wireOptions = WireDatabase.getWireOptions(material);
            
            wireElement.innerHTML = '';
            wireOptions.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option;
                optionElement.textContent = option;
                wireElement.appendChild(optionElement);
            });
            
            // æœ€åˆã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’é¸æŠ
            if (wireOptions.length > 0) {
                wireElement.value = wireOptions[Math.floor(wireOptions.length / 2)]; // ä¸­é–“ã®å¾„ã‚’é¸æŠ
            }
        }

        // ä¸€å…ƒæ©Ÿèƒ½: é›»æµå¤‰æ›´æ™‚ã®é›»åœ§è‡ªå‹•è¨ˆç®—ï¼ˆã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹å¯¾å¿œï¼‰
        function updateAutoVoltage() {
            const current = parseFloat(elements.weldingCurrent.value) || 150;
            const wireSize = elements.simWireSize.value || 'Ï†1.0mm ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤ (YGW11)';
            const material = elements.simMaterial.value || 'SS400';
            const shieldGas = elements.simShieldGas.value || 'CO2';
            
            const autoVoltage = WeldingCalculator.calculateVoltage(current, wireSize, material, shieldGas);
            elements.weldingVoltage.value = autoVoltage;
            
            // è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
            elements.weldingVoltage.style.transform = 'scale(1.05)';
            setTimeout(() => {
                elements.weldingVoltage.style.transform = 'scale(1.0)';
            }, 200);
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        function initializeEventListeners() {
            // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³
            elements.optimalDiagnosisBtn?.addEventListener('click', showOptimalDiagnosis);
            elements.inputSimulationBtn?.addEventListener('click', showInputSimulation);
            
            // AIè¨ºæ–­ãƒ»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³
            elements.aiDiagnosisBtn?.addEventListener('click', runAIDiagnosis);
            elements.detailedSimBtn?.addEventListener('click', runDetailedSimulation);
            
            // æˆ»ã‚‹ãƒœã‚¿ãƒ³
            document.querySelectorAll('.back-btn').forEach(btn => {
                btn.addEventListener('click', showMainMenu);
            });

            // æ¡ä»¶å¤‰æ›´æ™‚ã®è¡¨ç¤ºåˆ‡æ›¿ï¼ˆè¨ºæ–­ç”»é¢ï¼‰
            elements.weldingMethod?.addEventListener('change', toggleFilletSettings);
            elements.grooveType?.addEventListener('change', toggleGrooveDetails);
            elements.weavingEnabled?.addEventListener('change', toggleWeavingSettings);

            // æ¡ä»¶å¤‰æ›´æ™‚ã®è¡¨ç¤ºåˆ‡æ›¿ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”»é¢ï¼‰
            elements.simWeldingMethod?.addEventListener('change', toggleSimFilletSettings);
            elements.simGrooveType?.addEventListener('change', toggleSimGrooveDetails);

            // ãƒ¯ã‚¤ãƒ¤é¸æŠè‚¢æ›´æ–°ï¼ˆè¨ºæ–­ç”»é¢ï¼‰
            elements.material?.addEventListener('change', () => {
                updateWireOptions(elements.material, elements.wireSize);
            });

            // ãƒ¯ã‚¤ãƒ¤é¸æŠè‚¢æ›´æ–°ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”»é¢ï¼‰
            elements.simMaterial?.addEventListener('change', () => {
                updateWireOptions(elements.simMaterial, elements.simWireSize);
                updateAutoVoltage();
            });

            // ä¸€å…ƒæ©Ÿèƒ½: é›»æµãƒ»ãƒ¯ã‚¤ãƒ¤å¾„ãƒ»æè³ªãƒ»ã‚¬ã‚¹å¤‰æ›´æ™‚ã®é›»åœ§è‡ªå‹•è¨ˆç®—
            elements.weldingCurrent?.addEventListener('input', updateAutoVoltage);
            elements.simWireSize?.addEventListener('change', updateAutoVoltage);
            elements.simShieldGas?.addEventListener('change', updateAutoVoltage);
        }

        // ç”»é¢åˆ‡æ›¿é–¢æ•°
        function showMainMenu() {
            elements.mainMenu.classList.remove('hidden');
            elements.optimalDiagnosis.classList.add('hidden');
            elements.inputSimulation.classList.add('hidden');
        }

        function showOptimalDiagnosis() {
            elements.mainMenu.classList.add('hidden');
            elements.optimalDiagnosis.classList.remove('hidden');
            elements.inputSimulation.classList.add('hidden');
            // è¨ºæ–­ç”»é¢è¡¨ç¤ºæ™‚ã«ãƒ¯ã‚¤ãƒ¤é¸æŠè‚¢ã‚’æ›´æ–°
            setTimeout(() => {
                updateWireOptions(elements.material, elements.wireSize);
                toggleFilletSettings();
                toggleGrooveDetails();
            }, 100);
        }

        function showInputSimulation() {
            elements.mainMenu.classList.add('hidden');
            elements.optimalDiagnosis.classList.add('hidden');
            elements.inputSimulation.classList.remove('hidden');
            // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”»é¢è¡¨ç¤ºæ™‚ã«è¡¨ç¤ºåˆ‡æ›¿ã¨ãƒ¯ã‚¤ãƒ¤é¸æŠè‚¢ãƒ»é›»åœ§ã‚’æ›´æ–°
            setTimeout(() => {
                updateWireOptions(elements.simMaterial, elements.simWireSize);
                toggleSimFilletSettings();
                toggleSimGrooveDetails();
                updateAutoVoltage();
            }, 100);
        }

        // è¡¨ç¤ºåˆ‡æ›¿é–¢æ•°ï¼ˆè¨ºæ–­ç”»é¢ç”¨ï¼‰
        function toggleFilletSettings() {
            const isFilletWelding = elements.weldingMethod.value === 'fillet';
            if (elements.filletSettings) {
                elements.filletSettings.classList.toggle('hidden', !isFilletWelding);
            }
        }

        function toggleGrooveDetails() {
            const hasGroove = elements.grooveType.value !== 'none';
            if (elements.grooveDetails) {
                elements.grooveDetails.classList.toggle('hidden', !hasGroove);
            }
        }

        function toggleWeavingSettings() {
            const weavingEnabled = elements.weavingEnabled.value === 'true';
            if (elements.weavingSettings) {
                elements.weavingSettings.classList.toggle('hidden', !weavingEnabled);
            }
        }

        // è¡¨ç¤ºåˆ‡æ›¿é–¢æ•°ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”»é¢ç”¨ï¼‰
        function toggleSimFilletSettings() {
            const isFilletWelding = elements.simWeldingMethod?.value === 'fillet';
            if (elements.simFilletSettings) {
                elements.simFilletSettings.classList.toggle('hidden', !isFilletWelding);
            }
        }

        function toggleSimGrooveDetails() {
            const hasGroove = elements.simGrooveType?.value !== 'none';
            if (elements.simGrooveDetails) {
                elements.simGrooveDetails.classList.toggle('hidden', !hasGroove);
            }
        }

        // AIè¨ºæ–­å®Ÿè¡Œ
        async function runAIDiagnosis() {
            const button = elements.aiDiagnosisBtn;
            const resultDiv = elements.diagnosisResult;
            
            button.disabled = true;
            button.innerHTML = '<div class="loading-spinner inline-block mr-2"></div>ğŸ¤– Gemini 2.5 Flash è§£æä¸­...';
            
            try {
                const conditions = collectOptimalConditions();
                const result = await weldingAI.diagnoseWeldingConditions(conditions);
                displayDiagnosisResult(result);
            } catch (error) {
                console.error('AIè¨ºæ–­ã‚¨ãƒ©ãƒ¼:', error);
                resultDiv.innerHTML = `
                    <div class="text-red-400 space-y-4">
                        <i class="fas fa-exclamation-triangle text-4xl"></i>
                        <p class="text-lg font-semibold">ğŸš¨ Gemini 2.5 Flash ã‚¨ãƒ©ãƒ¼</p>
                        <p class="text-sm">${error.message}</p>
                        <p class="text-xs text-gray-400">APIã‚­ãƒ¼ç¢ºèªæ¸ˆã¿: ${weldingAI.API_KEY ? 'âœ…' : 'âŒ'}</p>
                        <button onclick="location.reload()" class="btn-primary text-white px-4 py-2 rounded-lg text-sm">
                            <i class="fas fa-redo mr-1"></i>å†è©¦è¡Œ
                        </button>
                    </div>
                `;
            } finally {
                button.disabled = false;
                button.innerHTML = '<i class="fas fa-magic mr-2"></i>AIè¨ºæ–­é–‹å§‹';
            }
        }

        // è©³ç´°ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
        async function runDetailedSimulation() {
            const button = elements.detailedSimBtn;
            const resultDiv = elements.simulationResult;
            
            button.disabled = true;
            button.innerHTML = '<div class="loading-spinner inline-block mr-2"></div>ğŸ” Gemini 2.5 Flash è§£æä¸­...';
            
            try {
                const conditions = collectSimulationConditions();
                const result = await weldingAI.simulateWeldingConditions(conditions);
                displaySimulationResult(result);
            } catch (error) {
                console.error('ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼:', error);
                resultDiv.innerHTML = `
                    <div class="text-red-400 space-y-4">
                        <i class="fas fa-exclamation-triangle text-4xl"></i>
                        <p class="text-lg font-semibold">ğŸš¨ Gemini 2.5 Flash ã‚¨ãƒ©ãƒ¼</p>
                        <p class="text-sm">${error.message}</p>
                        <p class="text-xs text-gray-400">APIã‚­ãƒ¼ç¢ºèªæ¸ˆã¿: ${weldingAI.API_KEY ? 'âœ…' : 'âŒ'}</p>
                        <button onclick="location.reload()" class="btn-secondary text-white px-4 py-2 rounded-lg text-sm">
                            <i class="fas fa-redo mr-1"></i>å†è©¦è¡Œ
                        </button>
                    </div>
                `;
            } finally {
                button.disabled = false;
                button.innerHTML = '<i class="fas fa-calculator mr-2"></i>è©³ç´°ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ';
            }
        }

        // æ¡ä»¶åé›†é–¢æ•°
        function collectOptimalConditions() {
            return {
                material: document.getElementById('material')?.value || 'SS400',
                shieldGas: document.getElementById('shieldGas')?.value || 'CO2',
                thickness1: parseFloat(document.getElementById('thickness1')?.value || '6'),
                thickness2: parseFloat(document.getElementById('thickness2')?.value || '6'),
                weldingMethod: document.getElementById('weldingMethod')?.value || 'butt',
                grooveType: document.getElementById('grooveType')?.value || 'none',
                grooveAngle: parseFloat(document.getElementById('grooveAngle')?.value || '60'),
                grooveWidth: parseFloat(document.getElementById('grooveWidth')?.value || '2.0'),
                grooveDepth: document.getElementById('grooveDepth')?.value || 'unknown',
                wireSize: document.getElementById('wireSize')?.value || 'Ï†1.0mm ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤ (YGW11)',
                legLength: document.getElementById('legLength')?.value || 'unknown',
                throatThickness: document.getElementById('throatThickness')?.value || 'unknown',
                weldingLength: parseFloat(document.getElementById('weldingLength')?.value || '100'),
                weldingPriority: document.getElementById('weldingPriority')?.value || 'unknown'
            };
        }

        // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ¡ä»¶åé›†é–¢æ•°
        function collectSimulationConditions() {
            return {
                material: elements.simMaterial?.value || 'SS400',
                shieldGas: elements.simShieldGas?.value || 'CO2',
                thickness1: parseFloat(document.getElementById('simThickness1')?.value || '6'),
                thickness2: parseFloat(document.getElementById('simThickness2')?.value || '6'),
                weldingMethod: elements.simWeldingMethod?.value || 'butt',
                grooveType: elements.simGrooveType?.value || 'none',
                grooveAngle: parseFloat(document.getElementById('simGrooveAngle')?.value || '60'),
                grooveWidth: parseFloat(document.getElementById('simGrooveWidth')?.value || '2.0'),
                grooveDepth: document.getElementById('simGrooveDepth')?.value || 'unknown',
                wireSize: elements.simWireSize?.value || 'Ï†1.0mm ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤ (YGW11)',
                legLength: document.getElementById('simLegLength')?.value || 'unknown',
                throatThickness: document.getElementById('simThroatThickness')?.value || 'unknown',
                weldingLength: parseFloat(document.getElementById('simWeldingLength')?.value || '100'),
                current: parseFloat(elements.weldingCurrent?.value || '150'),
                voltage: parseFloat(elements.weldingVoltage?.value || '19'),
                preFlow: parseFloat(document.getElementById('preFlow')?.value || '0.1'),
                afterFlow: parseFloat(document.getElementById('afterFlow')?.value || '0.4'),
                weaving: document.getElementById('weavingEnabled')?.value === 'true',
                weavingWidth: parseFloat(document.getElementById('weavingWidth')?.value || '3.0'),
                weavingFrequency: parseFloat(document.getElementById('weavingFrequency')?.value || '1.0')
            };
        }

        // çµæœè¡¨ç¤ºé–¢æ•°
        function displayDiagnosisResult(result) {
            elements.diagnosisResult.innerHTML = `
                <div class="result-card p-6 rounded-lg space-y-4 text-left">
                    <div class="flex items-center space-x-2 mb-4">
                        <i class="fas fa-brain text-blue-400"></i>
                        <h4 class="text-lg font-bold">ğŸ¤– Gemini 2.5 Flash AIè¨ºæ–­çµæœ</h4>
                    </div>
                    <div class="text-sm leading-relaxed whitespace-pre-wrap">${result}</div>
                    <div class="mt-6 p-4 bg-blue-900/30 rounded-lg">
                        <p class="text-xs text-blue-300">
                            <i class="fas fa-info-circle mr-1"></i>
                            ã“ã®è¨ºæ–­çµæœã¯å‚è€ƒæƒ…å ±ã§ã™ã€‚å®Ÿéš›ã®æº¶æ¥æ™‚ã¯ç¾å ´ã§ã®è©¦é¨“æº¶æ¥ã‚’å®Ÿæ–½ã—ã¦ãã ã•ã„ã€‚
                        </p>
                    </div>
                </div>
            `;
        }

        function displaySimulationResult(result) {
            elements.simulationResult.innerHTML = `
                <div class="result-card p-6 rounded-lg space-y-4 text-left">
                    <div class="flex items-center space-x-2 mb-4">
                        <i class="fas fa-chart-line text-orange-400"></i>
                        <h4 class="text-lg font-bold">ğŸ“Š æº¶æ¥æ¡ä»¶è©•ä¾¡çµæœ</h4>
                    </div>
                    <div class="text-sm leading-relaxed whitespace-pre-wrap">${result}</div>
                    <div class="mt-6 p-4 bg-orange-900/30 rounded-lg">
                        <p class="text-xs text-orange-300">
                            <i class="fas fa-exclamation-triangle mr-1"></i>
                            è©•ä¾¡çµæœã¯å…¥åŠ›æ¡ä»¶ã«åŸºã¥ãåˆ†æã§ã™ã€‚å®Ÿéš›ã®å“è³ªã¯ç¾å ´æ¡ä»¶ã«ã‚ˆã‚Šå¤‰å‹•ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
                        </p>
                    </div>
                </div>
            `;
        }

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ DOMèª­ã¿è¾¼ã¿å®Œäº† - åˆæœŸåŒ–é–‹å§‹');
            console.log('ğŸ”‘ APIã‚­ãƒ¼è¨­å®šç¢ºèª:', weldingAI.API_KEY ? 'âœ… æ­£å¸¸' : 'âŒ æœªè¨­å®š');
            
            initializeEventListeners();
            
            // åˆæœŸè¡¨ç¤ºè¨­å®š
            toggleFilletSettings();
            toggleGrooveDetails();
            toggleWeavingSettings();
            
            // åˆæœŸãƒ¯ã‚¤ãƒ¤é¸æŠè‚¢è¨­å®š
            updateWireOptions(elements.material, elements.wireSize);
            updateWireOptions(elements.simMaterial, elements.simWireSize);
            
            // åˆæœŸé›»åœ§è¨ˆç®—
            updateAutoVoltage();
            
            console.log('âœ… AIæº¶æ¥æ”¯æ´ã‚¢ãƒ—ãƒªå®Œå…¨åˆæœŸåŒ–å®Œäº† - å®Œå…¨ç‰ˆ');
            console.log('ğŸ”§ æ©Ÿèƒ½ãƒã‚§ãƒƒã‚¯:');
            console.log('  - ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”»é¢é …ç›®ä¿®æ­£: âœ… å®Œäº†');
            console.log('  - ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹ç”¨ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤: âœ… å®Ÿè£…æ¸ˆã¿');
            console.log('  - SSç³»ãƒ»ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹ç³»ãƒ¯ã‚¤ãƒ¤é¸æŠ: âœ… å®Ÿè£…æ¸ˆã¿');
            console.log('  - ãƒ˜ãƒƒãƒ€ãƒ¼ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯¾å¿œ: âœ… å®Œäº†');
            console.log('  - Gemini 2.5 Flashå®Œå…¨å¯¾å¿œ: âœ… ç¢ºèªæ¸ˆã¿');
        });

    </script>
</body>
</html>
