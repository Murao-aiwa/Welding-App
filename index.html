<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæº¶æ¥æ”¯æ´ã‚¢ãƒ—ãƒª - æ ªå¼ä¼šç¤¾ã‚¢ã‚¤ãƒ¯ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script type="importmap">
    {
      "imports": {
        "@google/generative-ai": "https://esm.run/@google/generative-ai"
      }
    }
    </script>
    <style>
        :root {
            --primary-color: #1e3a8a;
            --secondary-color: #ea580c;
            --accent-color: #06b6d4;
            --bg-dark: #0f172a;
            --surface-dark: #1e293b;
            --text-light: #f8fafc;
        }

        body {
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a2332 100%);
            color: var(--text-light);
            min-height: 100vh;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .glass-card {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .gradient-border {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color), var(--accent-color));
            padding: 2px;
            border-radius: 12px;
        }

        .gradient-border-content {
            background: var(--surface-dark);
            border-radius: 10px;
            height: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(30, 58, 138, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(30, 58, 138, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary-color) 0%, #dc2626 100%);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(234, 88, 12, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(234, 88, 12, 0.4);
        }

        .header-logo {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .ai-status {
            background: linear-gradient(90deg, #10b981, #06b6d4);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: pulse 2s ease-in-out infinite alternate;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            100% { opacity: 0.7; }
        }

        .sparks {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }

        .spark {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--secondary-color);
            border-radius: 50%;
            animation: sparkle 2s linear infinite;
        }

        @keyframes sparkle {
            0% { 
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% { 
                transform: translateY(-100px) scale(0);
                opacity: 0;
            }
        }

        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid var(--accent-color);
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8) 0%, rgba(15, 23, 42, 0.9) 100%);
            border: 1px solid rgba(6, 182, 212, 0.3);
            box-shadow: 0 0 20px rgba(6, 182, 212, 0.1);
        }

        .parameter-input {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .parameter-input:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px rgba(6, 182, 212, 0.2);
        }

        .parameter-input.auto-calculated {
            background: rgba(6, 182, 212, 0.2);
            border-color: var(--accent-color);
            color: #06b6d4;
            font-weight: bold;
        }

        select.parameter-input option {
            background: var(--surface-dark);
            color: var(--text-light);
        }

        .process-step {
            position: relative;
            padding-left: 2rem;
        }

        .process-step::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0.5rem;
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 50%;
            background: var(--accent-color);
        }

        .hidden {
            display: none !important;
        }

        .company-logo {
            max-width: 400px;
            height: auto;
            filter: brightness(1.1);
        }

        .auto-voltage-indicator {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(90deg, #10b981, #06b6d4);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-left: 8px;
            animation: pulse 2s ease-in-out infinite alternate;
        }

        .warning-badge {
            background: linear-gradient(90deg, #f59e0b, #d97706);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin-left: 8px;
        }

        .gas-indicator {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(90deg, #8b5cf6, #a855f7);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin-left: 8px;
        }

        .auto-speed-indicator {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(90deg, #ef4444, #dc2626);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin-left: 8px;
        }

        @media (max-width: 768px) {
            .company-logo {
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="glass-card rounded-none border-0 border-b border-gray-600">
        <div class="container mx-auto px-6 py-4">
            <div class="flex flex-col items-center space-y-3">
                <!-- Company Logo -->
                <div class="flex items-center space-x-4">
                    <svg width="400" height="120" viewBox="0 0 400 120" fill="none" xmlns="http://www.w3.org/2000/svg" class="company-logo">
                        <defs>
                            <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#ff6941"/>
                                <stop offset="100%" stop-color="#ea580c"/>
                            </linearGradient>
                            <linearGradient id="grad2" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#10b981"/>
                                <stop offset="100%" stop-color="#06b6d4"/>
                            </linearGradient>
                            <linearGradient id="grad3" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#3357dc"/>
                                <stop offset="100%" stop-color="#1e3a8a"/>
                            </linearGradient>
                        </defs>
                        <rect x="10" y="30" width="35" height="60" rx="17" fill="url(#grad1)"/>
                        <rect x="55" y="30" width="35" height="60" rx="17" fill="url(#grad2)"/>
                        <rect x="100" y="30" width="35" height="60" rx="17" fill="url(#grad3)"/>
                        <text x="150" y="45" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#f8fafc">æ ªå¼ä¼šç¤¾</text>
                        <text x="150" y="68" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#f8fafc">ã‚¢ã‚¤ãƒ¯ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</text>
                        <text x="150" y="85" font-family="Arial, sans-serif" font-size="12" font-style="italic" fill="#d1d5db">AIWA Engineering</text>
                    </svg>
                </div>
                
                <!-- App Title and AI Status -->
                <div class="text-center">
                    <h1 class="text-2xl md:text-3xl font-bold header-logo mb-2">AIæº¶æ¥æ”¯æ´ã‚¢ãƒ—ãƒª</h1>
                    <div class="flex items-center justify-center space-x-2">
                        <i class="fas fa-robot text-lg"></i>
                        <span class="ai-status font-semibold">ğŸ¤– Gemini 2.5 Flash: ç¨¼åƒä¸­</span>
                        <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                    </div>
                </div>

                <!-- Navigation -->
                <nav class="flex flex-wrap justify-center space-x-4 text-sm">
                    <span class="text-gray-300">å¯¾å¿œæ©Ÿå™¨:</span>
                    <span class="text-blue-400">ãƒ€ã‚¤ãƒ˜ãƒ³ WELBEE M-350L</span>
                    <span class="text-gray-400">|</span>
                    <span class="text-blue-400">FD19-VC4 å”åƒãƒ­ãƒœãƒƒãƒˆ (å¯æ¬è³ªé‡4kg)</span>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        <!-- Main Menu -->
        <div id="mainMenu" class="space-y-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold mb-4">æº¶æ¥æ”¯æ´æ©Ÿèƒ½é¸æŠ</h2>
                <p class="text-gray-300 max-w-2xl mx-auto">
                    AIæŠ€è¡“ã‚’æ´»ç”¨ã—ãŸé«˜ç²¾åº¦ãªæº¶æ¥æ¡ä»¶è¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ ã€‚æ•™è‚²ãƒ»ç ”ä¿®ã‹ã‚‰å®Ÿå‹™ã¾ã§å¹…åºƒãå¯¾å¿œã—ã¾ã™ã€‚
                </p>
            </div>

            <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                <!-- æº¶æ¥æœ€é©æ¡ä»¶è¨ºæ–­ -->
                <div class="gradient-border">
                    <div class="gradient-border-content p-8 text-center space-y-6">
                        <div class="sparks">
                            <div class="spark" style="left: 20%; animation-delay: 0s;"></div>
                            <div class="spark" style="left: 50%; animation-delay: 0.5s;"></div>
                            <div class="spark" style="left: 80%; animation-delay: 1s;"></div>
                        </div>
                        <div class="text-6xl text-blue-400 mb-4">
                            <i class="fas fa-brain"></i>
                        </div>
                        <h3 class="text-2xl font-bold">æº¶æ¥æœ€é©æ¡ä»¶è¨ºæ–­</h3>
                        <p class="text-gray-300">
                            ææ–™ãƒ»æ¿åšãƒ»æº¶æ¥æ–¹æ³•ã‚’å…¥åŠ›ã™ã‚‹ã ã‘ã§ã€AIãŒæœ€é©ãªæº¶æ¥æ¡ä»¶ã‚’è‡ªå‹•è¨ºæ–­ã€‚
                            åˆå¿ƒè€…ã‹ã‚‰ä¸Šç´šè€…ã¾ã§å®‰å¿ƒã—ã¦ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚
                        </p>
                        <button id="optimalDiagnosisBtn" class="btn-primary text-white px-8 py-3 rounded-lg font-semibold w-full">
                            <i class="fas fa-magic mr-2"></i>AIè¨ºæ–­ã‚’é–‹å§‹
                        </button>
                    </div>
                </div>

                <!-- æº¶æ¥æ¡ä»¶å…¥åŠ›ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ -->
                <div class="gradient-border">
                    <div class="gradient-border-content p-8 text-center space-y-6">
                        <div class="text-6xl text-orange-400 mb-4">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <h3 class="text-2xl font-bold">æº¶æ¥æ¡ä»¶å…¥åŠ›ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h3>
                        <p class="text-gray-300">
                            è©³ç´°ãªæº¶æ¥æ¡ä»¶ã‚’å…¥åŠ›ã—ã¦å“è³ªäºˆæ¸¬ã¨A/S/B/C/Dè©•ä¾¡ã‚’å®Ÿæ–½ã€‚
                            è¨­å®šæ¡ä»¶ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯ã¨æ”¹å–„ææ¡ˆã‚’è¡Œã„ã¾ã™ã€‚
                        </p>
                        <button id="inputSimulationBtn" class="btn-secondary text-white px-8 py-3 rounded-lg font-semibold w-full">
                            <i class="fas fa-calculator mr-2"></i>è©³ç´°ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                        </button>
                    </div>
                </div>
            </div>

            <!-- å…è²¬äº‹é … -->
            <div class="glass-card p-6 mt-12 max-w-4xl mx-auto">
                <div class="text-center">
                    <h4 class="text-lg font-semibold mb-4 text-yellow-400">
                        <i class="fas fa-exclamation-triangle mr-2"></i>é‡è¦ãªã”æ³¨æ„
                    </h4>
                    <div class="text-sm text-gray-300 space-y-2">
                        <p>
                            æœ¬ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€AIæŠ€è¡“ã‚’æ´»ç”¨ã—ãŸæº¶æ¥æ¡ä»¶ã®å‚è€ƒæƒ…å ±æä¾›ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€
                            æº¶æ¥ä½œæ¥­ã®çµæœã‚„å“è³ªã«ã¤ã„ã¦ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ã”ã–ã„ã¾ã›ã‚“ã€‚
                        </p>
                        <p>
                            å®Ÿéš›ã®æº¶æ¥ä½œæ¥­ã«ãŠã„ã¦ã¯ã€å¿…ãšç¾å ´ã§ã®è©¦é¨“æº¶æ¥ãŠã‚ˆã³å“è³ªç¢ºèªã‚’å®Ÿæ–½ã—ã€
                            é©åˆ‡ãªæŠ€èƒ½ã‚’æœ‰ã™ã‚‹ä½œæ¥­è€…ã«ã‚ˆã‚‹æœ€çµ‚åˆ¤æ–­ã®ã‚‚ã¨ã§ä½œæ¥­ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- æº¶æ¥æœ€é©æ¡ä»¶è¨ºæ–­ç”»é¢ -->
        <div id="optimalDiagnosis" class="hidden space-y-8">
            <div class="flex items-center justify-between">
                <h2 class="text-3xl font-bold">æº¶æ¥æœ€é©æ¡ä»¶è¨ºæ–­</h2>
                <button class="back-btn text-blue-400 hover:text-blue-300">
                    <i class="fas fa-arrow-left mr-2"></i>ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹
                </button>
            </div>

            <div class="grid lg:grid-cols-2 gap-8">
                <!-- å…¥åŠ›ãƒ‘ãƒãƒ« -->
                <div class="glass-card p-6 space-y-6">
                    <h3 class="text-xl font-bold mb-4">æº¶æ¥æ¡ä»¶å…¥åŠ›</h3>
                    
                    <!-- æ¯æé¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æ¯æ</label>
                        <select id="material" class="parameter-input w-full p-3 rounded-lg">
                            <option value="SS400">SS400 (ä¸€èˆ¬æ§‹é€ ç”¨åœ§å»¶é‹¼æ)</option>
                            <option value="SM490">SM490 (æº¶æ¥æ§‹é€ ç”¨åœ§å»¶é‹¼æ)</option>
                            <option value="SUS304">SUS304 (ã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆç³»ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼)</option>
                            <option value="SUS316L">SUS316L (ä½ç‚­ç´ ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼)</option>
                            <option value="SUS430">SUS430 (ãƒ•ã‚§ãƒ©ã‚¤ãƒˆç³»ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼)</option>
                        </select>
                    </div>

                    <!-- ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹é¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹
                            <span class="gas-indicator">
                                ğŸ’¨ ã‚¬ã‚¹ç¨®é¡
                            </span>
                        </label>
                        <select id="shieldGas" class="parameter-input w-full p-3 rounded-lg">
                            <option value="CO2">CO2 (ç‚­é…¸ã‚¬ã‚¹) - é«˜æº¶ã‘è¾¼ã¿ãƒ»çµŒæ¸ˆçš„</option>
                            <option value="MAG_Ar80CO2_20">MAG (Ar80%+CO2 20%) - ä½ã‚¹ãƒ‘ãƒƒã‚¿ãƒ»é«˜å“è³ª</option>
                            <option value="MAG_Ar75CO2_25">MAG (Ar75%+CO2 25%) - ãƒãƒ©ãƒ³ã‚¹å‹</option>
                        </select>
                    </div>

                    <!-- ãƒ¯ã‚¤ãƒ¤ç¨®é¡é¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æº¶æ¥ãƒ¯ã‚¤ãƒ¤ç¨®é¡</label>
                        <select id="wireType" class="parameter-input w-full p-3 rounded-lg">
                            <option value="Solid">ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤ (SSç³»ãƒ»è»Ÿé‹¼ç”¨)</option>
                            <option value="Flux-Cored">ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (SSç³»ãƒ»ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹ç³»å¯¾å¿œ)</option>
                        </select>
                    </div>

                    <!-- æ¿åšè¨­å®š -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">æ¿åš1 (mm)</label>
                            <input type="number" id="thickness1" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0.5" max="25" step="0.1" value="6.0">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">æ¿åš2 (mm)</label>
                            <input type="number" id="thickness2" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0.5" max="25" step="0.1" value="6.0">
                        </div>
                    </div>

                    <!-- æº¶æ¥æ–¹æ³•é¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æº¶æ¥æ–¹æ³•</label>
                        <select id="weldingMethod" class="parameter-input w-full p-3 rounded-lg">
                            <option value="butt">çªãåˆã‚ã›æº¶æ¥</option>
                            <option value="fillet">éš…è‚‰æº¶æ¥</option>
                        </select>
                    </div>

                    <!-- é–‹å…ˆè¨­å®š -->
                    <div id="grooveSection">
                        <label class="block text-sm font-semibold mb-2">é–‹å…ˆã®æœ‰ç„¡</label>
                        <select id="grooveType" class="parameter-input w-full p-3 rounded-lg mb-4">
                            <option value="none">é–‹å…ˆãªã—</option>
                            <option value="v-groove">Vå‹é–‹å…ˆ</option>
                            <option value="x-groove">Xå‹é–‹å…ˆï¼ˆä¸¡é¢ï¼‰</option>
                            <option value="u-groove">Uå‹é–‹å…ˆï¼ˆæ·±æºå‹ï¼‰</option>
                            <option value="bevel">ãƒ™ãƒ™ãƒ«åŠ å·¥</option>
                            <option value="j-groove">Jå‹é–‹å…ˆ</option>
                        </select>

                        <!-- é–‹å…ˆè©³ç´°è¨­å®š -->
                        <div id="grooveDetails" class="hidden space-y-4">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold mb-2">é–‹å…ˆè§’åº¦ (åº¦)</label>
                                    <input type="number" id="grooveAngle" class="parameter-input w-full p-3 rounded-lg" 
                                           min="15" max="80" step="5" value="60">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold mb-2">é–‹å…ˆå¹… (mm)</label>
                                    <input type="number" id="grooveWidth" class="parameter-input w-full p-3 rounded-lg" 
                                           min="0" max="5" step="0.1" value="2.0">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-2">é–‹å…ˆæ·±ã• (mm)</label>
                                <select id="grooveDepth" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">ä¸æ˜</option>
                                    <option value="3.0">3.0mm</option>
                                    <option value="4.5">4.5mm</option>
                                    <option value="6.0">6.0mm</option>
                                    <option value="7.5">7.5mm</option>
                                    <option value="9.0">9.0mm</option>
                                    <option value="12.0">12.0mm</option>
                                    <option value="15.0">15.0mm</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- ãƒ¯ã‚¤ãƒ¤å¾„é¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æº¶æ¥ãƒ¯ã‚¤ãƒ¤å¾„</label>
                        <select id="wireSize" class="parameter-input w-full p-3 rounded-lg">
                            <option value="0.8">Ï†0.8mm (è–„æ¿ç”¨)</option>
                            <option value="0.9">Ï†0.9mm (ç²¾å¯†æº¶æ¥ç”¨)</option>
                            <option value="1.0" selected>Ï†1.0mm (æ±ç”¨)</option>
                            <option value="1.2">Ï†1.2mm (åšæ¿ç”¨)</option>
                            <option value="1.4">Ï†1.4mm (é‡åšæ¿ç”¨)</option>
                        </select>
                    </div>

                    <!-- è„šé•·ãƒ»ã®ã©åšè¨­å®šï¼ˆéš…è‚‰æº¶æ¥æ™‚ã®ã¿è¡¨ç¤ºï¼‰ -->
                    <div id="filletSettings" class="hidden space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold mb-2">è„šé•· (mm)</label>
                                <select id="legLength" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">ä¸æ˜</option>
                                    <option value="3">3mm</option>
                                    <option value="4">4mm</option>
                                    <option value="5">5mm</option>
                                    <option value="6">6mm</option>
                                    <option value="7">7mm</option>
                                    <option value="8">8mm</option>
                                    <option value="10">10mm</option>
                                    <option value="12">12mm</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-2">ã®ã©åš (mm)</label>
                                <select id="throatThickness" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">ä¸æ˜</option>
                                    <option value="2.1">2.1mm</option>
                                    <option value="2.8">2.8mm</option>
                                    <option value="3.5">3.5mm</option>
                                    <option value="4.2">4.2mm</option>
                                    <option value="4.9">4.9mm</option>
                                    <option value="5.6">5.6mm</option>
                                    <option value="7.0">7.0mm</option>
                                    <option value="8.4">8.4mm</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- æº¶æ¥è·é›¢ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æº¶æ¥è·é›¢ (mm)</label>
                        <input type="number" id="weldingLength" class="parameter-input w-full p-3 rounded-lg" 
                               min="10" max="10000" step="10" value="100">
                    </div>

                    <!-- æº¶æ¥å„ªå…ˆåº¦é¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æº¶æ¥é‡è¦–é …ç›®</label>
                        <select id="weldingPriority" class="parameter-input w-full p-3 rounded-lg">
                            <option value="unknown">ä¸æ˜</option>
                            <option value="penetration">æº¶ã‘è¾¼ã¿é‡è¦–</option>
                            <option value="appearance">è¦‹ãŸç›®é‡è¦–</option>
                            <option value="speed">é€Ÿåº¦é‡è¦–</option>
                        </select>
                    </div>

                    <!-- AIè¨ºæ–­ãƒœã‚¿ãƒ³ -->
                    <button id="aiDiagnosisBtn" class="btn-primary text-white px-6 py-4 rounded-lg font-semibold w-full">
                        <i class="fas fa-magic mr-2"></i>AIè¨ºæ–­é–‹å§‹
                    </button>
                </div>

                <!-- çµæœè¡¨ç¤ºãƒ‘ãƒãƒ« -->
                <div class="glass-card p-6">
                    <h3 class="text-xl font-bold mb-4">è¨ºæ–­çµæœ</h3>
                    <div id="diagnosisResult" class="text-center text-gray-400 py-12">
                        <i class="fas fa-robot text-4xl mb-4 opacity-50"></i>
                        <p>æ¡ä»¶ã‚’å…¥åŠ›ã—ã¦AIè¨ºæ–­ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- æº¶æ¥æ¡ä»¶å…¥åŠ›ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”»é¢ -->
        <div id="inputSimulation" class="hidden space-y-8">
            <div class="flex items-center justify-between">
                <h2 class="text-3xl font-bold">æº¶æ¥æ¡ä»¶å…¥åŠ›ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
                <button class="back-btn text-blue-400 hover:text-blue-300">
                    <i class="fas fa-arrow-left mr-2"></i>ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹
                </button>
            </div>

            <div class="grid lg:grid-cols-2 gap-8">
                <!-- è©³ç´°å…¥åŠ›ãƒ‘ãƒãƒ« -->
                <div class="glass-card p-6 space-y-6">
                    <h3 class="text-xl font-bold mb-4">è©³ç´°æº¶æ¥æ¡ä»¶å…¥åŠ›</h3>
                    
                    <!-- åŸºæœ¬æ¡ä»¶ -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">æ¯æ</label>
                            <select id="simMaterial" class="parameter-input w-full p-3 rounded-lg">
                                <option value="SS400">SS400</option>
                                <option value="SM490">SM490</option>
                                <option value="SUS304">SUS304</option>
                                <option value="SUS316L">SUS316L</option>
                                <option value="SUS430">SUS430</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">ãƒ¯ã‚¤ãƒ¤å¾„</label>
                            <select id="simWireSize" class="parameter-input w-full p-3 rounded-lg">
                                <option value="0.8">Ï†0.8mm</option>
                                <option value="0.9">Ï†0.9mm</option>
                                <option value="1.0">Ï†1.0mm</option>
                                <option value="1.2">Ï†1.2mm</option>
                                <option value="1.4">Ï†1.4mm</option>
                            </select>
                        </div>
                    </div>

                    <!-- ãƒ¯ã‚¤ãƒ¤ç¨®é¡é¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            æº¶æ¥ãƒ¯ã‚¤ãƒ¤ç¨®é¡
                            <span id="wireTypeWarning" class="warning-badge hidden">
                                âš ï¸ ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹ç³»ã¯ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤å¿…é ˆ
                            </span>
                        </label>
                        <select id="simWireType" class="parameter-input w-full p-3 rounded-lg">
                            <option value="Solid">ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤ (SSç³»å°‚ç”¨)</option>
                            <option value="Flux-Cored">ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ (å…¨æè³ªå¯¾å¿œ)</option>
                        </select>
                    </div>

                    <!-- ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹
                            <span class="gas-indicator">
                                ğŸ’¨ ã‚¬ã‚¹è£œæ­£
                            </span>
                        </label>
                        <select id="simShieldGas" class="parameter-input w-full p-3 rounded-lg">
                            <option value="CO2">CO2 (ç‚­é…¸ã‚¬ã‚¹)</option>
                            <option value="MAG_Ar80CO2_20">MAG (Ar80%+CO2 20%)</option>
                            <option value="MAG_Ar75CO2_25">MAG (Ar75%+CO2 25%)</option>
                        </select>
                    </div>

                    <!-- æ¿åšè¨­å®š -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">æ¿åš1 (mm)</label>
                            <input type="number" id="simThickness1" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0.5" max="25" step="0.1" value="6.0">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">æ¿åš2 (mm)</label>
                            <input type="number" id="simThickness2" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0.5" max="25" step="0.1" value="6.0">
                        </div>
                    </div>

                    <!-- æº¶æ¥æ–¹æ³•é¸æŠ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æº¶æ¥æ–¹æ³•</label>
                        <select id="simWeldingMethod" class="parameter-input w-full p-3 rounded-lg">
                            <option value="butt">çªãåˆã‚ã›æº¶æ¥</option>
                            <option value="fillet">éš…è‚‰æº¶æ¥</option>
                        </select>
                    </div>

                    <!-- é–‹å…ˆè¨­å®š -->
                    <div id="simGrooveSection">
                        <label class="block text-sm font-semibold mb-2">é–‹å…ˆã®æœ‰ç„¡</label>
                        <select id="simGrooveType" class="parameter-input w-full p-3 rounded-lg mb-4">
                            <option value="none">é–‹å…ˆãªã—</option>
                            <option value="v-groove">Vå‹é–‹å…ˆ</option>
                            <option value="x-groove">Xå‹é–‹å…ˆï¼ˆä¸¡é¢ï¼‰</option>
                            <option value="u-groove">Uå‹é–‹å…ˆï¼ˆæ·±æºå‹ï¼‰</option>
                            <option value="bevel">ãƒ™ãƒ™ãƒ«åŠ å·¥</option>
                            <option value="j-groove">Jå‹é–‹å…ˆ</option>
                        </select>

                        <!-- é–‹å…ˆè©³ç´°è¨­å®š -->
                        <div id="simGrooveDetails" class="hidden space-y-4">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold mb-2">é–‹å…ˆè§’åº¦ (åº¦)</label>
                                    <input type="number" id="simGrooveAngle" class="parameter-input w-full p-3 rounded-lg" 
                                           min="15" max="80" step="5" value="60">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold mb-2">é–‹å…ˆå¹… (mm)</label>
                                    <input type="number" id="simGrooveWidth" class="parameter-input w-full p-3 rounded-lg" 
                                           min="0" max="5" step="0.1" value="2.0">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-2">é–‹å…ˆæ·±ã• (mm)</label>
                                <select id="simGrooveDepth" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">ä¸æ˜</option>
                                    <option value="3.0">3.0mm</option>
                                    <option value="4.5">4.5mm</option>
                                    <option value="6.0">6.0mm</option>
                                    <option value="7.5">7.5mm</option>
                                    <option value="9.0">9.0mm</option>
                                    <option value="12.0">12.0mm</option>
                                    <option value="15.0">15.0mm</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- è„šé•·ãƒ»ã®ã©åšè¨­å®šï¼ˆéš…è‚‰æº¶æ¥æ™‚ã®ã¿è¡¨ç¤ºï¼‰ -->
                    <div id="simFilletSettings" class="hidden space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold mb-2">è„šé•· (mm)</label>
                                <select id="simLegLength" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">ä¸æ˜</option>
                                    <option value="3">3mm</option>
                                    <option value="4">4mm</option>
                                    <option value="5">5mm</option>
                                    <option value="6">6mm</option>
                                    <option value="7">7mm</option>
                                    <option value="8">8mm</option>
                                    <option value="10">10mm</option>
                                    <option value="12">12mm</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-2">ã®ã©åš (mm)</label>
                                <select id="simThroatThickness" class="parameter-input w-full p-3 rounded-lg">
                                    <option value="unknown">ä¸æ˜</option>
                                    <option value="2.1">2.1mm</option>
                                    <option value="2.8">2.8mm</option>
                                    <option value="3.5">3.5mm</option>
                                    <option value="4.2">4.2mm</option>
                                    <option value="4.9">4.9mm</option>
                                    <option value="5.6">5.6mm</option>
                                    <option value="7.0">7.0mm</option>
                                    <option value="8.4">8.4mm</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- æº¶æ¥è·é›¢ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">æº¶æ¥è·é›¢ (mm)</label>
                        <input type="number" id="simWeldingLength" class="parameter-input w-full p-3 rounded-lg" 
                               min="10" max="10000" step="10" value="100">
                    </div>

                    <!-- æº¶æ¥é›»æµãƒ»é›»åœ§ï¼ˆä¸€å…ƒæ©Ÿèƒ½ä»˜ãï¼‰ -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">æº¶æ¥é›»æµ (A)</label>
                            <input type="number" id="weldingCurrent" class="parameter-input w-full p-3 rounded-lg" 
                                   min="20" max="350" step="5" value="150">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                æº¶æ¥é›»åœ§ (V)
                                <span class="auto-voltage-indicator">
                                    <i class="fas fa-magic mr-1"></i>ä¸€å…ƒè‡ªå‹•
                                </span>
                            </label>
                            <input type="number" id="weldingVoltage" class="parameter-input auto-calculated w-full p-3 rounded-lg" 
                                   readonly value="19.0">
                        </div>
                    </div>

                    <!-- ãƒ¯ã‚¤ãƒ¤é€çµ¦é€Ÿåº¦è¡¨ç¤º -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            ãƒ¯ã‚¤ãƒ¤é€çµ¦é€Ÿåº¦ (m/min)
                            <span class="auto-speed-indicator">
                                ğŸ”„ ä¸€å…ƒè‡ªå‹•
                            </span>
                        </label>
                        <input type="number" id="wireFeedSpeed" class="parameter-input auto-calculated w-full p-3 rounded-lg" 
                               readonly value="6.5">
                    </div>

                    <!-- ãƒ—ãƒªãƒ•ãƒ­ãƒ¼ãƒ»ã‚¢ãƒ•ã‚¿ãƒ¼ãƒ•ãƒ­ãƒ¼ -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">ãƒ—ãƒªãƒ•ãƒ­ãƒ¼æ™‚é–“ (ç§’)</label>
                            <input type="number" id="preFlow" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0" max="10" step="0.1" value="0.1">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">ã‚¢ãƒ•ã‚¿ãƒ¼ãƒ•ãƒ­ãƒ¼æ™‚é–“ (ç§’)</label>
                            <input type="number" id="afterFlow" class="parameter-input w-full p-3 rounded-lg" 
                                   min="0" max="10" step="0.1" value="0.4">
                        </div>
                    </div>

                    <!-- ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°è¨­å®šï¼ˆæ³¨æ„è¡¨ç¤ºä»˜ãï¼‰ -->
                    <div>
                        <label class="block text-sm font-semibold mb-2">
                            ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°è¨­å®š
                            <span class="warning-badge">
                                âš ï¸ ãƒ­ãƒœãƒƒãƒˆåˆ¶å¾¡æ™‚ã®ã¿
                            </span>
                        </label>
                        <div class="space-y-3">
                            <select id="weavingEnabled" class="parameter-input w-full p-3 rounded-lg">
                                <option value="false">ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°ãªã—</option>
                                <option value="true">ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°ã‚ã‚Šï¼ˆFD19-VC4åˆ¶å¾¡ï¼‰</option>
                            </select>
                            <div id="weavingSettings" class="hidden space-y-3">
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-semibold mb-2">ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°å¹… (mm)</label>
                                        <input type="number" id="weavingWidth" class="parameter-input w-full p-3 rounded-lg" 
                                               min="0.5" max="10" step="0.5" value="3.0">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold mb-2">ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°å‘¨æ³¢æ•° (Hz)</label>
                                        <input type="number" id="weavingFrequency" class="parameter-input w-full p-3 rounded-lg" 
                                               min="0.1" max="5.0" step="0.1" value="1.0">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
                    <button id="detailedSimBtn" class="btn-secondary text-white px-6 py-4 rounded-lg font-semibold w-full">
                        <i class="fas fa-calculator mr-2"></i>è©³ç´°ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
                    </button>
                </div>

                <!-- ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ -->
                <div class="glass-card p-6">
                    <h3 class="text-xl font-bold mb-4">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ</h3>
                    <div id="simulationResult" class="text-center text-gray-400 py-12">
                        <i class="fas fa-chart-line text-4xl mb-4 opacity-50"></i>
                        <p>æ¡ä»¶ã‚’å…¥åŠ›ã—ã¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="glass-card rounded-none border-0 border-t border-gray-600 mt-16">
        <div class="container mx-auto px-6 py-8">
            <div class="text-center space-y-4">
                <div class="flex items-center justify-center space-x-2">
                    <i class="fas fa-copyright text-gray-400"></i>
                    <span class="text-gray-300">2025 æ ªå¼ä¼šç¤¾ã‚¢ã‚¤ãƒ¯ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</span>
                </div>
                <div class="text-sm text-gray-400 space-y-2">
                    <p>æº¶æ¥æŠ€è¡“ã®ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆ - æ•™è‚²ã‹ã‚‰å®Ÿå‹™ã¾ã§å¹…åºƒãã‚µãƒãƒ¼ãƒˆ</p>
                    <p>æœ¬ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ©ç”¨ã«ã‚ˆã‚Šç”Ÿã˜ãŸæå®³ã«ã¤ã„ã¦ã€å¼Šç¤¾ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã‹ã­ã¾ã™ã€‚</p>
                </div>
            </div>
        </div>
    </footer>

    <script type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";

        class WeldingAIService {
            constructor() {
                this.API_KEY = 'AIzaSyBivo2r8DpE8DATru1Vy8JuinouvrZwRHk';
                this.genAI = new GoogleGenerativeAI(this.API_KEY);
                this.model = this.genAI.getGenerativeModel({ 
                    model: "gemini-2.5-flash",
                    generationConfig: {
                        temperature: 0.3,
                        topK: 40,
                        topP: 0.95,
                        maxOutputTokens: 8192,
                    }
                });
                console.log('âœ… Gemini 2.5 FlashåˆæœŸåŒ–å®Œäº†');
            }

            async diagnoseWeldingConditions(conditions) {
                const prompt = this.createOptimalDiagnosisPrompt(conditions);
                try {
                    const result = await this.model.generateContent(prompt);
                    const response = await result.response;
                    return response.text();
                } catch (error) {
                    console.error('AIè¨ºæ–­ã‚¨ãƒ©ãƒ¼:', error);
                    throw new Error(`AIè¨ºæ–­ã«å¤±æ•—ã—ã¾ã—ãŸ: ${error.message}`);
                }
            }

            async simulateWeldingConditions(conditions) {
                const prompt = this.createSimulationPrompt(conditions);
                try {
                    const result = await this.model.generateContent(prompt);
                    const response = await result.response;
                    return response.text();
                } catch (error) {
                    console.error('ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼:', error);
                    throw new Error(`ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ: ${error.message}`);
                }
            }

            createOptimalDiagnosisPrompt(conditions) {
                return `
ã€ãƒ€ã‚¤ãƒ˜ãƒ³WELBEE M-350L & FD19-VC4 é«˜ç²¾åº¦æº¶æ¥è¨ºæ–­ã€‘

ã‚ãªãŸã¯æº¶æ¥å·¥å­¦ã®ä¸–ç•Œçš„å°‚é–€å®¶ã¨ã—ã¦ã€æœ€é«˜ç²¾åº¦ã®è¨ºæ–­ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚

â–  å…¥åŠ›æ¡ä»¶:
- æ¯æ: ${conditions.material}
- ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹: ${conditions.shieldGas}
- ãƒ¯ã‚¤ãƒ¤ç¨®é¡: ${conditions.wireType}
- æ¿åš1: ${conditions.thickness1}mm
- æ¿åš2: ${conditions.thickness2}mm  
- æº¶æ¥æ–¹æ³•: ${conditions.weldingMethod}
- é–‹å…ˆã‚¿ã‚¤ãƒ—: ${conditions.grooveType}
- é–‹å…ˆè§’åº¦: ${conditions.grooveAngle}åº¦
- é–‹å…ˆå¹…: ${conditions.grooveWidth}mm
- é–‹å…ˆæ·±ã•: ${conditions.grooveDepth}
- ãƒ¯ã‚¤ãƒ¤å¾„: Ï†${conditions.wireSize}mm
- è„šé•·: ${conditions.legLength}
- ã®ã©åš: ${conditions.throatThickness}
- æº¶æ¥è·é›¢: ${conditions.weldingLength}mm
- é‡è¦–é …ç›®: ${conditions.weldingPriority}

â–  é‡è¦åˆ¶ç´„äº‹é …:
- ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹ç³»æè³ª(SUS304/316L/430)ã®å ´åˆã€ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤å¿…é ˆ
- SSç³»æè³ª(SS400/SM490)ã®å ´åˆã€ã‚½ãƒªãƒƒãƒ‰ãƒ¯ã‚¤ãƒ¤ãƒ»ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ä¸¡æ–¹ä½¿ç”¨å¯èƒ½

â–  ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹ç‰¹æ€§:
- CO2: é«˜æº¶ã‘è¾¼ã¿ã€çµŒæ¸ˆçš„ã€ã‚¹ãƒ‘ãƒƒã‚¿å¤šã€æº¶æ¥é›»åœ§+2.0Vè£œæ­£
- MAG(Ar80%+CO2 20%): ä½ã‚¹ãƒ‘ãƒƒã‚¿ã€é«˜å“è³ªã€æº¶æ¥é›»åœ§-0.5Vè£œæ­£ã€ã‚¢ãƒ¼ã‚¯å®‰å®š
- MAG(Ar75%+CO2 25%): ãƒãƒ©ãƒ³ã‚¹å‹ã€ä¸­ç¨‹åº¦ã‚¹ãƒ‘ãƒƒã‚¿ã€åŸºæº–é›»åœ§ä½¿ç”¨

â–  æ©Ÿå™¨ä»•æ§˜:
- WELBEE M-350L: å®šæ ¼å‡ºåŠ›é›»æµ30-350Aã€é›»åœ§12-36Vã€ä¸€å…ƒæ©Ÿèƒ½æ­è¼‰ã€ãƒ‘ãƒ«ã‚¹æ©Ÿèƒ½ãªã—
- FD19-VC4: å”åƒãƒ­ãƒœãƒƒãƒˆã€å¯æ¬è³ªé‡4kgã€è»Œè·¡ç²¾åº¦å‘ä¸Šã€ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°åˆ¶å¾¡å¯¾å¿œ

â–  è¨ºæ–­å›ç­”å½¢å¼ï¼ˆå¿…é ˆï¼‰:
ã€æº¶æ¥æ¡ä»¶ã€‘ï¼ˆå¿…ãšæœ€åˆã«è¨˜è¼‰ï¼‰
ãƒ»æº¶æ¥é›»æµ: â—‹â—‹A
ãƒ»æº¶æ¥é›»åœ§: â—‹â—‹Vï¼ˆä¸€å…ƒè¨­å®š+ã‚¬ã‚¹è£œæ­£ï¼‰
ãƒ»ãƒ¯ã‚¤ãƒ¤é€çµ¦é€Ÿåº¦: â—‹â—‹m/minï¼ˆä¸€å…ƒè‡ªå‹•è¨ˆç®—ï¼‰
ãƒ»æ¨å¥¨ãƒ‘ã‚¹æ•°: â—‹ãƒ‘ã‚¹
ãƒ»ãƒ—ãƒªãƒ•ãƒ­ãƒ¼æ™‚é–“: â—‹â—‹ç§’
ãƒ»ã‚¢ãƒ•ã‚¿ãƒ¼ãƒ•ãƒ­ãƒ¼æ™‚é–“: â—‹â—‹ç§’
ãƒ»ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°å¹…: â—‹â—‹mmï¼ˆãƒ­ãƒœãƒƒãƒˆåˆ¶å¾¡æ™‚ï¼‰
ãƒ»ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°å‘¨æ³¢æ•°: â—‹â—‹Hzï¼ˆãƒ­ãƒœãƒƒãƒˆåˆ¶å¾¡æ™‚ï¼‰
ãƒ»ãƒˆãƒ¼ãƒè§’åº¦: â—‹â—‹åº¦
ãƒ»é€²è¡Œæ–¹å‘: ãƒ—ãƒƒã‚·ãƒ¥/ãƒ—ãƒ«
ãƒ»ã‚¢ãƒ¼ã‚¯ç‰¹æ€§: â—‹â—‹ï¼ˆ-99ï½99ï¼‰
ãƒ»ã‚¬ã‚¹æµé‡: â—‹â—‹L/min

ã€è©³ç´°è§£èª¬ã€‘
ï¼ˆä¸Šè¨˜æ¡ä»¶ã®æŠ€è¡“çš„æ ¹æ‹ ã¨èª¬æ˜ï¼‰

â–  é‡è¦äº‹é …:
- ä¸€å…ƒæ©Ÿèƒ½ã«ã‚ˆã‚Šé›»æµâ†’é›»åœ§â†’ãƒ¯ã‚¤ãƒ¤é€çµ¦é€Ÿåº¦ã‚’å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åŸºã¥ã„ã¦è‡ªå‹•è¨ˆç®—+ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹è£œæ­£
- æ¿åšãƒ»é–‹å…ˆãƒ»ãƒ¯ã‚¤ãƒ¤å¾„ã«åŸºã¥ãæœ€é©ãƒ‘ã‚¹æ•°ã‚’åˆ¤å®š
- å„ãƒ‘ã‚¹åˆ¥ã®è©³ç´°æº¶æ¥æ¡ä»¶ã‚’æç¤º
- ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹ç¨®é¡ã«ã‚ˆã‚‹ç‰¹æ€§å·®ã‚’è€ƒæ…®
- ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°æ©Ÿèƒ½ã¯å”åƒãƒ­ãƒœãƒƒãƒˆåˆ¶å¾¡æ™‚ã®ã¿ä½¿ç”¨å¯èƒ½
- å¿…ãšæ¡ä»¶ã‚’æ•°å€¤ã§å…ˆã«ç¤ºã—ã¦ã‹ã‚‰è§£èª¬ã™ã‚‹ã“ã¨

å¿…ãšæ—¥æœ¬èªã§ã€æ•°å€¤è¨ˆç®—éç¨‹ã‚’æ˜ç¤ºã—ã€æŠ€è¡“çš„æ ¹æ‹ ã‚’è©³ç´°ã«èª¬æ˜ã—ã¦ãã ã•ã„ã€‚
å›ç­”ãŒé€”ä¸­ã§çµ‚äº†ã—ãªã„ã‚ˆã†ã€å®Œå…¨ãªè¨ºæ–­çµæœã‚’æä¾›ã—ã¦ãã ã•ã„ã€‚
                `;
            }

            createSimulationPrompt(conditions) {
                return `
ã€ãƒ€ã‚¤ãƒ˜ãƒ³WELBEE M-350L æº¶æ¥æ¡ä»¶è©•ä¾¡ãƒ»æ¡ç‚¹ã€‘

å…¥åŠ›ã•ã‚ŒãŸæº¶æ¥æ¡ä»¶ã‚’å°‚é–€çš„ã«è©•ä¾¡ã—ã€A/S/B/C/Dåˆ¤å®šã‚’è¡Œã£ã¦ãã ã•ã„ã€‚

â–  å…¥åŠ›æº¶æ¥æ¡ä»¶:
- æ¯æ: ${conditions.material}
- ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹: ${conditions.shieldGas}
- ãƒ¯ã‚¤ãƒ¤ç¨®é¡: ${conditions.wireType}
- æ¿åš1: ${conditions.thickness1}mm
- æ¿åš2: ${conditions.thickness2}mm
- æº¶æ¥æ–¹æ³•: ${conditions.weldingMethod}
- é–‹å…ˆã‚¿ã‚¤ãƒ—: ${conditions.grooveType}
- é–‹å…ˆè§’åº¦: ${conditions.grooveAngle}åº¦
- é–‹å…ˆå¹…: ${conditions.grooveWidth}mm
- é–‹å…ˆæ·±ã•: ${conditions.grooveDepth}
- ãƒ¯ã‚¤ãƒ¤å¾„: Ï†${conditions.wireSize}mm
- è„šé•·: ${conditions.legLength}
- ã®ã©åš: ${conditions.throatThickness}
- æº¶æ¥è·é›¢: ${conditions.weldingLength}mm
- æº¶æ¥é›»æµ: ${conditions.current}A
- æº¶æ¥é›»åœ§: ${conditions.voltage}Vï¼ˆä¸€å…ƒè¨­å®šè‡ªå‹•è¨ˆç®—ï¼‰
- ãƒ¯ã‚¤ãƒ¤é€çµ¦é€Ÿåº¦: ${conditions.feedSpeed}m/minï¼ˆä¸€å…ƒè‡ªå‹•è¨ˆç®—ï¼‰
- ãƒ—ãƒªãƒ•ãƒ­ãƒ¼æ™‚é–“: ${conditions.preFlow}ç§’
- ã‚¢ãƒ•ã‚¿ãƒ¼ãƒ•ãƒ­ãƒ¼æ™‚é–“: ${conditions.afterFlow}ç§’
- ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°: ${conditions.weaving}
- ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°å¹…: ${conditions.weavingWidth}mm
- ã‚¦ã‚£ãƒ¼ãƒ“ãƒ³ã‚°å‘¨æ³¢æ•°: ${conditions.weavingFrequency}Hz

â–  è©•ä¾¡å›ç­”å½¢å¼ï¼ˆå¿…é ˆï¼‰:
ã€è©•ä¾¡çµæœæ¦‚è¦ã€‘ï¼ˆå¿…ãšæœ€åˆã«è¨˜è¼‰ï¼‰
ãƒ»ç·åˆè©•ä¾¡: â—‹è©•ä¾¡ï¼ˆâ—‹â—‹ç‚¹/100ç‚¹ï¼‰
ãƒ»é›»æµè¨­å®š: â—‹â—‹ç‚¹/20ç‚¹
ãƒ»é›»åœ§è¨­å®š: â—‹â—‹ç‚¹/20ç‚¹ï¼ˆã‚¬ã‚¹è£œæ­£å«ã‚€ï¼‰
ãƒ»ãƒ¯ã‚¤ãƒ¤ç¨®é¡é©åˆæ€§: â—‹â—‹ç‚¹/20ç‚¹
ãƒ»æ¿åšãƒ»é–‹å…ˆé©åˆæ€§: â—‹â—‹ç‚¹/20ç‚¹
ãƒ»ç·åˆãƒãƒ©ãƒ³ã‚¹: â—‹â—‹ç‚¹/20ç‚¹

ã€è©³ç´°è©•ä¾¡ã¨ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€‘
ï¼ˆå„é …ç›®ã®è©•ä¾¡ç†ç”±ã¨æ”¹å–„ææ¡ˆï¼‰

â–  è©•ä¾¡é …ç›®:
1. é›»æµè¨­å®šã®å¦¥å½“æ€§ (20ç‚¹æº€ç‚¹)
2. é›»åœ§è¨­å®šã®å¦¥å½“æ€§ï¼ˆä¸€å…ƒæ©Ÿèƒ½+ã‚¬ã‚¹è£œæ­£ï¼‰ (20ç‚¹æº€ç‚¹)
3. ãƒ¯ã‚¤ãƒ¤ç¨®é¡ã®æè³ªé©åˆæ€§ï¼ˆã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹ç³»ãƒ•ãƒ©ãƒƒã‚¯ã‚¹å¿…é ˆãƒã‚§ãƒƒã‚¯ï¼‰ (20ç‚¹æº€ç‚¹)
4. æ¿åšãƒ»é–‹å…ˆæ¡ä»¶ã¨ã®é©åˆæ€§ (20ç‚¹æº€ç‚¹)
5. ç·åˆãƒãƒ©ãƒ³ã‚¹ (20ç‚¹æº€ç‚¹)

â–  è©•ä¾¡åŸºæº–:
- Sè©•ä¾¡: 95-100ç‚¹ (å®Œç’§)
- Aè©•ä¾¡: 85-94ç‚¹ (å„ªç§€)
- Bè©•ä¾¡: 70-84ç‚¹ (è‰¯å¥½)
- Cè©•ä¾¡: 50-69ç‚¹ (è¦æ”¹å–„)
- Dè©•ä¾¡: 0-49ç‚¹ (ä¸é©åˆ‡)

å„é …ç›®ã®æ¡ç‚¹ç†ç”±ã¨æ”¹å–„ææ¡ˆã‚’å…·ä½“çš„ã«æ—¥æœ¬èªã§èª¬æ˜ã—ã¦ãã ã•ã„ã€‚
WELBEE M-350Lã®ä¸€å…ƒè¨­å®šã¨ã‚·ãƒ¼ãƒ«ãƒ‰ã‚¬ã‚¹ç‰¹æ€§ã‚’è€ƒæ…®ã—ãŸè©•ä¾¡ã‚’å«ã‚ã¦ãã ã•ã„ã€‚
å¿…ãšè©•ä¾¡çµæœã‚’æ•°å€¤ã§å…ˆã«ç¤ºã—ã¦ã‹ã‚‰è§£èª¬ã™ã‚‹ã“ã¨ã€‚
ãƒ¯ã‚¤ãƒ¤é€çµ¦é€Ÿåº¦ã¯ä¸€å…ƒæ©Ÿèƒ½ã§å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åŸºã¥ãè‡ªå‹•è¨ˆç®—ã•ã‚Œã¾ã™ã€‚
                `;
            }
        }

        // å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åŸºã¥ãé«˜ç²¾åº¦ä¸€å…ƒè¨ˆç®—ã‚¯ãƒ©ã‚¹
        class WeldingCalculator {
            constructor() {
                // å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆï¼ˆå­¦è¡“è«–æ–‡ãƒ»å®Ÿæ©Ÿãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãï¼‰
                this.DATA_POINTS = {
                    "MildSteel_ArCO2_Solid_0.8": [
                        {current: 100, voltage: 16.0, feed_speed: 4.5},
                        {current: 120, voltage: 17.2, feed_speed: 5.8},
                        {current: 140, voltage: 18.4, feed_speed: 7.0},
                        {current: 160, voltage: 19.6, feed_speed: 8.2},
                        {current: 180, voltage: 20.8, feed_speed: 9.5},
                        {current: 200, voltage: 22.0, feed_speed: 10.8},
                        {current: 220, voltage: 23.2, feed_speed: 12.0},
                        {current: 240, voltage: 24.4, feed_speed: 13.3},
                        {current: 260, voltage: 25.6, feed_speed: 14.5}
                    ],
                    "StainlessSteel_ArCO2_FluxCored_1.2": [
                        {current: 80, voltage: 16.2, feed_speed: 2.2},
                        {current: 90, voltage: 17.0, feed_speed: 2.6},
                        {current: 100, voltage: 17.8, feed_speed: 3.0},
                        {current: 120, voltage: 19.4, feed_speed: 3.8},
                        {current: 140, voltage: 21.0, feed_speed: 4.6},
                        {current: 160, voltage: 22.6, feed_speed: 5.4},
                        {current: 180, voltage: 24.2, feed_speed: 6.2},
                        {current: 200, voltage: 25.8, feed_speed: 7.0}
                    ]
                };

                // è£œæ­£ä¿‚æ•°ï¼ˆå®Ÿæ©Ÿæ¸¬å®šãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãï¼‰
                this.CORRECTION_FACTORS = {
                    "gas": {
                        "CO2": { voltage_add: 2.0 },
                        "MAG_Ar80CO2_20": { voltage_add: -0.5 },
                        "MAG_Ar75CO2_25": { voltage_add: 0.0 }
                    },
                    "wire_type": {
                        "Flux-Cored": { voltage_add: 1.5, feed_speed_multiplier: 1.15 }
                    },
                    "wire_diameter": {
                        "0.8": { voltage_multiplier: 1.00, feed_speed_multiplier: 1.00 },
                        "0.9": { voltage_multiplier: 1.02, feed_speed_multiplier: 0.85 },
                        "1.0": { voltage_multiplier: 1.04, feed_speed_multiplier: 0.75 },
                        "1.2": { voltage_multiplier: 1.08, feed_speed_multiplier: 0.55 },
                        "1.4": { voltage_multiplier: 1.12, feed_speed_multiplier: 0.45 }
                    },
                    "material": {
                        "SS400": { voltage_add: 0.0, feed_speed_multiplier: 1.0 },
                        "SM490": { voltage_add: 0.3, feed_speed_multiplier: 1.0 },
                        "SUS304": { voltage_add: -0.8, feed_speed_multiplier: 0.9 },
                        "SUS316L": { voltage_add: -0.5, feed_speed_multiplier: 0.9 },
                        "SUS430": { voltage_add: -0.6, feed_speed_multiplier: 0.95 }
                    }
                };

                // è¿‘ä¼¼é–¢æ•°ã®äº‹å‰è¨ˆç®—
                this.initializeApproximationFunctions();
            }

            initializeApproximationFunctions() {
                // è»Ÿé‹¼ç”¨è¿‘ä¼¼é–¢æ•°ã®ä¿‚æ•°è¨ˆç®—
                const mildSteelData = this.DATA_POINTS["MildSteel_ArCO2_Solid_0.8"];
                this.mildSteelVoltageCoeff = this.polyfit(mildSteelData, 'current', 'voltage', 2);
                this.mildSteelFeedSpeedCoeff = this.polyfit(mildSteelData, 'current', 'feed_speed', 1);

                // ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼ç”¨è¿‘ä¼¼é–¢æ•°ã®ä¿‚æ•°è¨ˆç®—
                const stainlessSteelData = this.DATA_POINTS["StainlessSteel_ArCO2_FluxCored_1.2"];
                this.stainlessSteelVoltageCoeff = this.polyfit(stainlessSteelData, 'current', 'voltage', 2);
                this.stainlessSteelFeedSpeedCoeff = this.polyfit(stainlessSteelData, 'current', 'feed_speed', 1);
            }

            // å¤šé …å¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°é–¢æ•°ï¼ˆç°¡æ˜“ç‰ˆæœ€å°äºŒä¹—æ³•ï¼‰
            polyfit(data, xKey, yKey, degree) {
                const n = data.length;
                const x = data.map(d => d[xKey]);
                const y = data.map(d => d[yKey]);

                if (degree === 1) {
                    // ä¸€æ¬¡é–¢æ•°: y = ax + b
                    let sumX = 0, sumY = 0, sumXY = 0, sumX2 = 0;
                    for (let i = 0; i < n; i++) {
                        sumX += x[i];
                        sumY += y[i];
                        sumXY += x[i] * y[i];
                        sumX2 += x[i] * x[i];
                    }
                    const a = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
                    const b = (sumY - a * sumX) / n;
                    return {a, b};

                } else if (degree === 2) {
                    // äºŒæ¬¡é–¢æ•°: y = axÂ² + bx + c
                    // ç°¡æ˜“çš„ãªäºŒæ¬¡è¿‘ä¼¼ï¼ˆ3ç‚¹ã‚’ä½¿ç”¨ï¼‰
                    const p1 = {x: x[0], y: y[0]};
                    const p2 = {x: x[Math.floor(n/2)], y: y[Math.floor(n/2)]};
                    const p3 = {x: x[n-1], y: y[n-1]};
                    
                    // é€£ç«‹æ–¹ç¨‹å¼ã‚’è§£ã
                    const denom = (p1.x - p2.x) * (p1.x - p3.x) * (p2.x - p3.x);
                    const a = (p3.x * (p2.y - p1.y) + p2.x * (p1.y - p3.y) + p1.x * (p3.y - p2.y)) / denom;
                    const b = (p3.x * p3.x * (p1.y - p2.y) + p2.x * p2.x * (p3.y - p1.y) + p1.x * p1.x * (p2.y - p3.y)) / denom;
                    const c = (p2.x * p3.x * (p2.x - p3.x) * p1.y + p3.x * p1.x * (p3.x - p1.x) * p2.y + p1.x * p2.x * (p1.x - p2.x) * p3.y) / denom;
                    
                    return {a, b, c};
                }
            }

            // è¿‘ä¼¼é–¢æ•°ã«ã‚ˆã‚‹å€¤ã®è¨ˆç®—
            evaluatePolynomial(coeff, x) {
                if (coeff.c !== undefined) {
                    // äºŒæ¬¡é–¢æ•°
                    return coeff.a * x * x + coeff.b * x + coeff.c;
                } else {
                    // ä¸€æ¬¡é–¢æ•°
                    return coeff.a * x + coeff.b;
                }
            }

            calculateWeldingParameters(current, material, gas, wireType, wireDiameter) {
                let baseVoltage, baseFeedSpeed;

                // æ¯æã¨ãƒ¯ã‚¤ãƒ¤ç¨®é¡ã«ã‚ˆã£ã¦ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã‚’é¸æŠ
                if (material.includes("SUS") && wireType === "Flux-Cored") {
                    // ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼+ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ãƒ¢ãƒ‡ãƒ«
                    baseVoltage = this.evaluatePolynomial(this.stainlessSteelVoltageCoeff, current);
                    baseFeedSpeed = this.evaluatePolynomial(this.stainlessSteelFeedSpeedCoeff, current);
                } else {
                    // è»Ÿé‹¼ãƒ¢ãƒ‡ãƒ«ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
                    baseVoltage = this.evaluatePolynomial(this.mildSteelVoltageCoeff, current);
                    baseFeedSpeed = this.evaluatePolynomial(this.mildSteelFeedSpeedCoeff, current);
                }

                let finalVoltage = baseVoltage;
                let finalFeedSpeed = baseFeedSpeed;

                // æè³ªè£œæ­£
                if (this.CORRECTION_FACTORS.material[material]) {
                    const matFactors = this.CORRECTION_FACTORS.material[material];
                    finalVoltage += matFactors.voltage_add;
                    finalFeedSpeed *= matFactors.feed_speed_multiplier;
                }

                // ãƒ¯ã‚¤ãƒ¤å¾„è£œæ­£ï¼ˆåŸºæº–0.8mmã‹ã‚‰ã®è£œæ­£ï¼‰
                if (wireDiameter != "0.8" && this.CORRECTION_FACTORS.wire_diameter[wireDiameter]) {
                    const diaFactors = this.CORRECTION_FACTORS.wire_diameter[wireDiameter];
                    finalVoltage *= diaFactors.voltage_multiplier;
                    finalFeedSpeed *= diaFactors.feed_speed_multiplier;
                }

                // ã‚¬ã‚¹ç¨®è£œæ­£
                if (this.CORRECTION_FACTORS.gas[gas]) {
                    finalVoltage += this.CORRECTION_FACTORS.gas[gas].voltage_add;
                }

                // ãƒ¯ã‚¤ãƒ¤ç¨®è£œæ­£
                if (wireType === "Flux-Cored" && this.CORRECTION_FACTORS.wire_type["Flux-Cored"]) {
                    const fcwFactors = this.CORRECTION_FACTORS.wire_type["Flux-Cored"];
                    finalVoltage += fcwFactors.voltage_add;
                    finalFeedSpeed *= fcwFactors.feed_speed_multiplier;
                }

                // WELBEE M-350Lã®åˆ¶é™å€¤é©ç”¨
                finalVoltage = Math.max(12.0, Math.min(36.0, finalVoltage));
                finalFeedSpeed = Math.max(0.5, Math.min(25.0, finalFeedSpeed));

                return {
                    voltage: Math.round(finalVoltage * 10) / 10,
                    feedSpeed: Math.round(finalFeedSpeed * 10) / 10
                };
            }
        }

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
        const weldingAI = new WeldingAIService();
        const calculator = new WeldingCalculator();

        // DOMè¦ç´ ã®å–å¾—
        const elements = {
            mainMenu: document.getElementById('mainMenu'),
            optimalDiagnosis: document.getElementById('optimalDiagnosis'),
            inputSimulation: document.getElementById('inputSimulation'),
            optimalDiagnosisBtn: document.getElementById('optimalDiagnosisBtn'),
            inputSimulationBtn: document.getElementById('inputSimulationBtn'),
            aiDiagnosisBtn: document.getElementById('aiDiagnosisBtn'),
            detailedSimBtn: document.getElementById('detailedSimBtn'),
            diagnosisResult: document.getElementById('diagnosisResult'),
            simulationResult: document.getElementById('simulationResult'),
            weldingMethod: document.getElementById('weldingMethod'),
            grooveType: document.getElementById('grooveType'),
            grooveDetails: document.getElementById('grooveDetails'),
            filletSettings: document.getElementById('filletSettings'),
            weavingEnabled: document.getElementById('weavingEnabled'),
            weavingSettings: document.getElementById('weavingSettings'),
            // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨
            weldingCurrent: document.getElementById('weldingCurrent'),
            weldingVoltage: document.getElementById('weldingVoltage'),
            wireFeedSpeed: document.getElementById('wireFeedSpeed'),
            simMaterial: document.getElementById('simMaterial'),
            simWireSize: document.getElementById('simWireSize'),
            simWireType: document.getElementById('simWireType'),
            simShieldGas: document.getElementById('simShieldGas'),
            wireTypeWarning: document.getElementById('wireTypeWarning'),
            // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨æ–°è¦è¿½åŠ è¦ç´ 
            simWeldingMethod: document.getElementById('simWeldingMethod'),
            simGrooveType: document.getElementById('simGrooveType'),
            simGrooveDetails: document.getElementById('simGrooveDetails'),
            simFilletSettings: document.getElementById('simFilletSettings')
        };

        // é«˜ç²¾åº¦ä¸€å…ƒæ©Ÿèƒ½: å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åŸºã¥ãè¨ˆç®—
        function updateAutoCalculations() {
            const current = parseFloat(elements.weldingCurrent.value) || 150;
            const material = elements.simMaterial.value || 'SS400';
            const gas = elements.simShieldGas.value || 'CO2';
            const wireType = elements.simWireType.value || 'Solid';
            const wireSize = elements.simWireSize.value || '1.0';
            
            const result = calculator.calculateWeldingParameters(current, material, gas, wireType, wireSize);
            
            elements.weldingVoltage.value = result.voltage;
            elements.wireFeedSpeed.value = result.feedSpeed;
            
            // è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
            elements.weldingVoltage.style.transform = 'scale(1.05)';
            elements.wireFeedSpeed.style.transform = 'scale(1.05)';
            setTimeout(() => {
                elements.weldingVoltage.style.transform = 'scale(1.0)';
                elements.wireFeedSpeed.style.transform = 'scale(1.0)';
            }, 200);
        }

        // ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹ç³»æè³ªã§ã®ãƒ¯ã‚¤ãƒ¤ç¨®é¡åˆ¶é™ãƒã‚§ãƒƒã‚¯
        function checkWireTypeCompatibility() {
            const material = elements.simMaterial.value;
            const wireType = elements.simWireType.value;
            const warning = elements.wireTypeWarning;
            
            if (material.includes('SUS') && wireType === 'Solid') {
                warning.classList.remove('hidden');
                // è‡ªå‹•çš„ã«ãƒ•ãƒ©ãƒƒã‚¯ã‚¹ãƒ¯ã‚¤ãƒ¤ã«å¤‰æ›´
                elements.simWireType.value = 'Flux-Cored';
                updateAutoCalculations();
            } else {
                warning.classList.add('hidden');
            }
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        function initializeEventListeners() {
            // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³
            elements.optimalDiagnosisBtn?.addEventListener('click', showOptimalDiagnosis);
            elements.inputSimulationBtn?.addEventListener('click', showInputSimulation);
            
            // AIè¨ºæ–­ãƒ»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³
            elements.aiDiagnosisBtn?.addEventListener('click', runAIDiagnosis);
            elements.detailedSimBtn?.addEventListener('click', runDetailedSimulation);
            
            // æˆ»ã‚‹ãƒœã‚¿ãƒ³
            document.querySelectorAll('.back-btn').forEach(btn => {
                btn.addEventListener('click', showMainMenu);
            });

            // æ¡ä»¶å¤‰æ›´æ™‚ã®è¡¨ç¤ºåˆ‡æ›¿ï¼ˆè¨ºæ–­ç”»é¢ï¼‰
            elements.weldingMethod?.addEventListener('change', toggleFilletSettings);
            elements.grooveType?.addEventListener('change', toggleGrooveDetails);
            elements.weavingEnabled?.addEventListener('change', toggleWeavingSettings);

            // æ¡ä»¶å¤‰æ›´æ™‚ã®è¡¨ç¤ºåˆ‡æ›¿ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”»é¢ï¼‰
            elements.simWeldingMethod?.addEventListener('change', toggleSimFilletSettings);
            elements.simGrooveType?.addEventListener('change', toggleSimGrooveDetails);

            // ä¸€å…ƒæ©Ÿèƒ½: æ¡ä»¶å¤‰æ›´æ™‚ã®è‡ªå‹•è¨ˆç®—
            elements.weldingCurrent?.addEventListener('input', updateAutoCalculations);
            elements.simWireSize?.addEventListener('change', updateAutoCalculations);
            elements.simWireType?.addEventListener('change', () => {
                updateAutoCalculations();
                checkWireTypeCompatibility();
            });
            elements.simMaterial?.addEventListener('change', () => {
                updateAutoCalculations();
                checkWireTypeCompatibility();
            });
            elements.simShieldGas?.addEventListener('change', updateAutoCalculations);
        }

        // ç”»é¢åˆ‡æ›¿é–¢æ•°
        function showMainMenu() {
            elements.mainMenu.classList.remove('hidden');
            elements.optimalDiagnosis.classList.add('hidden');
            elements.inputSimulation.classList.add('hidden');
        }

        function showOptimalDiagnosis() {
            elements.mainMenu.classList.add('hidden');
            elements.optimalDiagnosis.classList.remove('hidden');
            elements.inputSimulation.classList.add('hidden');
        }

        function showInputSimulation() {
            elements.mainMenu.classList.add('hidden');
            elements.optimalDiagnosis.classList.add('hidden');
            elements.inputSimulation.classList.remove('hidden');
            // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”»é¢è¡¨ç¤ºæ™‚ã«è¡¨ç¤ºåˆ‡æ›¿ã¨è¨ˆç®—ã‚’æ›´æ–°
            setTimeout(() => {
                toggleSimFilletSettings();
                toggleSimGrooveDetails();
                updateAutoCalculations();
                checkWireTypeCompatibility();
            }, 100);
        }

        // è¡¨ç¤ºåˆ‡æ›¿é–¢æ•°ï¼ˆè¨ºæ–­ç”»é¢ç”¨ï¼‰
        function toggleFilletSettings() {
            const isFilletWelding = elements.weldingMethod.value === 'fillet';
            if (elements.filletSettings) {
                elements.filletSettings.classList.toggle('hidden', !isFilletWelding);
            }
        }

        function toggleGrooveDetails() {
            const hasGroove = elements.grooveType.value !== 'none';
            if (elements.grooveDetails) {
                elements.grooveDetails.classList.toggle('hidden', !hasGroove);
            }
        }

        function toggleWeavingSettings() {
            const weavingEnabled = elements.weavingEnabled.value === 'true';
            if (elements.weavingSettings) {
                elements.weavingSettings.classList.toggle('hidden', !weavingEnabled);
            }
        }

        // è¡¨ç¤ºåˆ‡æ›¿é–¢æ•°ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”»é¢ç”¨ï¼‰
        function toggleSimFilletSettings() {
            const isFilletWelding = elements.simWeldingMethod?.value === 'fillet';
            if (elements.simFilletSettings) {
                elements.simFilletSettings.classList.toggle('hidden', !isFilletWelding);
            }
        }

        function toggleSimGrooveDetails() {
            const hasGroove = elements.simGrooveType?.value !== 'none';
            if (elements.simGrooveDetails) {
                elements.simGrooveDetails.classList.toggle('hidden', !hasGroove);
            }
        }

        // AIè¨ºæ–­å®Ÿè¡Œ
        async function runAIDiagnosis() {
            const button = elements.aiDiagnosisBtn;
            const resultDiv = elements.diagnosisResult;
            
            button.disabled = true;
            button.innerHTML = '<div class="loading-spinner inline-block mr-2"></div>ğŸ¤– Gemini 2.5 Flash è§£æä¸­...';
            
            try {
                const conditions = collectOptimalConditions();
                const result = await weldingAI.diagnoseWeldingConditions(conditions);
                displayDiagnosisResult(result);
            } catch (error) {
                console.error('AIè¨ºæ–­ã‚¨ãƒ©ãƒ¼:', error);
                resultDiv.innerHTML = `
                    <div class="text-red-400 space-y-4">
                        <i class="fas fa-exclamation-triangle text-4xl"></i>
                        <p class="text-lg font-semibold">ğŸš¨ Gemini 2.5 Flash ã‚¨ãƒ©ãƒ¼</p>
                        <p class="text-sm">${error.message}</p>
                        <p class="text-xs text-gray-400">APIã‚­ãƒ¼ç¢ºèªæ¸ˆã¿: ${weldingAI.API_KEY ? 'âœ…' : 'âŒ'}</p>
                    </div>
                `;
            } finally {
                button.disabled = false;
                button.innerHTML = '<i class="fas fa-magic mr-2"></i>AIè¨ºæ–­é–‹å§‹';
            }
        }

        // è©³ç´°ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
        async function runDetailedSimulation() {
            const button = elements.detailedSimBtn;
            const resultDiv = elements.simulationResult;
            
            button.disabled = true;
            button.innerHTML = '<div class="loading-spinner inline-block mr-2"></div>ğŸ” Gemini 2.5 Flash è§£æä¸­...';
            
            try {
                const conditions = collectSimulationConditions();
                const result = await weldingAI.simulateWeldingConditions(conditions);
                displaySimulationResult(result);
            } catch (error) {
                console.error('ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼:', error);
                resultDiv.innerHTML = `
                    <div class="text-red-400 space-y-4">
                        <i class="fas fa-exclamation-triangle text-4xl"></i>
                        <p class="text-lg font-semibold">ğŸš¨ Gemini 2.5 Flash ã‚¨ãƒ©ãƒ¼</p>
                        <p class="text-sm">${error.message}</p>
                        <p class="text-xs text-gray-400">APIã‚­ãƒ¼ç¢ºèªæ¸ˆã¿: ${weldingAI.API_KEY ? 'âœ…' : 'âŒ'}</p>
                    </div>
                `;
            } finally {
                button.disabled = false;
                button.innerHTML = '<i class="fas fa-calculator mr-2"></i>è©³ç´°ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ';
            }
        }

        // æ¡ä»¶åé›†é–¢æ•°
        function collectOptimalConditions() {
            return {
                material: document.getElementById('material')?.value || 'SS400',
                shieldGas: document.getElementById('shieldGas')?.value || 'CO2',
                wireType: document.getElementById('wireType')?.value || 'Solid',
                thickness1: parseFloat(document.getElementById('thickness1')?.value || '6'),
                thickness2: parseFloat(document.getElementById('thickness2')?.value || '6'),
                weldingMethod: document.getElementById('weldingMethod')?.value || 'butt',
                grooveType: document.getElementById('grooveType')?.value || 'none',
                grooveAngle: parseFloat(document.getElementById('grooveAngle')?.value || '60'),
                grooveWidth: parseFloat(document.getElementById('grooveWidth')?.value || '2.0'),
                grooveDepth: document.getElementById('grooveDepth')?.value || 'unknown',
                wireSize: parseFloat(document.getElementById('wireSize')?.value || '1.0'),
                legLength: document.getElementById('legLength')?.value || 'unknown',
                throatThickness: document.getElementById('throatThickness')?.value || 'unknown',
                weldingLength: parseFloat(document.getElementById('weldingLength')?.value || '100'),
                weldingPriority: document.getElementById('weldingPriority')?.value || 'unknown'
            };
        }

        // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ¡ä»¶åé›†é–¢æ•°
        function collectSimulationConditions() {
            return {
                material: elements.simMaterial?.value || 'SS400',
                shieldGas: elements.simShieldGas?.value || 'CO2',
                wireType: elements.simWireType?.value || 'Solid',
                thickness1: parseFloat(document.getElementById('simThickness1')?.value || '6'),
                thickness2: parseFloat(document.getElementById('simThickness2')?.value || '6'),
                weldingMethod: elements.simWeldingMethod?.value || 'butt',
                grooveType: elements.simGrooveType?.value || 'none',
                grooveAngle: parseFloat(document.getElementById('simGrooveAngle')?.value || '60'),
                grooveWidth: parseFloat(document.getElementById('simGrooveWidth')?.value || '2.0'),
                grooveDepth: document.getElementById('simGrooveDepth')?.value || 'unknown',
                wireSize: parseFloat(elements.simWireSize?.value || '1.0'),
                legLength: document.getElementById('simLegLength')?.value || 'unknown',
                throatThickness: document.getElementById('simThroatThickness')?.value || 'unknown',
                weldingLength: parseFloat(document.getElementById('simWeldingLength')?.value || '100'),
                current: parseFloat(elements.weldingCurrent?.value || '150'),
                voltage: parseFloat(elements.weldingVoltage?.value || '19'),
                feedSpeed: parseFloat(elements.wireFeedSpeed?.value || '6.5'),
                preFlow: parseFloat(document.getElementById('preFlow')?.value || '0.1'),
                afterFlow: parseFloat(document.getElementById('afterFlow')?.value || '0.4'),
                weaving: document.getElementById('weavingEnabled')?.value === 'true',
                weavingWidth: parseFloat(document.getElementById('weavingWidth')?.value || '3.0'),
                weavingFrequency: parseFloat(document.getElementById('weavingFrequency')?.value || '1.0')
            };
        }

        // çµæœè¡¨ç¤ºé–¢æ•°
        function displayDiagnosisResult(result) {
            elements.diagnosisResult.innerHTML = `
                <div class="result-card p-6 rounded-lg space-y-4 text-left">
                    <div class="flex items-center space-x-2 mb-4">
                        <i class="fas fa-brain text-blue-400"></i>
                        <h4 class="text-lg font-bold">ğŸ¤– Gemini 2.5 Flash AIè¨ºæ–­çµæœ</h4>
                    </div>
                    <div class="text-sm leading-relaxed whitespace-pre-wrap">${result}</div>
                    <div class="mt-6 p-4 bg-blue-900/30 rounded-lg">
                        <p class="text-xs text-blue-300">
                            <i class="fas fa-info-circle mr-1"></i>
                            ã“ã®è¨ºæ–­çµæœã¯å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åŸºã¥ãå‚è€ƒæƒ…å ±ã§ã™ã€‚å®Ÿéš›ã®æº¶æ¥æ™‚ã¯ç¾å ´ã§ã®è©¦é¨“æº¶æ¥ã‚’å®Ÿæ–½ã—ã¦ãã ã•ã„ã€‚
                        </p>
                    </div>
                </div>
            `;
        }

        function displaySimulationResult(result) {
            elements.simulationResult.innerHTML = `
                <div class="result-card p-6 rounded-lg space-y-4 text-left">
                    <div class="flex items-center space-x-2 mb-4">
                        <i class="fas fa-chart-line text-orange-400"></i>
                        <h4 class="text-lg font-bold">ğŸ“Š æº¶æ¥æ¡ä»¶è©•ä¾¡çµæœ</h4>
                    </div>
                    <div class="text-sm leading-relaxed whitespace-pre-wrap">${result}</div>
                    <div class="mt-6 p-4 bg-orange-900/30 rounded-lg">
                        <p class="text-xs text-orange-300">
                            <i class="fas fa-exclamation-triangle mr-1"></i>
                            è©•ä¾¡çµæœã¯å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åŸºã¥ãåˆ†æã§ã™ã€‚å®Ÿéš›ã®å“è³ªã¯ç¾å ´æ¡ä»¶ã«ã‚ˆã‚Šå¤‰å‹•ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
                        </p>
                    </div>
                </div>
            `;
        }

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ”§ DOMèª­ã¿è¾¼ã¿å®Œäº† - åˆæœŸåŒ–é–‹å§‹');
            console.log('ğŸ¤– APIã‚­ãƒ¼è¨­å®šç¢ºèª:', weldingAI.API_KEY ? 'âœ… æ­£å¸¸' : 'âŒ æœªè¨­å®š');
            console.log('âš¡ å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–:', calculator ? 'âœ… å®Œäº†' : 'âŒ å¤±æ•—');
            
            initializeEventListeners();
            
            // åˆæœŸè¡¨ç¤ºè¨­å®š
            toggleFilletSettings();
            toggleGrooveDetails();
            toggleWeavingSettings();
            
            // åˆæœŸè¨ˆç®—å®Ÿè¡Œ
            updateAutoCalculations();
            checkWireTypeCompatibility();
            
            console.log('âœ… AIæº¶æ¥æ”¯æ´ã‚¢ãƒ—ãƒªå®Œå…¨åˆæœŸåŒ–å®Œäº† - å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¸€å…ƒè¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…ç‰ˆ');
        });

    </script>
</body>
</html>
